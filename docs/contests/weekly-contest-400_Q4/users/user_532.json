{
    "username": "OneMore14",
    "submission": "\nfn get_num(bits_sum: &Vec<Vec<i32>>, pre: usize, i: usize) -> i64 {\n    let len = i - pre + 1;\n    let mut ans = 0;\n    for bit in 0..40 {\n        let bit_sum = bits_sum[i][bit] - bits_sum[pre - 1][bit];\n        if bit_sum == len as i32 {\n            ans = ans | (1i64 << bit);\n        }\n    }\n    ans\n}\n\nimpl Solution {\n    pub fn minimum_difference(nums: Vec<i32>, k: i32) -> i32 {\n        let k = k as i64;\n        let n = nums.len();\n        let mut ans= i64::MAX;\n        let mut bits_sum = vec![vec![0; 40]; n + 1];\n        for i in 1..=n {\n            let num = nums[i - 1] as i64;\n            for bit in 0..40 {\n                bits_sum[i][bit] = bits_sum[i - 1][bit];\n                if ((num >> bit) & 1i64) > 0 {\n                    bits_sum[i][bit] += 1;\n                }\n            }\n        }\n\n        let mut all = nums[0] as i64;\n        for i in 1..=n {\n            let num = nums[i - 1] as i64;\n            all = all & num;\n            if num <= k {\n                ans = ans.min(k - num);\n            } else if all >= k{\n                ans = ans.min(all - k);\n            } else {\n                // all k num\n                let mut left = 1 as i32;\n                let mut right = i as i32;\n                let mut pos = i;\n                while left <= right {\n                    let mut mid = ((left + right) / 2) as usize;\n                    let new_num = get_num(&bits_sum, mid, i);\n                    if new_num >= k {\n                        pos = mid;\n                        right = mid as i32 - 1;\n                    } else {\n                        left = mid as i32 + 1;\n                    }\n                }\n                let num1 = get_num(&bits_sum, pos, i);\n                ans = ans.min((num1 - k).abs());\n                if pos >= 2 {\n                    let num2 = get_num(&bits_sum, pos - 1, i);\n                    ans = ans.min((num2 - k).abs());\n                }\n            }\n        }\n\n\n        ans as i32\n    }\n}\n",
    "submit_ts": "1717299066",
    "subm_id": "1274800651"
}