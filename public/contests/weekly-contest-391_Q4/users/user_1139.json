{
    "username": "mnaoumov",
    "submission": "public class Solution\n{\n    public int MinimumDistance(int[][] points)\n    {\n        var n = points.Length;\n\n        var minSum = int.MaxValue;\n        var maxSum = int.MinValue;\n        var minDiff = int.MaxValue;\n        var maxDiff = int.MinValue;\n        var minSumIndex = -1;\n        var maxSumIndex = -1;\n        var minDiffIndex = -1;\n        var maxDiffIndex = -1;\n\n        for (var i = 0; i < n; i++)\n        {\n            var point = points[i];\n            var x = point[0];\n            var y = point[1];\n            var sum = x + y;\n            var diff = x - y;\n\n            if (sum < minSum)\n            {\n                minSum = sum;\n                minSumIndex = i;\n            }\n\n            if (sum > maxSum)\n            {\n                maxSum = sum;\n                maxSumIndex = i;\n            }\n\n            if (diff < minDiff)\n            {\n                minDiff = diff;\n                minDiffIndex = i;\n            }\n\n            // ReSharper disable once InvertIf\n            if (diff > maxDiff)\n            {\n                maxDiff = diff;\n                maxDiffIndex = i;\n            }\n        }\n\n        var ans = int.MaxValue;\n\n        foreach (var skipIndex in new[] { minSumIndex, maxSumIndex, minDiffIndex, maxDiffIndex}.Distinct())\n        {\n            minSum = int.MaxValue;\n            maxSum = int.MinValue;\n            minDiff = int.MaxValue;\n            maxDiff = int.MinValue;\n\n            for (var i = 0; i < n; i++)\n            {\n                if (i == skipIndex)\n                {\n                    continue;\n                }\n\n                var point = points[i];\n                var x = point[0];\n                var y = point[1];\n                var sum = x + y;\n                var diff = x - y;\n\n                if (sum < minSum)\n                {\n                    minSum = sum;\n                }\n\n                if (sum > maxSum)\n                {\n                    maxSum = sum;\n                }\n\n                if (diff < minDiff)\n                {\n                    minDiff = diff;\n                }\n\n                if (diff > maxDiff)\n                {\n                    maxDiff = diff;\n                }\n            }\n\n            ans = Math.Min(ans, Math.Max(maxSum - minSum, maxDiff - minDiff));\n        }\n\n        return ans;\n    }\n}\n"
}