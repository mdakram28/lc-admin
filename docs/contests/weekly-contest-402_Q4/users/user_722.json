{
    "username": "lozy219",
    "submission": "class Solution {\npublic:\n    int lowbit(int x){\n      return x&(-x);\n    }\n    int sum(vector<int>&c, int x) {\n      int ans=0;  \n      for(int i=x; i>0; i-=lowbit(i)) ans=ans+c[i];\n      return ans;\n    }\n    // add d to x\n    void add(vector<int>&c, int x, int d) {\n        for (int i=x; i<=c.size()-1; i+=lowbit(i)) c[i] += d;\n    }\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& q) {\n        int n=nums.size();\n        vector<int> c(n+5, 0);\n        vector<int> s(n, 0);\n        for (int i=1; i<n-1; ++i) {\n            if (nums[i]>nums[i-1]&&nums[i]>nums[i+1]) {\n                add(c, i+1, 1);\n                s[i]=1;\n            }\n        }\n        vector<int> res;\n        for (int i=0; i<q.size(); ++i) {\n            if (q[i][0]==1) {\n                int l=q[i][1], r=q[i][2];\n                if (r-l+2<3) {\n                    res.push_back(0);\n                } else {\n                    res.push_back(sum(c, r)-sum(c, l+1));\n                }\n            } else {\n                int x=q[i][1], d=q[i][2];\n                // nums[x]=d;\n                if (x>=1&&x<n-1) {\n                    if (s[x]==1) {\n                        if (!(d>nums[x-1]&&d>nums[x+1])) {\n                            s[x]=0;\n                            add(c, x+1, -1);\n                        }\n                    } else {\n                        if (d>nums[x-1]&&d>nums[x+1]) {\n                            s[x]=1;\n                            add(c, x+1, 1);\n                        }\n                    }\n                }\n                if (x-1>=1&&x-1<n-1) {\n                    // cout << \"A\" << endl;\n                    if (s[x-1]==1) {\n                        if (!(d<nums[x-1]&&nums[x-1]>nums[x-2])) {\n                            s[x-1]=0;\n                            add(c, x, -1);\n                        }\n                    } else {\n                        // cout << \"A\" << endl;\n                        if (d<nums[x-1]&&nums[x-1]>nums[x-2]) {\n                            // cout << \"A\" << endl;\n                            s[x-1]=1;\n                            add(c, x, 1);\n                        }\n                    }\n                }\n                if (x+1>=1&&x+1<n-1) {\n                    if (s[x+1]==1) {\n                        if (!(d<nums[x+1]&&nums[x+1]>nums[x+2])) {\n                            s[x+1]=0;\n                            add(c, x+2, -1);\n                        }\n                    } else {\n                        if (d<nums[x+1]&&nums[x+1]>nums[x+2]) {\n                            s[x+1]=1;\n                            add(c, x+2, 1);\n                        }\n                    }\n                }\n                nums[x]=d;\n                // cout << sum(c, n+2) - sum(c, 0) << endl;\n            }\n        }\n        return res;\n    }\n};",
    "submit_ts": 1718507418.0
}