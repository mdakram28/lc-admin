{
    "username": "meyi",
    "submission": "#pragma GCC optimize(\"Ofast,no-stack-protector,unroll-loops\")\n#define ALL(v) v.begin(),v.end()\n#define For(i,_) for(int i=0,i##end=_;i<i##end;++i) // [0,_)\n#define FOR(i,_,__) for(int i=_,i##end=__;i<i##end;++i) // [_,__)\n#define Rep(i,_) for(int i=(_)-1;i>=0;--i) // [0,_)\n#define REP(i,_,__) for(int i=(__)-1,i##end=_;i>=i##end;--i) // [_,__)\ntypedef long long ll;\ntypedef unsigned long long ull;\n#define V vector\n#define pb push_back\n#define pf push_front\n#define qb pop_back\n#define qf pop_front\n#define eb emplace_back\ntypedef pair<int,int> pii;\ntypedef pair<ll,int> pli;\n#define fi first\n#define se second\nconst int dir[4][2]={{-1,0},{0,1},{1,0},{0,-1}},inf=0x3f3f3f3f,mod=1e9+7;\nconst ll infl=0x3f3f3f3f3f3f3f3fll;\ntemplate<class T>inline bool ckmin(T &x,const T &y){return x>y?x=y,1:0;}\ntemplate<class T>inline bool ckmax(T &x,const T &y){return x<y?x=y,1:0;}\nint init=[](){return cin.tie(nullptr)->sync_with_stdio(false),0;}();\ntemplate<class T>\nstruct BIT3{\n    // d-indexed [-d+1,n]->[1,n+d]\n    V<T>c;\n    int d,n;\n    inline void resize(int n_,int d_=1){\n        d=d_,n=n_;\n        V<T>(n+d+1).swap(c);\n    }\n    inline BIT3(int n=0,int d=1){resize(n,d);}\n    inline void add(int k,const T &v){\n        k+=d;\n        assert(1<=k),assert(k<=n+d);\n        for(int i=k;i<=n+d;i+=i&-i)c[i]+=v;\n    } \n    inline T query(int k){\n        k+=d;\n        assert(1<=k),assert(k<=n+d);\n        T ret=0;\n        for(int i=k;i>0;i^=i&-i)ret+=c[i];\n        return ret;\n    }\n};\nclass Solution {\npublic:\n    vector<int> countOfPeaks(vector<int>& a, vector<vector<int>>& queries) {\n        int n=a.size();\n        BIT3<int>t(n);\n        auto check=[&](int k){\n            return k>0&&k+1<n&&a[k]>max(a[k-1],a[k+1]);\n        };\n        For(i,n)if(check(i))t.add(i,1);\n        V<int>ans;\n        for(const auto &i:queries){\n            if(i[0]&1){\n                int cnt=0;\n                if(i[1]+1<i[2])cnt=t.query(i[2]-1)-t.query(i[1]);\n                ans.pb(cnt);\n            }\n            else{\n                if(check(i[1]-1))t.add(i[1]-1,-1);\n                if(check(i[1]))t.add(i[1],-1);\n                if(check(i[1]+1))t.add(i[1]+1,-1);\n                a[i[1]]=i[2];\n                if(check(i[1]-1))t.add(i[1]-1,1);\n                if(check(i[1]))t.add(i[1],1);\n                if(check(i[1]+1))t.add(i[1]+1,1);\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": 1718506202.0
}