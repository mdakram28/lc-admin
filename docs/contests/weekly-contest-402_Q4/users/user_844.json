{
    "username": "0NrhY9OB81",
    "submission": "class Solution:\n    def countOfPeaks(self, nums: List[int], queries: List[List[int]]) -> List[int]:\n        n = len(nums)\n        sm = [0] * (2 << n.bit_length())\n    \n        def build(o, l, r):\n            if l == r:\n                if 0 < l < n - 1 and nums[l - 1] < nums[l] > nums[l + 1]:\n                    sm[o] = 1\n                return\n            \n            mid = (l + r) >> 1\n            build(o * 2, l, mid)\n            build(o * 2 + 1, mid + 1, r)\n            \n            sm[o] = sm[o * 2] + sm[o * 2 + 1]\n        \n        def query(left, right):\n            def _query(o, l, r):\n                if left <= l and right >= r:\n                    return sm[o]\n                \n                ret = 0\n                mid = (l + r) >> 1\n                \n                if left <= mid:\n                    ret += _query(o * 2, l, mid)\n                if right > mid:\n                    ret += _query(o * 2 + 1, mid + 1, r)\n                \n                return ret\n            \n            return 0 if left > right else _query(1, 0, n - 1)\n        \n        def modify(idx):\n            def _modify(o, l, r):\n                if l == r:\n                    # if l > idx + 1 or l < idx - 1:\n                    #     return\n                    \n                    if 0 < l < n - 1:\n                        sm[o] = 1 if nums[l - 1] < nums[l] > nums[l + 1] else 0\n                    \n                    return\n                \n                mid = (l + r) >> 1\n                if mid >= idx - 1:\n                    _modify(o * 2, l, mid)\n                if mid + 1 <= idx + 1:\n                    _modify(o * 2 + 1, mid + 1, r)\n        \n                sm[o] = sm[o * 2] + sm[o * 2 + 1]\n            \n            return _modify(1, 0, n - 1)\n        \n        ans = []\n        build(1, 0, n - 1)\n\n        for tp, a, b in queries:\n            if tp == 1:\n                ans.append(query(a + 1, b - 1))\n            else:\n                if nums[a] == b:\n                    continue\n                \n                nums[a] = b\n                modify(a)\n        \n        return ans                    \n",
    "submit_ts": 1718508899.0
}