{
    "username": "summerdaway",
    "submission": "#define maxn 111111\nint L[maxn], a[maxn], n, s[maxn], m;\nlong long s1[maxn], s2[maxn];\npair<pair<int, int>, int> q[maxn];\n\n// class Tree {\n//     public:\n//     long long T[maxn];\n\n//     void add(int x, long long y) {\n//         for (int i = x; i <= n; i += i&-i) {\n//             T[i] += y;\n//         }\n//     }\n\n//     long long query(int x) {\n//         long long ret = 0;\n//         for (int i = x; i > 0; i -= i&-i) {\n//             ret += T[i];\n//         }\n//         return ret;\n//     }\n\n//     void init() {\n//         memset(T, 0, sizeof(T));\n//     }\n// } ct, sum;\n\nclass Solution {\npublic:\n    vector<long long> countKConstraintSubstrings(string _s, int k, vector<vector<int>>& queries) {\n        // ct.init();\n        // sum.init();\n        n = _s.size();\n        for (int i = 1; i <= n; ++i) {\n            a[i] = _s[i-1]-'0';\n            s[i] = s[i-1] + a[i];\n        }\n        for (int i = 1, j = 0; i <= n; ++i) {\n            while (j < i && s[i]-s[j]>k && (i-j)-(s[i]-s[j])>k) ++j;\n            L[i] = j;\n        }\n        for (int i = 1; i <= n; ++i) {\n            s1[i] = s1[i-1] + i;\n            s2[i] = s2[i-1] + L[i];\n        }\n\n        m = 0;\n        for (auto e: queries) {\n            q[m] = {{e[1]+1, e[0]+1}, m};\n            ++m;\n        }\n        sort(q, q+m);\n        vector<long long> ret(m, 0);\n        for (int i = 0; i < m; ++i) {\n            int l = q[i].first.second, r = q[i].first.first;\n            // for (int j = l; j <= r; ++j){\n            //     ret[q[i].second] += j-max(L[j], l-1);\n            // }\n            // continue;\n            int k = lower_bound(L+1, L+r+1, l-1) - L;\n            k = max(k, l-1);\n            // printf(\"l=%d r=%d k=%d\\n\", l, r, k);\n            // printf(\"%lld %lld\\n\", s1[r]-s1[l-1], s2[r]-s2[k-1]);\n            if (k <= r) {\n                ret[q[i].second] = s1[r]-s1[l-1]-(s2[r]-s2[k-1]+1LL*(l-1)*(k-l));\n            } else {\n                ret[q[i].second] = s1[r]-s1[l-1]-1LL*(l-1)*(r-(l-1));\n            }\n        }\n        return ret;\n    }\n};",
    "submit_ts": "1723953222",
    "subm_id": "556416265"
}