{
    "username": "\u4e3a\u4ec0\u4e48\u8981\u6f14\u594f\u6625\u65e5\u5f71",
    "submission": "class Solution {\n    public long[] countKConstraintSubstrings(String s, int k, int[][] queries) {\n        int n =s.length();\n        char[] charArray = s.toCharArray();\n        int count0 = 0,count1 = 0;\n        int[] zeroMaxIndex = new int[s.length() + 1];\n        Arrays.fill(zeroMaxIndex, s.length() - 1);\n        int[] oneMaxIndex = new int[s.length() + 1];\n        Arrays.fill(oneMaxIndex, s.length() - 1);\n        for(int i = 0;i<n;i++){\n            if(charArray[i] == '0'){\n                count0++;\n                zeroMaxIndex[count0 - 1] = i - 1;\n            }\n            else{\n                count1++;\n                oneMaxIndex[count1 - 1] = i -1;\n            }\n        }\n        int[] maxAvail = new int[n];\n        int[] maxCount = new int[n];\n        TreeMap<Integer, Integer> treeMap = new TreeMap<>();\n        count0 = 0;\n        count1 = 0;\n        for(int i = 0;i<n;i++){\n            maxAvail[i] = Math.max(count0 + k < n ? zeroMaxIndex[count0 + k] : n - 1, count1 + k < n ? oneMaxIndex[count1 + k] : n - 1);\n            maxCount[i] = maxAvail[i] - i + 1;\n            if(!treeMap.containsKey(maxAvail[i])){\n                treeMap.put(maxAvail[i], i);\n            }\n            if(charArray[i] == '0') count0++;\n            else count1++;\n        }\n        long[] countSum = new long[n];\n        for(int i = 0;i<n;i++){\n            if(i == 0) countSum[i] = maxCount[i];\n            else countSum[i] = countSum[i-1] + maxCount[i];\n        }\n        \n        \n        long[] res = new long[queries.length];\n        for(int i = 0;i<queries.length;i++){\n            int[] query = queries[i];\n            int l = query[0], r = query[1];\n            Map.Entry<Integer, Integer> entry = treeMap.ceilingEntry(r);\n            int t = entry.getValue();\n            long h = r - Math.max(t, l) + 1;\n            res[i] = (h + 1) * h / 2;\n            if(t > l){\n                res[i] += countSum[t-1] - (l > 0 ? countSum[l-1] : 0);\n            }\n\n        }\n        return res;\n    }\n\n}",
    "submit_ts": "1723953029",
    "subm_id": "556415073"
}