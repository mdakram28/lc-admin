{
    "username": "ninja_master2002",
    "submission": "class Solution {\n    #define ll long long \n    ll dp[500][500][4][4];\n    vector<vector<pair<int,int>>>v;\n    \n//     ll helper(int idx,int r,vector<vector<int>>& board,int r1,int r2){\n//         if(idx==board.size())return -1e12;\n        \n//         if(dp[idx][r][r1][r2]!=-1)return dp[idx][r][r1][r2];\n        \n//         ll ans=helper(idx+1,board,r1,r2);\n//         for(int j=0;j<3;j++){\n//             if(r1==0){\n//                 ans=max(ans,helper(idx+1,board,j+1,r2)+v[idx][j].first);\n//             }\n//             else if(r2==0){\n//                 if(v[idx][j].second!=v[r][r1-1].second){\n//                     ans=max(ans,helper(idx+1,board,r1,j+1)+v[idx][j].first);\n//                 }\n//             }\n//             else{\n//                 if(v[idx][j].second!=v[r][r1-1].second ){\n//                     ans=max(ans,helper(idx+1,board,r1,j+1)+v[idx][j].first);\n//                 }\n//             }\n//         }\n//     }\npublic:\n    long long maximumValueSum(vector<vector<int>>& board) {\n        int n=board.size();\n        v.resize(n);\n        int m=board[0].size();\n        for(int i=0;i<n;i++){\n            vector<pair<ll,ll>>temp;\n            for(int j=0;j<m;j++){\n                temp.push_back({board[i][j],j});\n            }\n            sort(temp.rbegin(),temp.rend());\n            v[i].push_back(temp[0]);\n            v[i].push_back(temp[1]);\n            v[i].push_back(temp[2]);\n        }\n        memset(dp,-1,sizeof(dp));\n        \n        vector<vector<ll>>pre(n,vector<ll>(m,-1e12));\n        for(int j=0;j<3;j++){\n            pre[n-1][v[n-1][j].second]=v[n-1][j].first;\n        }\n        for(int i=n-2;i>=0;i--){\n            for(int j=0;j<3;j++){\n                pre[i][v[i][j].second]=v[i][j].first;\n            }\n            for(int k=0;k<m;k++){\n                pre[i][k]=max(pre[i][k],pre[i+1][k]);\n            }\n        }\n        vector<vector<pair<ll,ll>>>maxi(n);\n        for(int i=0;i<n;i++){\n            vector<pair<ll,ll>>temp;\n            for(int j=0;j<m;j++){\n                temp.push_back({pre[i][j],j});\n            }\n            sort(temp.rbegin(),temp.rend());\n            maxi[i].push_back(temp[0]);\n            maxi[i].push_back(temp[1]);\n            maxi[i].push_back(temp[2]);\n        }\n        ll ans=-1e12;\n        for(int r1=0;r1<n-2;r1++){\n            for(int j1=0;j1<3;j1++){\n                for(int r2=r1+1;r2<n-1;r2++){\n                    for(int j2=0;j2<3;j2++){\n                        if(v[r1][j1].second==v[r2][j2].second)continue;\n                        for(int k=0;k<3;k++){\n                            if(maxi[r2+1][k].second!=v[r1][j1].second && maxi[r2+1][k].second!=v[r2][j2].second){\n                                ans=max(ans,0LL+v[r1][j1].first+v[r2][j2].first+maxi[r2+1][k].first);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1723909454",
    "subm_id": "1359193197"
}