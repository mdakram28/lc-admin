{
    "username": "TheCleanser",
    "submission": "typedef long long int ll;\n#define N 100005\n\nstruct segtree{\n    typedef ll T; //replace this\n\n    T id = INT_MAX, t[2 * N]; \n    // id is identity: 1 for mult, 0 for add, ll max for min, ll min for max\n    // Make sure N is >= siz of array\n    \n    T func(T a, T b) { return (a & b); } // replace this\n \n    void modify(ll p, T v) { //set value v at position p\n        for(t[p += N] = v; p /= 2;) t[p] = func(t[2 * p], t[2 * p + 1]);\n    }\n \n    T query(ll l, ll r) { //query on interval [l, r)\n        T resl = id, resr = id;\n        for(l += N, r += N; l < r; l /= 2, r /= 2) {\n            if(l & 1) resl = func(resl, t[l++]);\n            if(r & 1) resr = func(t[--r], resr);\n        }\n        return func(resl, resr);\n    }\n};\n\nstruct segtree sg;\n\nclass Solution {\npublic:\n    \n    // [good bad]\n    ll bs(ll l, ll r, ll s, ll k, ll n) \n    {\n        // r should be maxR + 1\n        while(r-l>1)\n        {\n            ll m = (l+r)/2;\n            if((m < s) || (m < n && sg.query(s, m + 1) > k)) l = m;\n            else r = m;\n        }\n        return l;\n    }\n    \n        // [good bad]\n    ll bs2(ll l, ll r, ll s, ll k, ll n) \n    {\n        // r should be maxR + 1\n        while(r-l>1)\n        {\n            ll m = (l+r)/2;\n            if((m < s) || (m < n && sg.query(s, m + 1) >= k)) l = m;\n            else r = m;\n        }\n        return l;\n    }\n    \n    long long countSubarrays(vector<int>& nums, int k) {\n        ll n = nums.size(); ll ans = 0;\n        for(int i = 0; i < n; i++){\n            sg.modify(i, nums[i]);\n        }\n        \n        for(ll i = 0; i < n; i++){\n            ll fl = bs(-1, n + 5, i, k, n); // last place where it exceeds k, so fl + 1 is the first possible good place\n            if(fl < (n - 1) && sg.query(i, fl + 2) == k){\n                ll bk = bs2(-1, n + 5, i, k, n); // last place where it is k or more\n                ans += (bk - fl);\n            }\n        }\n        \n        return ans;\n    }\n};",
    "submit_ts": "1720278573",
    "subm_id": "1311715036"
}