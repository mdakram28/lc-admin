{
    "username": "u_noob_i",
    "submission": "vector<int> st;\n\nclass Solution {\npublic:\n    int lc(int x) { return 2*x; }\n    int rc(int x) { return 2*x+1; }\n    void pull(int x) { st[x]=st[lc(x)]+st[rc(x)]; }\n    void update(int x,int tl,int tr,int i,int v){\n        if(tl>tr||tl>i||i>tr) return;\n        if(tl==tr) return void(st[x]=v);\n        int m=(tl+tr)/2;\n        update(lc(x),tl,m,i,v),update(rc(x),m+1,tr,i,v);\n        pull(x);\n    }\n    int query(int x,int tl,int tr,int l,int r){\n        if(tl>tr||tl>r||l>tr) return 0;\n        if(l<=tl&&tr<=r) return st[x];\n        int m=(tl+tr)/2;\n        return query(lc(x),tl,m,l,r)+query(rc(x),m+1,tr,l,r);\n    }\n    vector<int> countOfPeaks(vector<int>& a, vector<vector<int>>& q) {\n        int n=a.size();\n        vector<int> ret;\n        st.assign(4*n+20,0);\n        for(int i=1;i<n-1;i++) if(a[i]>a[i-1]&&a[i]>a[i+1]) update(1,0,n-1,i,1);\n        auto check=[&](int i,int v){\n            if(i>0&&i<n-1&&a[i]>a[i-1]&&a[i]>a[i+1]) update(1,0,n-1,i,v);  \n        };\n        for(auto &x:q){\n            if(x[0]==1){\n                ret.push_back(query(1,0,n-1,x[1],x[2]));\n                if(x[1]>0&&x[1]<n-1&&a[x[1]]>a[x[1]-1]&&a[x[1]]>a[x[1]+1]) ret.back()--;\n                if(x[1]!=x[2]&&x[2]>0&&x[2]<n-1&&a[x[2]]>a[x[2]-1]&&a[x[2]]>a[x[2]+1]) ret.back()--;\n            }\n            else{\n                check(x[1],0),check(x[1]-1,0),check(x[1]+1,0);\n                a[x[1]]=x[2];\n                check(x[1],1),check(x[1]-1,1),check(x[1]+1,1);\n            }\n        }\n        return ret;\n    }\n};",
    "submit_ts": "1718506454",
    "subm_id": "1289619606"
}