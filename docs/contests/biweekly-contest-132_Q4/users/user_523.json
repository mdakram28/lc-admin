{
    "username": "amsraman",
    "submission": "class Solution {\npublic:\n    int maximumLength(vector<int>& nums, int k) {\n        int n = (int) nums.size();\n        vector<vector<int>> dp(n, vector<int>(k + 1, -1e9));\n        vector<multiset<int>> bank(k + 1);\n        vector<map<int, int>> bst(k + 1);\n        for(int i = 0; i < n; i++) {\n            dp[i][0] = 1;\n            for(int j = 0; j <= k; j++) {\n                if(j > 0) dp[i][j] = dp[i][j - 1];\n                if(bst[j].count(nums[i])) dp[i][j] = max(dp[i][j], bst[j][nums[i]] + 1);\n                if(j > 0) {\n                    // assert(bank[j - 1].count(bst[j - 1][nums[i]]));\n                    if(bst[j - 1].count(nums[i])) {\n                        auto it = --bank[j - 1].end();\n                        if(*it == bst[j - 1][nums[i]] && it != bank[j - 1].begin()) {\n                            --it; dp[i][j] = max(dp[i][j], *it + 1);\n                        } else if(*it != bst[j - 1][nums[i]]) {\n                            dp[i][j] = max(dp[i][j], *it + 1);\n                        }\n                    } else if(!bank[j - 1].empty()) {\n                        dp[i][j] = max(dp[i][j], *--bank[j - 1].end() + 1);\n                    }\n                }\n                /*\n                for(int pv = 0; pv < i; pv++) {\n                    if(nums[pv] == nums[i]) {\n                        dp[i][j] = max(dp[i][j], dp[pv][j] + 1);\n                    } else if(j > 0) {\n                        dp[i][j] = max(dp[i][j], dp[pv][j - 1] + 1);\n                    }\n                }\n                */\n                if(bst[j].count(nums[i])) bank[j].erase(bank[j].find(bst[j][nums[i]]));\n                bst[j][nums[i]] = max(bst[j][nums[i]], dp[i][j]);\n                bank[j].insert(bst[j][nums[i]]);\n            }\n        }\n        int res = 0;\n        for(int i = 0; i < n; i++) res = max(res, dp[i][k]);\n        return res;\n    }\n};\n/*\nan array is good if there's at most k context switches\n\ndp[i][j] right?\n*/",
    "submit_ts": 1717860429.0
}