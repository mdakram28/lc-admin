{
    "username": "perry304",
    "submission": "class FenwickTree:\n    def __init__(self, size):\n        self.size = size\n        self.tree = [0] * (size + 1)\n    \n    def update(self, index, delta):\n        index += 1\n        while index <= self.size:\n            self.tree[index] += delta\n            index += index & -index\n    \n    def query(self, index):\n        index += 1\n        sum = 0\n        while index > 0:\n            sum += self.tree[index]\n            index -= index & -index\n        return sum\n    \n    def range_query(self, left, right):\n        return self.query(right) - self.query(left - 1)\n\nclass Solution:\n\n    def countOfPeaks(self, nums, queries):\n        def is_peak(nums, i):\n            return nums[i] > nums[i - 1] and nums[i] > nums[i + 1]\n    \n        n = len(nums)\n        peaks = [0] * n\n        fenwick_tree = FenwickTree(n)\n\n        # Initialize peaks array and Fenwick tree\n        for i in range(1, n - 1):\n            if is_peak(nums, i):\n                peaks[i] = 1\n                fenwick_tree.update(i, 1)\n\n        result = []\n        for query in queries:\n            if query[0] == 1:\n                # Type 1 query: count peaks in subarray nums[li..ri]\n                li, ri = query[1], query[2]\n                if ri - li < 2:\n                    result.append(0)\n                else:\n                    result.append(fenwick_tree.range_query(li + 1, ri - 1))\n            elif query[0] == 2:\n                # Type 2 query: change nums[indexi] to vali\n                indexi, vali = query[1], query[2]\n                nums[indexi] = vali\n\n                # Update peaks and Fenwick tree around the changed index\n                for i in range(max(1, indexi - 1), min(n - 1, indexi + 2)):\n                    was_peak = peaks[i]\n                    is_now_peak = is_peak(nums, i)\n                    if was_peak != is_now_peak:\n                        peaks[i] = 1 if is_now_peak else 0\n                        fenwick_tree.update(i, 1 if is_now_peak else -1)\n\n        return result",
    "submit_ts": 1718506831.0
}