{
    "username": "lxhgww",
    "submission": "class Solution {\npublic:\n    //segment tree\n    int a[100001];\n    long long w[400001];\n    void init(int x,int l,int r) {\n        if (l==r) w[x]=a[l];\n        else {\n            int m=(l+r)/2;\n            init(2*x,l,m);\n            init(2*x+1,m+1,r);\n            w[x]=w[2*x]+w[2*x+1];\n        }\n    }\n    \n    long long query(int x,int l,int h,int ll,int hh) {\n        if (l==ll&&h==hh) return w[x];\n        else {\n            int m=(l+h)/2;\n            if (hh<=m) return query(2*x,l,m,ll,hh);\n            else {\n\t\t        if (ll<=m) return query(2*x,l,m,ll,m)+query(2*x+1,m+1,h,m+1,hh);\n\t\t        else return query(2*x+1,m+1,h,ll,hh);\n\t        }\n        }\n    }\n\n    void insert(int x,int l,int h,int p) {\n        if (l==h) w[x]=a[p];\n        else {\n            int m=(l+h)/2;\n            if (p<=m) insert(2*x,l,m,p);\n            else insert(2*x+1,m+1,h,p);\n            w[x]=w[2*x]+w[2*x+1];\n        }\n    }\n    \n    vector<int> countOfPeaks(vector<int>& b, vector<vector<int>>& q) {\n        int n=b.size();\n        for (int i=1;i<n-1;i++)\n            if (b[i]>b[i-1]&&b[i]>b[i+1]) a[i]=1;\n\n        init(1,0,n-1);\n        vector<int> res;\n        for (int i=0;i<q.size();i++) {\n            if (q[i][0]==1) {\n                if (q[i][1]+1>q[i][2]-1) res.push_back(0);\n                else res.push_back(query(1,0,n-1,q[i][1]+1,q[i][2]-1));\n            } else {\n                int x=q[i][1];\n                b[x]=q[i][2];\n                if (x>=2) {\n                    int tt=0;\n                    if (b[x-1]>b[x-2]&&b[x-1]>b[x]) tt=1;\n                    if (tt!=a[x-1]) {\n                        a[x-1]=tt;\n                        insert(1,0,n-1,x-1);\n                    }\n                }\n                if (x>0&&x+1<n) {\n                    int tt=0;\n                    if (b[x]>b[x-1]&&b[x]>b[x+1]) tt=1;\n                    if (tt!=a[x]) {\n                        a[x]=tt;\n                        insert(1,0,n-1,x);\n                    }\n                }\n                if (x+2<n) {\n                    int tt=0;\n                    if (b[x+1]>b[x+2]&&b[x+1]>b[x]) tt=1;\n                    if (tt!=a[x+1]) {\n                        a[x+1]=tt;\n                        insert(1,0,n-1,x+1);\n                    }\n                }\n            }\n        }\n        return res;\n    }\n};",
    "submit_ts": 1718506525.0
}