{
    "username": "yge2",
    "submission": "class Solution {\n    class T {\n        T l, r;\n        int p, q, v;\n        public T(int ll, int rr, int[] a) {\n            p = ll;\n            q = rr;\n            if (p != q) {\n                int mid = (p + q) / 2;\n                l = new T(p, mid, a);\n                r = new T(mid+1, q, a);\n                v = l.v + r.v;\n            } else\n                v = a[p];\n        }\n        public int query(int ll, int rr) {\n            if (ll <= p && rr >= q)\n                return v;\n            if (rr < p || ll > q)\n                return 0;\n            return l.query(ll, rr) + r.query(ll, rr);\n        }\n        public void update(int z, int vv) {\n            if (z < p || z > q)\n                return;\n            if (p == q) {\n                v = vv;\n                return;\n            }\n            v += vv * 2 - 1;\n            int mid = (p + q) / 2;\n            if (z <= mid)\n                l.update(z, vv);\n            else\n                r.update(z, vv);\n        }\n    }\n    private boolean isPeak(int[] nums, int i) {\n        return i > 0 && i < nums.length - 1 && nums[i] > nums[i-1] && nums[i] > nums[i+1];\n    }\n    public List<Integer> countOfPeaks(int[] nums, int[][] q) {\n        int n = nums.length;\n        int m = q.length;\n        int[] a = new int[n];\n        for (int i=0; i<n; i++)\n            a[i] = isPeak(nums, i) ? 1 : 0;\n        T t = new T(0, n-1, a);\n        List<Integer> ans = new ArrayList<>();\n        for (int i=0; i<m; i++) {\n            if (q[i][0] == 1) {\n                if (q[i][1] + 1 >= q[i][2])\n                    ans.add(0);\n                else\n                    ans.add(t.query(q[i][1] + 1, q[i][2] - 1));\n            }\n            else {\n                int z = q[i][1];\n                nums[z] = q[i][2];\n                for (int j=0; j<3; j++) {\n                    if (z - 1 + j < 0 || z - 1 + j >= n-1)\n                        continue;\n                    int y = isPeak(nums, z - 1 + j) ? 1 : 0;\n                    if (y != a[z-1+j]) {\n                        a[z-1+j] = y;\n                        t.update(z-1+j, y);\n                    }\n                }\n            }\n        }\n        return ans;\n    }\n}",
    "submit_ts": 1718508654.0
}