{
    "username": "SupervisorMayHap",
    "submission": "\n\nclass Solution:\n    \n    \n    def countOfPeaks(self, nums: List[int], queries: List[List[int]]) -> List[int]:\n        res = []\n        max_v = 100005\n        tree = [0] * 100005\n        \n        def update(index, v):\n            while index < max_v:\n                tree[index] += v\n                index += index & -index\n        \n        def query(index):\n            count = 0\n            while index > 0:\n                count += tree[index]\n                index -= index & -index\n            return count\n        \n        def query_range(left, right):\n            return query(right) - query(left - 1)\n        \n        for i in range(1, len(nums) - 1):\n            if nums[i] > nums[i-1] and nums[i] > nums[i + 1]:\n                update(i, 1)\n                \n        n= len(nums)\n        \n        for op, v1, v2 in queries:\n            if op == 1:\n                if v2 - v1 < 2:\n                    res.append(0)\n                else:\n                    res.append(query_range(v1 + 1, v2 - 1))\n            else:\n                if v1 > 0 and v1 < n - 1:\n                    prev = nums[v1] > nums[v1-1] and nums[v1] > nums[v1 + 1]\n                    cur = v2 > nums[v1-1] and v2 > nums[v1 + 1]\n                    if prev and not cur:\n                        update(v1, -1)\n                    if not prev and cur:\n                        update(v1, 1)\n                if v1 > 1:\n                    prev = nums[v1-1] > nums[v1-2] and nums[v1-1] > nums[v1]\n                    cur = nums[v1-1] > nums[v1-2] and nums[v1-1] > v2\n                    if prev and not cur:\n                        update(v1-1, -1)\n                    if not prev and cur:\n                        update(v1-1, 1)\n                if v1 < n - 2:\n                    prev = nums[v1+1] > nums[v1+2] and nums[v1+1] > nums[v1]\n                    cur = nums[v1+1] > nums[v1+2] and nums[v1+1] > v2\n                    if prev and not cur:\n                        update(v1+1, -1)\n                    if not prev and cur:\n                        update(v1+1, 1)\n                nums[v1] = v2\n            # for i in range(n):\n            #     print(query_range(i, i), end=' ')\n            # print()\n                \n        return res\n        \n         \n        \n        \n        \n        \n        \n        ",
    "submit_ts": 1718506683.0
}