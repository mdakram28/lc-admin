{
    "username": "lian-xu-han-shu",
    "submission": "const int N=1e5+10;\ntypedef pair<int,int>PII;\nclass Solution {\n    struct Node\n    {\n        int l, r;\n        int v;  // \u533a\u95f4[l, r]\u4e2d\u7684\u6700\u5927\u503c\n    }tr[N * 4];\n\n    void pushup(int u)  // \u7531\u5b50\u8282\u70b9\u7684\u4fe1\u606f\uff0c\u6765\u8ba1\u7b97\u7236\u8282\u70b9\u7684\u4fe1\u606f\n    {\n        tr[u].v = max(tr[u << 1].v, tr[u << 1 | 1].v);\n    }\n\n    void build(int u, int l, int r)\n    {\n        tr[u] = {l, r};\n        if (l == r) return;\n        int mid = l + r >> 1;\n        build(u << 1, l, mid), build(u << 1 | 1, mid + 1, r);\n    }\n\n    int query(int u, int l, int r)\n    {\n        if (tr[u].l >= l && tr[u].r <= r) return tr[u].v;   // \u6811\u4e2d\u8282\u70b9\uff0c\u5df2\u7ecf\u88ab\u5b8c\u5168\u5305\u542b\u5728[l, r]\u4e2d\u4e86\n\n        int mid = tr[u].l + tr[u].r >> 1;\n        int v = 0;\n        if (l <= mid) v = query(u << 1, l, r);\n        if (r > mid) v = max(v, query(u << 1 | 1, l, r));\n\n        return v;\n    }\n\n    void modify(int u, int x, int v)\n    {\n        if (tr[u].l == x && tr[u].r == x) tr[u].v = max(tr[u].v,v);\n        else\n        {\n            int mid = tr[u].l + tr[u].r >> 1;\n            if (x <= mid) modify(u << 1, x, v);\n            else modify(u << 1 | 1, x, v);\n            pushup(u);\n        }\n    }\n\npublic:\n    vector<int> shortestDistanceAfterQueries(int n, vector<vector<int>>& queries) {\n        vector<int>ans;\n        build(1, 1, n);\n        \n        int res=n-1;\n        map<int,int>mp;\n        for(auto q:queries){\n            int u=q[0]+1,v=q[1]+1;\n            int que=query(1,1,u);\n            modify(1,u,v);\n            if(que>=v){\n                ans.push_back(res);\n                continue;\n            }\n            auto it=mp.lower_bound(u);\n            while(it!=mp.end() && it->second<=v){\n                res+=(it->second-it->first-1);\n                int v=it->first;\n                it++;\n                mp.erase(v);\n            }\n            res-=v-u-1;\n            ans.push_back(res);\n            mp[u]=v;\n        }\n        \n        return ans;\n    }\n};",
    "submit_ts": "1722743709",
    "subm_id": "552352368"
}