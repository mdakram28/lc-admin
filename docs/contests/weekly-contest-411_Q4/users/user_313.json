{
    "username": "Upbeat HugleukS",
    "submission": "class Solution {\npublic:\n    vector<long long> countKConstraintSubstrings(string s, int k, vector<vector<int>>& queries) {\n        int n = s.size();\n        vector<int> cnt(n + 1);\n        vector<int> rr(n + 1);\n        int l = 0, r = 0;\n        int zero = 0, one = 0;\n        for(l = 0; l < n; l ++)\n        {\n            while(r < n)\n            {\n                if(s[r] == '1')\n                {\n                    if(one + 1 <= k || zero <= k) \n                    {\n                        r ++;\n                        one ++;\n                    }\n                    else break;\n                }\n                else \n                {\n                    if(zero + 1 <= k || one <= k)\n                    {\n                        r ++;\n                        zero ++;\n                    }\n                    else break;\n                }\n            }\n            cnt[l] = r - l;\n            rr[l] = r - 1;\n            if(s[l] == '0') zero --;\n            else one --;\n        }\n        \n        int m = queries.size();\n        vector<long long> res(m);\n        vector<long long> pre(n + 1, 0);\n        for(int i = 1; i <= n; i ++)\n            pre[i] = pre[i - 1] + cnt[i - 1];\n        auto check = [&](int L, int R)\n        {\n           \n           int f = R;\n           while(L < R)\n           {\n               int mid = L + R >> 1;\n               if(rr[mid] > f) R = mid;\n               else L = mid + 1;\n           }\n           \n            return L;\n        };\n        for(int i = 0; i < m; i ++)\n        {\n            int L = queries[i][0], R = queries[i][1];\n            int d = check(L, R);\n          //  cout << \"d: \"<< d << \"\\n\";\n            int c = R - d + 1;\n           // cout << \"c: \"<< c << \"\\n\";\n            res[i] = pre[R + 1] - pre[L] - (pre[R + 1] - pre[d]) + (long long)(c + 1) * c / 2;\n        }\n       // for(int i = 0; i < n; i ++)\n      //      cout << cnt[i] << \" \";\n      //  cout << \"\\n\";\n      //  for(int i = 0; i < n; i ++)\n      //      cout << rr[i] << \" \";\n        return res;\n    }\n};",
    "submit_ts": "1723953398",
    "subm_id": "556417332"
}