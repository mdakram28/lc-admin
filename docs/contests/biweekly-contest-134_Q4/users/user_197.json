{
    "username": "lowie_",
    "submission": "class SegmentTree {\n    vector <int> ST;\n    int n;\n\n    void UPD(int id, int l, int r, int u, int g) {\n        if (u < l || u > r) {\n            return;\n        }\n        if (l == r) {\n            ST[id] = g;\n            return;\n        }\n\n        int mid = (l + r) / 2;\n        UPD(id * 2, l, mid, u, g);\n        UPD(id * 2 + 1, mid + 1, r, u, g);\n        ST[id] = (ST[id * 2] & ST[id * 2 + 1]);\n    }\n\n    int GET(int id, int l, int r, int u, int v) {\n        if (v < l || u > r) {\n            return -1;\n        }\n        if (u <= l && r <= v) {\n            return ST[id];\n        }\n\n        int mid = (l + r) / 2;\n        int r1 = GET(id * 2, l, mid, u, v);\n        int r2 = GET(id * 2 + 1, mid + 1, r, u, v);\n        return (r1 & r2);\n    }\npublic:\n    SegmentTree(vector <int> v) {\n        n = v.size();\n        ST.assign(n * 4, 0);\n        for (int i = 0; i < n; i++) {\n            this->update(i, v[i]);\n        }\n    }\n\n    void update(int u, int g) {\n        UPD(1, 1, n, u + 1, g);\n    }\n\n    int get(int u, int v) {\n        return GET(1, 1, n, u + 1, v + 1);\n    }\n};\n\nclass Solution {\npublic:\n    long long countSubarrays(vector<int>& nums, int k) {\n        SegmentTree st(nums);\n        int n = nums.size();\n        long long res = 0;\n        for (int i = 0; i < n; i++) {\n            if ((nums[i] & k) < k) {\n                continue;\n            }\n            int l = i, r = n;\n            while (r > l) {\n                int mid = (l + r) / 2;\n\n                int andSum = st.get(i, mid);\n                if ((andSum & k) == k) {\n                    l = mid + 1;\n                } else {\n                    r = mid;\n                }\n            }\n            res += l;\n            l = i, r = n;\n            while (r > l) {\n                int mid = (l + r) / 2;\n                int andSum = st.get(i, mid);\n                if ((andSum & k) == k && andSum > k) {\n                    l = mid + 1;\n                } else {\n                    r = mid;\n                }\n            }\n            res -= l;\n        }\n        return res;\n    }\n};",
    "submit_ts": "1720278308",
    "subm_id": "1311703529"
}