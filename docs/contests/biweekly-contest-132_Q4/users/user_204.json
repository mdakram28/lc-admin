{
    "username": "Abdo_Saad",
    "submission": "const int N = 3e5 + 5;\nint v[N];\nint seg[4 * N][51];\nint l, r, n, idx, pos;\nint val;\nstruct segmentTree\n{\n#define LEFT 2*p,s,(s+e)/2\n#define RIGHT 2*p+1,(s+e)/2+1,e\n#define MID (s+e)/2\n#define IN l <= s && e <= r\n#define OUT r < s || e < l\n\n\tvoid build(int p = 1, int s = 0, int e = n - 1)\n\t{\n\t\tif (s == e)\n\t\t{\n\t\t\tseg[p][idx] =0;\n\t\t\treturn;\n\t\t}\n\t\tbuild(LEFT);\n\t\tbuild(RIGHT);\n\t\tseg[p][idx] = max(seg[2 * p][idx], seg[2 * p + 1][idx]);\n\t}\n\tint get(int p = 1, int s = 0, int e = n - 1)\n\t{\n\t\tif (OUT)return 0;\n\t\tif (IN)return seg[p][idx];\n\t\treturn max(get(LEFT), get(RIGHT));\n\t}\n\tvoid updateIdx(int p = 1, int s = 0, int e = n - 1)\n\t{\n\t\tif (s == e)\n\t\t{\n\t\t\tseg[p][idx] = val;\n\t\t\treturn;\n\t\t}\n\t\tif (pos <= MID)updateIdx(LEFT);\n\t\telse updateIdx(RIGHT);\n\t\tseg[p][idx] = max(seg[2 * p][idx], seg[2 * p + 1][idx]);\n\t}\n};\nclass Solution {\npublic:\n    int maximumLength(vector<int>& v, int k) {\n        int sz=v.size();\n        set<int>dis;\n        for (int i = 0;i < sz;i++)\n            dis.insert(v[i]);\n        map<int, int>mp;\n        int id = 0;\n        for (auto it : dis)\n            mp[it] = id++;\n        n = id;\n        r = n-1;\n        segmentTree st;\n        vector<vector<int>>dp(n, vector<int>(k + 1));\n        for (int i = 0;i <= k;i++)\n        {\n            idx = i;\n            st.build();\n        }\n        for (int i = 0;i < sz;i++)\n        {\n\n            for (int j = 0;j <=k ;j++)\n            {\n                int element = mp[v[i]];\n                dp[element][j]++;\n                if (j < k)\n                {\n                    idx = j + 1;\n                    dp[element][j] = max(dp[element][j], st.get()+1);\n\n                }\n                pos = element;\n                val = dp[element][j];\n                idx = j;\n                st.updateIdx();\n            }\n        }\n        int mx = 0;\n        for (int i = 0;i < n;i++)\n            mx = max(mx, dp[i][0]);\n        return mx;\n    }\n};",
    "submit_ts": 1717861182.0
}