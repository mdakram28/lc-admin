{
    "username": "scanhex",
    "submission": "class Solution {\npublic:\n    int maximumSumSubsequence(vector<int>& nums, vector<vector<int>>& q) {\n        int n = nums.size();\n        int cur = 0;\n        const int BL = 150;\n        const int cbl = (n + BL - 1) / BL;\n        using nagai = long long;\n        using rfl = array<array<nagai, 2>, 2>;\n        array<nagai, 2> emp1 = {0, 0};\n        rfl emp = {emp1, emp1};\n        vector<rfl> bl(cbl, emp);\n        auto calc = [&](int i) {\n            int l = i * BL, r = min(n, (i + 1) * BL);\n            for (int st = 0; st < 2; ++st) {\n                nagai cur = 0, curn = 0;\n                for (int i = l + st; i < r; ++i) {\n                    int ncurn = cur; \n                    int ncur = max(cur, curn + max(0, nums[i]));\n                    curn = ncurn;\n                    cur = ncur;\n                }\n                bl[i][st][0] = cur;\n                bl[i][st][1] = curn;\n            }\n        };\n        auto merge = [&]( rfl& a, const rfl& b) {\n            int x = a[0][0];\n            a[0][0] = max(a[0][0] + b[1][0], a[0][1] + b[0][0]);\n            a[0][1] = max(x + b[1][1], a[0][1] + b[0][1]);\n            x = a[1][0];\n            a[1][0] = max(a[1][0] + b[1][0], a[1][1] + b[0][0]);\n            a[1][1] = max(x + b[1][1], a[1][1] + b[0][1]);\n        };\n        for (int i = 0; i < cbl; ++i) {\n            calc(i);\n        }\n        const int mod = 1e9 + 7;\n        nagai ans = 0;\n        for (int i = 0; i < q.size(); ++i) {\n            nums[q[i][0]] = q[i][1];\n            calc(q[i][0] / BL);\n            auto cur = bl[0];\n            for (int i = 1; i < cbl; ++i) {\n                merge(cur, bl[i]);\n            }\n            ans += cur[0][0];\n            ans %= mod;\n        }\n        return ans;\n    }\n};\n\n",
    "submit_ts": 1716692244.0
}