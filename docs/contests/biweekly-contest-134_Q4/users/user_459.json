{
    "username": "sagsango",
    "submission": "class Solution {\npublic:\n    long long countSubarrays(vector<int>& arr, int k) {\n        int n = arr.size();\n        int log[n+1];\n        log[1] = 0;\n        for (int i=2; i<=n; ++i) {\n            log[i] = 1 + log[i>>1];\n        }\n        \n        int dp[n][20];\n        for (int i=0; i<n; ++i) {\n            //arr[i] &= k;\n            dp[i][0] = arr[i];\n        }\n        for (int j=1; j<20; ++j) {\n            for (int i=0; i<n; ++i) {\n                if (i+(1<<j)-1 < n) {\n                    dp[i][j] = dp[i][j-1] & dp[i+(1<<(j-1))][j-1];\n                }\n            }\n        }\n        \n        auto query = [&](int l, int r) {\n            \n            int j = log[(r-l+1)];\n            //cout << \"query:\" << l <<\" \"<< r <<\" \"<<(dp[l][j] & dp[r-(1<<j)+1][j]) << endl;\n            return dp[l][j] & dp[r-(1<<j)+1][j];\n        };\n        \n        \n        //return 0;\n        \n        long long ans = 0;\n        \n        for (int i=0; i<n; ++i) {\n            if (arr[i] & k != k) {\n                continue;\n            }\n            \n            int mn = -1 , mx = -1;\n            {\n                int l = i, r = n;\n                while (l+1<r) {\n                    int m = (l+r)>>1;\n                    ((query(i,m) & k) == k ? l : r) = m;\n                }\n                mx = l;\n                \n                if (query(i, mx) != k) {\n                    continue;\n                }\n               // cout << i <<\" \"<< mn <<\" \"<< mx << endl;\n            }\n            \n            {\n                \n                int l = i-1, r = mx;\n                while (l+1<r) {\n                    int m = (l+r)>>1;\n                    (query(i,m) == k ? r : l) = m;\n                }\n                \n                mn = r;\n                \n            }\n            //cout << i <<\" \"<< mn <<\" \"<< mx << endl;\n            int len = mx - mn + 1;\n            ans += len ; //(1ll* len * (len+1))/2;\n        }\n        \n        //cout <<\"-----\" <<dp[1][1]<<\" \"<< query(1,2)<< endl;\n        return ans;\n        \n    }\n};",
    "submit_ts": "1720279296",
    "subm_id": "1311745563"
}