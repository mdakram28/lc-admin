{
    "username": "Duc Minh Le",
    "submission": "#define pb push_back\nclass Solution {\npublic:\n    vector<long long> countKConstraintSubstrings(string s, int k, vector<vector<int>>& queries) {\n        long long n,i,j,l,r,w;\n        n = s.size();\n        s = \"0\" + s;\n\n        vector<long long> prefix0, prefix1;\n\n        prefix0.pb(0);prefix1.pb(0);\n\n        for (i=1;i<n+1;i++)\n        {\n            prefix0.pb(prefix0[i-1]);\n            prefix1.pb(prefix1[i-1]);\n\n            if (s[i] == '0') prefix0[i]++;else prefix1[i]++;\n        }\n\n        vector<long long> maxgood;\n        maxgood.pb(0);\n\n        for (i=1;i<n+1;i++)\n        {\n            l=i;r=n;maxgood.pb(i);\n            while (l<=r)\n            {\n                w = (l+r)/2;\n                if (prefix0[w]-prefix0[i-1] <=k or prefix1[w]-prefix1[i-1] <=k)\n                {\n                    maxgood[i] = w;\n                    l = w+1;\n                }\n                else r = w-1;\n            }\n        }\n\n        vector<long long> maxgood_prefix;\n        maxgood_prefix.pb(0);\n\n        for (i=1;i<n+1;i++) maxgood_prefix.pb(maxgood_prefix[i-1] + maxgood[i] - i + 1);\n\n        //for (i=1;i<n+1;i++) cout<<maxgood_prefix[i]<<\" \";\n\n        vector<long long> ans_return;\n\n        for (auto x:queries)\n        {\n            long long l_query, r_query, tip, ans;\n            l_query= x[0]+1; r_query = x[1]+1;\n\n            l = l_query-1; r = n; tip = l_query-1;\n            while (l<=r)\n            {\n                w = (l+r)/2;\n                if (maxgood[w] < r_query)\n                {\n                    tip = w;\n                    l = w+1;\n                }\n                else r = w-1;\n            }\n\n            if (tip >= l_query) ans = maxgood_prefix[tip] - maxgood_prefix[l_query-1];else ans = 0;\n\n            ans += (r_query + 1) * (r_query - tip) - ((r_query + tip + 1) * (r_query - tip)) / 2;\n\n            ans_return.pb(ans);\n        }\n\n        return ans_return;\n    }\n};",
    "submit_ts": "1723952157",
    "subm_id": "1359789328"
}