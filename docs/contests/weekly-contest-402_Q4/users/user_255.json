{
    "username": "szp14",
    "submission": "const int maxn = 1e5 + 5;\nint A[maxn];\nint lb(int x) {return x & -x;}\nvoid add(int x, int v)\n{\n    while(x < maxn)\n    {\n        A[x] += v;\n        x += lb(x);\n    }\n}\nint sum(int x)\n{\n    int ans = 0;\n    while(x > 0)\n    {\n        ans += A[x];\n        x -= lb(x);\n    }\n    return ans;\n}\n\nbool isPeak(int idx, int v, vector<int>& A)\n{\n    int n = (int)A.size();\n    if(idx == 0 || idx == n - 1) return false;\n    return v > A[idx - 1] && v > A[idx + 1];\n}\n\nclass Solution {\npublic:\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n        int n = (int)nums.size();\n    memset(A, 0, sizeof(A));\n    for(int i = 1; i < n - 1; i++)\n        if(nums[i] > nums[i - 1] && nums[i] > nums[i + 1])\n            add(i, 1);\n    int Q = (int)queries.size();\n    vector<int> ans;\n    for(int i = 0; i < Q; i++)\n    {\n        if(queries[i][0] == 1)\n        {\n            int l = queries[i][1], r = queries[i][2];\n            if(r - l < 2) ans.push_back(0);\n            else ans.push_back(sum(r - 1) - sum(l));\n        }\n        else\n        {\n            int idx = queries[i][1], val = queries[i][2];\n            \n            bool p0 = isPeak(idx, nums[idx], nums), p1 = isPeak(idx, val, nums);\n            if(!p0 && p1) add(idx, 1);\n            else if(p0 && !p1) add(idx, -1);\n            if(idx - 2 >= 0)\n            {\n                p0 = nums[idx - 1] > nums[idx - 2] && nums[idx - 1] > nums[idx];\n                p1 = nums[idx - 1] > nums[idx - 2] && nums[idx - 1] > val;\n                if(!p0 && p1) add(idx - 1, 1);\n                else if(p0 && !p1) add(idx - 1, -1);\n            }\n            if(idx + 2 < n)\n            {\n                p0 = nums[idx + 1] > nums[idx + 2] && nums[idx + 1] > nums[idx];\n                p1 = nums[idx + 1] > nums[idx + 2] && nums[idx + 1] > val;\n                if(!p0 && p1) add(idx + 1, 1);\n                else if(p0 && !p1) add(idx + 1, -1);\n            }\n            nums[idx] = val;\n        }\n    }\n    return ans;\n    }\n};",
    "submit_ts": "1718506953",
    "subm_id": "1289636394"
}