{
    "username": "milesian-c",
    "submission": "struct syq{\n    int l,r;\n    int sum;\n}a[400020];\nint b[100020];\nint lft,rgt;\nint n,q;\nclass Solution {\npublic:\n    void create(int r,int x, int y){\n        a[r].l = x;\n        a[r].r = y;\n        if(x == y){\n            if(x > 0 && x < n-1 && b[x] > b[x-1] && b[x] > b[x+1]){\n                a[r].sum = 1;\n            }else a[r].sum = 0;\n            return;\n        }\n        int mid = (x+y) >> 1;\n        create(r<<1,x,mid);\n        create(r<<1|1,mid+1,y);\n        a[r].sum = a[r<<1].sum + a[r<<1|1].sum;\n        printf(\"create: %d %d %d\\n\",x,y,a[r].sum);\n    }\n    void change(int r){\n        if(a[r].l == a[r].r){\n            int x = a[r].l;\n            if(x > 0 && x < n-1 && b[x] > b[x-1] && b[x] > b[x+1]){\n                a[r].sum = 1;\n            }else a[r].sum = 0;\n            return;           \n        }\n        int mid = (a[r<<1].r);\n        if(lft <= mid)change(r<<1);\n        if(rgt > mid) change(r<<1|1);\n        a[r].sum = a[r<<1].sum + a[r<<1|1].sum;\n    }\n    int query(int r){\n        if(a[r].l >= lft && a[r].r <= rgt)return a[r].sum;\n        int mid = a[r<<1].r;\n        if(rgt <= mid) return query(r<<1);\n        if(lft > mid)return query(r<<1|1);\n        return query(r<<1) + query(r<<1|1);\n    }\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n        n = nums.size();\n        for(int i=0;i<n;++i){\n            b[i] = nums[i];\n        }\n        create(1,0,n-1);\n        q = queries.size();\n        vector<int> ret;\n        for(int i=0;i<q;++i){\n            int opt = queries[i][0];\n            if(opt == 1){\n                lft = queries[i][1] + 1;\n                rgt = queries[i][2] - 1;\n                if(lft <= rgt) \n                ret.push_back(query(1));\n                else ret.push_back(0);\n            }else{\n                b[queries[i][1]] = queries[i][2];\n                lft = max(0, queries[i][1] - 1);\n                rgt = min(n-1, queries[i][1] + 1);\n                change(1);\n            }\n        }\n        return ret;\n    }\n};",
    "submit_ts": 1718506150.0
}