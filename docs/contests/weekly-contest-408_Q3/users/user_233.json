{
    "username": "rohinth076",
    "submission": "class Solution {\n    int[] find(String s,char val){\n        int n = s.length();\n        int[] prev = new int[n];\n        Arrays.fill(prev,-1);\n        Stack<Integer> stack = new Stack<>();\n        for(int i=n-1;i>=0;i--){\n            if(s.charAt(i) == val)\n                while(!stack.isEmpty()){\n                    prev[stack.pop()] = i;\n                }\n            stack.push(i);\n        }\n        return prev;\n    }\n    public int numberOfSubstrings(String s) {\n        int n = s.length();\n        int[] zero = find(s,'0'),one = find(s,'1');\n        int[] prefix = new int[n];\n        for(int i=0;i<n;i++){\n            prefix[i] = s.charAt(i) - '0';\n            if(i != 0)prefix[i] += prefix[i-1];\n        }\n        int ans = 0;\n        for(int i=0;i<n;i++){\n            //System.out.println(\"level ::: \"+i+\" \"+ans);\n            int next = -1;\n            int prev = i;\n            boolean flag = false;\n            if(s.charAt(i) == '1'){\n                ans++;\n                flag = true;\n                next = zero[i];\n            }else{\n                next = one[i];\n            }\n            if(flag && next < 0){\n                ans += i;\n            }\n            //System.out.println(\"before ::: \"+i+\" \"+ans);\n            while(next >= 0){\n                //System.out.println(\"inside ::: \"+next+\" \"+ans);\n                int temp = next;\n                int oc = prefix[i];\n                if(next != 0)oc -= prefix[next-1];\n                int zc = (i - next +1) - oc;\n                if(oc >= zc*zc){\n                    if(flag){\n                        ans += (prev - next);\n                    }else{\n                        ans++;\n                    }\n                    next = zero[next];\n                    if(next == -1)ans += temp;\n                    flag = true;\n                }else{\n                    if(flag){\n                        if(next+1 != prev){\n                            int xoc = prefix[i];\n                            xoc -= prefix[next];\n                            int xzc = (i - next) - xoc;\n                            if(xoc >= xzc*xzc){\n                                ans += (prev - next - 1);\n                            }\n                        }\n                    }\n                    int dif = (zc*zc) - oc;\n                    next -= dif;\n                    flag = false;\n                }\n                prev = temp;\n            }\n        }\n        //System.out.println(\"===\");\n        return ans;\n    }\n}",
    "submit_ts": "1722137168",
    "subm_id": "1335756108"
}