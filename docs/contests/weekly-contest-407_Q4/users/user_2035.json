{
    "username": "eyu-g",
    "submission": "class Solution {\n    using VI = vector<int>;\n    using VVI = vector<VI>;\n    using LL = long long;\n    using P = pair<int, int>;\n    const char B = ' ', E = '\\n';\n    VI fa, ln, rn, v;\n    int find(int a) {       // \u8def\u5f84\u538b\u7f29\n        return fa[a] == a ? a : fa[a] = find(fa[a]);\n    }\n    int link(int a, int b) {\n        a = find(a);\n        b = find(b);\n        ln[a] = min(ln[a], ln[b]);\n        rn[a] = max(rn[a], rn[b]);\n        fa[b] = a;\n        int res = abs(v[a] - v[b]);\n        v[a] = min(v[a], v[b]);\n        return res;\n    }\n    LL ck(VI & a) {\n        int l = a.size();\n        if (l == 0) {\n            return 0LL;\n        }\n        if (a[0] < 0) {\n            for (int & i : a) {\n                i = -i;\n            }\n        }\n        //for (int i : a) cout << i << B; //cout << E;\n        fa.resize(l);\n        ln.resize(l);\n        rn.resize(l);\n        v.resize(l);\n        priority_queue<P> p;\n        for (int i = 0; i < l; i++) {\n            fa[i] = i;\n            ln[i] = i - 1;\n            rn[i] = i + 1;\n            v[i] = a[i];\n            p.emplace(v[i], i);\n        }\n        LL res = 0;\n        while (!p.empty()) {\n            auto [x, t] = p.top();\n            p.pop();\n            if (find(t) != t) {\n                continue;\n            }\n            if (ln[t] == -1 && rn[t] == l) {\n                return res + x;\n            }\n            else if (ln[t] == -1) {\n                res += link(t, find(rn[t]));\n                \n            } else if (rn[t] == l) {\n                res += link(t, find(ln[t]));\n            } else {\n                int i = v[find(ln[t])] > v[find(rn[t])] ? find(ln[t]): find(rn[t]);\n                res += link(t, i);\n            }\n            p.emplace(v[t], find(t));\n        }\n        // cout << 'h';\n        return res + v[find(0)];\n    }\npublic:\n    long long minimumOperations(vector<int>& nums, vector<int>& target) {\n        int l = nums.size();\n        // VVI g(1, VI(1));\n        VVI g(1);\n        // g[0][0] = nums[0] - target[0];\n        LL f;\n        for (int i = 0; i < l; i++) {\n            f = nums[i] - target[i];\n            if (f == 0) {\n                if (!g.back().empty()) {\n                    g.push_back(VI());\n                }\n            } else {\n                if (g.back().empty() || g.back().back() * f > 0LL) {\n                    g.back().push_back(int(f));\n                } else {\n                    g.push_back(VI(1, int(f)));\n                }\n            }\n        }\n        long long res = 0, tmp;\n        for (auto & a : g) {\n            tmp = ck(a);\n            res += tmp;\n            //cout << \"   t: \" << tmp << E;\n        }      \n        //cout << endl;\n        return res;\n    }\n};",
    "submit_ts": "1721533602",
    "subm_id": "548400061"
}