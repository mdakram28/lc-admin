{
    "username": "mastoori1234",
    "submission": "typedef long long int ll;\n\nclass Solution {\npublic:\n    vector<long long> countKConstraintSubstrings(string s, int k, vector<vector<int>>& queries) {\n        \n        ll n = s.length();\n        \n        vector<long long> res;\n        \n        vector<ll> rep(n, n-1);\n        \n        vector<ll> csum(n, n-1);\n        \n        vector<ll> c0(n, 0);\n        \n        vector<ll> c1(n, 0);\n        \n        auto getSum = [&]( ll si, ll ei, vector<ll> & c)->ll {\n            if(si>ei) {\n                return 0;\n            }\n            return c[si] - ((ei+1>=n)?0:c[ei+1]);\n        };\n        \n        for( ll i=n-1, t0=0, t1=0; i>=0; i--) {\n            t0 += (s[i]=='0');\n            t1 += (s[i]=='1');\n            c0[i] = t0;\n            c1[i] = t1;\n        }\n        \n        for( ll i=n-2; i>=0; i--) {\n            rep[i] = rep[i+1];\n            while(min( getSum( i, rep[i], c0), getSum( i, rep[i], c1))>k) {\n                rep[i] -= 1;\n            }\n            csum[i] = rep[i] + csum[i+1];\n        }\n        \n//         for( ll i=0; i<n; i++) {\n//             cout << \" i: \" << i << \" rep: \" << rep[i] << endl;\n//         }\n        \n        for( auto & query: queries) {\n            ll li = query[0];\n            ll ri = query[1];\n            ll sv = li;\n            ll ev = ri;\n            ll ans = ev;\n            while(sv<=ev) {\n                ll mv = (sv+ev)/2;\n                if(rep[mv]>=ri) {\n                    ans = min( ans, mv);\n                    ev = mv - 1;\n                } else {\n                    sv = mv + 1;\n                }\n            }\n            ll sp;\n            ll ep;\n            ll c;\n            sp = ans;\n            ep = ri;\n            c = ep-sp+1;\n            ll num = c*(ep+1) - (c)*(sp+ep)/2;\n            // cout << \" sp: \" << sp << \" ep: \" << ep << \" c: \" << c << \" num: \" << num << endl;\n            sp = li;\n            ep = ans-1;\n            if(sp<=ep) {\n                c = ep-sp+1;\n                ll temp = getSum( sp, ep, csum) + c - (c)*(sp+ep)/2;\n                num += temp;\n            }\n            res.push_back(num);\n        }\n        \n        return res;\n    }\n};",
    "submit_ts": "1723949856",
    "subm_id": "1359730729"
}