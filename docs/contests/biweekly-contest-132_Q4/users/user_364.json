{
    "username": "AndrewB330",
    "submission": "class Solution {\npublic:\n    int maximumLength(vector<int>& nums, int k) {\n        int n = nums.size();\n        vector<vector<int>> dp(n, vector<int>(k+1, -1000000));\n        \n        for (int i = 0; i < n; i++) dp[i][0] = 1;\n        \n        vector<map<int, int>> prev(k+1);\n        vector<multiset<int>> prevall(k+1);\n        \n        for (int i = 0; i < n; i++) {\n            prev[0][nums[i]] = (nums[0] == nums[i] ? 1 : 0);\n        }\n        for (auto a : prev[0]) {\n            prevall[0].insert(-a.second);\n        }\n        \n        for (int i = 1; i < n; i++) {\n            for (int j = k; j >= 0; j--) {\n                if (j == 0) dp[i][j] = 1;\n                if (prev[j].find(nums[i]) != prev[j].end())\n                    dp[i][j] = prev[j][nums[i]] + 1;\n                if (j && !prevall[j-1].empty()) {\n                    auto it = prevall[j-1].begin();\n                    if (prev[j-1].find(nums[i]) != prev[j-1].end() && prev[j-1][nums[i]] == *it) {\n                        it++;\n                    }\n                    if (it != prevall[j-1].end()) {\n                        dp[i][j] = max(dp[i][j], -(*it)+1);\n                        //cout << \"xxx\" << (*it)+1 << endl;\n                    }\n                }\n                if (prev[j].find(nums[i]) != prev[j].end()) {\n                    if (prevall[j].find(-prev[j][nums[i]]) == prevall[j].end()) {\n                        //cout << i << \" \" << j << \" \" << nums[i] << \" \" << prev[j][nums[i]] << endl;\n                    } else {\n                        prevall[j].erase(prevall[j].find(-prev[j][nums[i]]));\n                    }\n                }\n                prev[j][nums[i]] = max(dp[i][j], prev[j][nums[i]]);\n                prevall[j].insert(-prev[j][nums[i]]);\n            }\n        }\n        int res = 0;\n        for (int i = 0; i < n; i++)\n            for (int j = 0; j <= k; j++) res = max(res, dp[i][j]);\n        return res;\n    }\n};",
    "submit_ts": 1717861022.0
}