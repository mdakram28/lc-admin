{
    "username": "drulza-a",
    "submission": "class Solution {\npublic:\n    long long countSubarrays(vector<int>& nums, int k) {\n        vector<int>ok;\n        int index = 0;\n        for (auto i : nums)\n        {\n            if ((i & k) == k)\n                ok.push_back(index);\n            index++;\n        }\n        int last_val = -1;\n        int last_kernel = 0;\n        int len = 0;\n        long long res = 0;\n        vector<pair<int, int>>seg;\n        for (auto i : ok)\n        {\n            if (i == last_val + 1)\n            {\n                ++len;\n            }\n            else\n            {\n                if(len)\n                    seg.push_back({ last_kernel,len });\n                len = 1;\n                last_kernel = i;\n            }\n            last_val = i;\n        }\n        if (len)\n            seg.push_back({ last_kernel,len });\n        for (auto i : seg)\n        {\n            if (i.second == 1 && nums[i.first] == k)\n                res++;\n            else\n            {\n                int n = i.second;\n                int start = i.first;\n                int a = i.first;\n                int b = i.first;\n                int now_val = nums[a];\n                while (1)//\u6ed1\u52a8\u7a97\u53e3\n                {\n                    while (now_val != k)\n                    {\n                        ++b;\n                        if (b >= start + n)\n                            break;\n                        now_val &= nums[b];\n                    }\n                    if (b == start + n)\n                        break;\n                    res += (start + n) - b;\n                    if (b == a)++b;\n                    if (b == start + n)\n                        break;\n                    ++a;\n                    if(nums[a]!=nums[a-1])\n                    {\n                        now_val = nums[a];\n                        for (int j = a + 1; j <= b; ++j)\n                        {\n                            now_val &= nums[j];\n                        }\n                    }\n                }\n            }\n        }\n        return res;\n    }\n};",
    "submit_ts": "1720281273",
    "subm_id": "544575151"
}