{
    "username": "zhou-zhou-36",
    "submission": "class Solution {\npublic:\n    vector<int> need0,need1;\n    vector<vector<int>> m0,m1;\n    bool AllNeed1(int a)\n    {\n        for(int b:need1)\n        {\n            if((a&(1<<b))==0) return false;\n        }\n        return true;\n    }\n    long long Calc0(vector<int> &a,int le,int ri)\n    {\n        long long ans=0;\n        for(int i=le;i<=ri;++i)\n        {\n            int le0=i+1;\n            for(int b:need0)\n            {\n                auto it=upper_bound(m0[b].begin(),m0[b].end(),i);\n                le0=min(le0,*prev(it));\n            }\n            if(le<=le0 && le0<=i) ans+=le0-le+1;\n        }\n        return ans;\n    }\n    long long countSubarrays(vector<int>& nums, int k) {\n        int n=nums.size();\n        for(int i=0;i<30;++i)\n        {\n            if(k&(1<<i)) need1.push_back(i);\n            else need0.push_back(i);\n        }\n        m0.assign(30,vector<int>(1,-1));\n        m1.assign(30,vector<int>(1,-1));\n        for(int i=0;i<n;++i)\n        {\n            for(int j=0;j<30;++j)\n            {\n                ((nums[i]&(1<<j))==0 ? m0 : m1)[j].push_back(i);\n            }\n        }\n        long long ans=0;\n        for(int i=0;i<n;)\n        {\n            if(!AllNeed1(nums[i]))\n            {\n                i+=1;\n                continue;\n            }\n            int j=i+1;\n            for(;j<n && AllNeed1(nums[j]);++j);\n            ans+=Calc0(nums,i,j-1);\n            i=j;\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1720281254",
    "subm_id": "544575070"
}