{
    "username": "minohcity",
    "submission": "using ii = pair<int, int>;\n\nclass Solution {\npublic:\n    int minChanges(vector<int>& nums, int k) {\n        int n = int(nums.size());\n\n        map<int, vector<ii>> diffToNumPairs;\n        for (int i = 0, j = n - 1; i < j; ++i, --j) {\n            if (nums[i] > nums[j]) swap(nums[i], nums[j]);\n            int diff = nums[j] - nums[i];\n            diffToNumPairs[diff].push_back(ii(nums[i], nums[j]));\n        }\n        // to change to some bigger X, for diff < X we may need to change 1 of the num in a pair or both nums\n        // if pair is (l, r), then we can\n        // change 1 num if new X is max((r - 0) or (k - l))\n        // change both nums if new X is larger than that\n        int answer = n;\n        int countBiggerPairs = n / 2;\n        int countSmallerOneChanges = 0;\n        int countSmallerTwoChanges = 0;\n        map<int, int> oneChanges, twoChanges;\n        for (auto& [diff, numPairs] : diffToNumPairs) {\n            while (!oneChanges.empty() && oneChanges.begin()->first < diff) {\n                auto [k, v] = *oneChanges.begin();\n                twoChanges[k] += v;\n                countSmallerTwoChanges += v;\n                countSmallerOneChanges -= v;\n                oneChanges.erase(k);\n            }\n\n            countBiggerPairs -= int(numPairs.size());\n\n            // cout << \"diff: \" << diff << endl;\n            // cout << countSmallerOneChanges << \" \" << countSmallerTwoChanges << \" \" << countBiggerPairs << endl;\n            int currentCount = countSmallerOneChanges + 2 * countSmallerTwoChanges + countBiggerPairs;\n\n            answer = min(answer, currentCount);\n\n            for (auto& [lo, hi] : numPairs) {\n                int val = max(hi, k - lo);\n                // 1 operation, more than this, we'll need 2 changes\n                if (val <= diff) {\n                    ++twoChanges[val];\n                    ++countSmallerTwoChanges;\n                } else {\n                    ++oneChanges[val];\n                    ++countSmallerOneChanges;\n                }\n            }\n        }\n        return answer;\n    }\n};",
    "submit_ts": "1721489924",
    "subm_id": "1327467845"
}