{
    "username": "Ayush Sharma",
    "submission": "#include <bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define ld long double\n#define all(x) (x).begin(), (x).end()\n#define INF 2e18\n#define vi  vector<int>\n#define vb  vector<bool>\n#define vc  vector<char>\n#define vvi vector<vector<int>>\n#define vvc vector<vector<char>> \n#define vvb vector<vector<bool>> \n#define vpi vector<pair<int,int>>\n#define ff first\n#define ss second\n#define pb push_back\n#define ppb pop_back\n#define pqb priority_queue<int>\n#define pqs priority_queue<int,vi,greater<int> >\n#define setbits(x) __builtin_popcountll(x)\n#define MOD 1e9+7\n\nclass Solution {\npublic:\n    long long maximumValueSum(vector<vector<int>>& arr) {\n        int m=arr.size();\n        int n=arr[0].size();\n        // pmax,smax\n        long long ans=-1e18;\n        vector<vector<int>> pref(m, vector<int>(n));\n        vector<vector<int>> suff(m, vector<int>(n));\n\n        for (int i = 0; i < m; i++) {\n            pref[i][0] = arr[i][0];\n            for (int j = 1; j < n; j++) {\n                pref[i][j] = max(pref[i][j-1], arr[i][j]);\n            }\n        }\n\n        for (int i = 0; i < m; i++) {\n            suff[i][n-1] = arr[i][n-1];\n            for (int j = n-2; j >= 0; j--) {\n                suff[i][j] = max(suff[i][j+1], arr[i][j]);\n            }\n        }\n\n        for(int c=1;c<=n-2;c++){\n            multiset<pair<int,int>,greater<pair<int,int>>> q1,q2,q3,q4;\n\n            // q1.insert({pref[0][c-1],0});\n            // q2.insert({suff[0][c+1],0});\n\n            // current is 1st row\n            for(int r=1;r<m;r++){\n                q3.insert({pref[r][c-1],r});\n                q4.insert({suff[r][c+1],r});\n            }\n\n\n            for(int r=0;r<m;r++){\n                // q1,q2,q3,q4 -> r is not there\n                // q1 q2\n                if(q1.size()>1 && q2.size()>1){\n                    auto itr1=q1.begin();\n                    pair<int,int> mq1=*itr1;\n                    itr1++;\n                    pair<int,int> mq2=*itr1;\n\n                    auto itr2=q2.begin();\n                    pair<int,int> mq3=*itr2;\n                    itr2++;\n                    pair<int,int> mq4=*itr2;\n\n                    if(mq1.ss==mq3.ss){\n                        ans=max(ans,(ll)arr[r][c] + 0ll + mq1.ff + mq4.ff);\n                        ans=max(ans,(ll)arr[r][c] + 0ll + mq3.ff + mq2.ff);\n                    }else{\n                        ans=max(ans,(ll)arr[r][c] + 0ll + mq1.ff + mq3.ff);\n                    }\n                }\n\n                // q3 q4\n                if(q3.size()>1 && q4.size()>1){\n                    auto itr1=q3.begin();\n                    pair<int,int> mq1=*itr1;\n                    itr1++;\n                    pair<int,int> mq2=*itr1;\n\n                    auto itr2=q4.begin();\n                    pair<int,int> mq3=*itr2;\n                    itr2++;\n                    pair<int,int> mq4=*itr2;\n\n                    if(mq1.ss==mq3.ss){\n                        ans=max(ans,(ll)arr[r][c] + 0ll +  mq1.ff + mq4.ff);\n                        ans=max(ans,(ll)arr[r][c] + 0ll + mq3.ff + mq2.ff);\n                    }else{\n                        ans=max(ans,(ll)arr[r][c] + 0ll + mq1.ff + mq3.ff);\n                    }\n                }\n\n                // q1 q4\n                if(q1.size() && q4.size()){\n                    ans=max(ans,(ll)arr[r][c] + 0ll + (*q1.begin()).ff + (*q4.begin()).ff);\n                }\n                // q2 q3\n                if(q2.size() && q3.size()){\n                    ans=max(ans,(ll)arr[r][c] + 0ll + (*q2.begin()).ff + (*q3.begin()).ff);\n                }\n\n                // Before going to next row\n                q1.insert({pref[r][c-1],r});\n                q2.insert({suff[r][c+1],r});\n                if(r+1<m){\n                    q3.erase({pref[r+1][c-1],r+1});\n                    q4.erase({suff[r+1][c+1],r+1});                    \n                }\n\n\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1723908909",
    "subm_id": "1359172021"
}