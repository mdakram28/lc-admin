{
    "username": "rush-9e",
    "submission": "class Solution {\npublic:\n    long long countSubarrays(vector<int>& nums, int k) {\n        int n = nums.size();\n\n        // \u663e\u7136\uff0c\u5b50\u6570\u7ec4\u8d8a\u5927\uff0c\u8d8a\u53ef\u80fd < k\n        // \u679a\u4e3e\u53f3\u7aef\u70b9\uff0c\u540c\u65f6\u79fb\u52a8\u5de6\u7aef\u70b9 l1, l2\n        // \u7b2c\u4e00\u4e2a l1 \u662f\u8d8a\u5de6\u8fb9\u8d8a\u597d\uff0c\u6240\u4ee5\u79fb\u52a8 r \u540e\uff0c\u79fb\u52a8 l1 \u4f7f\u5f97 l1 >= k \u7684\u7b2c\u4e00\u4e2a\u70b9\u505c\u4e0b\n        // \u7b2c\u4e8c\u4e2a l2 \u662f\u8d8a\u53f3\u8fb9\u8d8a\u597d\uff0c\u6240\u4ee5\u79fb\u52a8 r \u540e\uff0c\u79fb\u52a8 l2 \u4f7f\u5f97 l2 >= k \u7684\u6700\u540e\u4e00\u4e2a\u70b9\u505c\u4e0b\n\n        vector<vector<int>> pre(n + 1, vector<int>(30, 0));\n        for (int i = 0; i < n; ++i) {\n            for (int j = 0; j < 30; ++j) {\n                pre[i + 1][j] = pre[i][j] + (nums[i] >> j & 1);\n            }\n        }\n\n        auto getv = [&](int l, int r) {\n            int val = 0;\n            for (int j = 0; j < 30; ++j) {\n                if (pre[r + 1][j] - pre[l][j] == r - l + 1) {\n                    val |= 1 << j;\n                }\n            }\n            return val;\n        };\n\n        long long ans = 0;\n        int v;\n        for (int r = 0, l1 = 0, l2 = 0; r < n; ++r) {\n            while (l1 <= r && (v = getv(l1, r)) < k) l1 += 1;\n            if (v > k) continue;\n            l2 = max(l2, l1);\n            while (l2 <= r && getv(l2, r) == k) l2 += 1;\n            if (l1 <= r) ans += l2 - l1;\n        }\n        return ans;\n    }\n};\n",
    "submit_ts": "1720279297",
    "subm_id": "544566851"
}