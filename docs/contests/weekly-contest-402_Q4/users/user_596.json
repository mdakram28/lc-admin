{
    "username": "nice-joliot0bl",
    "submission": "const int N = 1e5 + 10;\n\nint tr[N];\nbool st[N];\nint lowbit(int x){ return x & -x; }\nvoid add(int x, int v){\n    for(int i = x;i < N;i += lowbit(i)) tr[i] += v;\n}\nint query(int x){\n    int res = 0;\n    for(int i = x;i;i -= lowbit(i)) res += tr[i];\n    return res;\n}\nint query(int l, int r){\n    if(l == r) return 0;\n    if(l == r - 1) return 0;\n    return query(r - 1) - query(l);\n}\nclass Solution {\npublic:\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n        int n = nums.size();\n        memset(tr, 0, sizeof tr);\n        memset(st, false, sizeof st);\n        for(int i = 0;i < n; ++ i){\n            if(i == 0 || i == n - 1) continue;\n            else{\n                if(nums[i] > nums[i - 1] && nums[i] > nums[i + 1]) add(i, 1), st[i] = true;\n            }\n        }\n        \n        vector<int> res; res.clear();\n        int m = queries.size();\n        for(int i = 0;i < m; ++ i){\n            int op = queries[i][0];\n            if(op == 1) res.push_back(query(queries[i][1], queries[i][2]));\n            else{\n                \n                int idx = queries[i][1], val = queries[i][2];\n                \n                int now = idx;\n                if(now > 0 && now < n - 1){\n                    if(nums[idx] > nums[idx - 1] && nums[idx] > nums[idx + 1]) add(idx, -1);\n                    if(val > nums[idx - 1] && val > nums[idx + 1]) add(idx, 1);\n                }\n                \n                now = idx - 1;\n                if(now > 0 && now < n - 1){\n                    if(nums[now] > nums[now - 1] && nums[now] > nums[now + 1]) add(now, -1);\n                    if(nums[now] > nums[now - 1] && nums[now] > val) add(now, 1);\n                }\n\n                now = idx + 1;\n                if(now > 0 && now < n - 1){\n                    if(nums[now] > nums[now - 1] && nums[now] > nums[now + 1]) add(now, -1);\n                    if(nums[now] > val && nums[now] > nums[now + 1]) add(now, 1);\n                }\n                nums[idx] = val;\n            }\n        }\n        return res;\n    }\n};",
    "submit_ts": 1718507410.0
}