{
    "username": "ye_che",
    "submission": "class Solution {\npublic:\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& q) {\n        int n = nums.size();\n        vector<int> tr(n + 2, 0);\n        function<void(int, int)> add=[&](int x, int v){\n            while (x<=n)tr[x]+=v,x+=(x&-x);\n        };\n        function<int(int)> qr = [&](int x) {\n            int res = 0;\n            while (x) res += tr[x], x -= (x & -x);\n            return res;\n        };\n        function<bool(int)> isf = [&](int x) {\n            if (x >= n || x <= 1) return false;\n            return nums[x-1] > nums[x] && nums[x-1] > nums[x-2];\n        };\n        for (int i = 1; i < n-1; i ++) {\n            add(i+1, nums[i]>nums[i-1] && nums[i]>nums[i+1]);\n        }\n        vector<int> res;\n        for (auto & x : q) {\n            if (x[0] == 1) {\n                if (x[2] - x[1] + 1 <= 2) res.push_back(0);\n                else res.push_back(qr(x[2]) - qr(x[1]+1));\n            }\n            else {\n                x[1] ++;\n                if (isf(x[1]-1)) add(x[1]-1, -1);\n                if (isf(x[1])) add(x[1], -1);\n                if (isf(x[1]+1)) add(x[1]+1, -1);\n                // if (isf(x[1]-1)) {\n                //     if (x[2] >= nums[x[1]-2]) add(x[1]-1, -1);\n                // }\n                // if (isf(x[1]+1)) {\n                //     if (x[2] >= nums[x[1]]) add(x[1]+1, -1);\n                // }\n                // cout << x[1] << ' ' << isf(x[1]) << endl;\n                // if (isf(x[1])) add(x[1], -1);\n                nums[x[1]-1] = x[2];\n                if (isf(x[1]+1)) add(x[1]+1, 1);\n                if (isf(x[1])) add(x[1], 1);\n                if (isf(x[1]-1)) add(x[1]-1, 1);\n                // cout << x[1] << ' ' << isf(x[1]) << endl;\n            }\n            // for (int i = 0; i < n; i ++) cout << nums[i] << ' ';cout << endl;;\n            // for (int i = 2; i <= n-1; i ++) cout << isf(i) << ' ';\n            // cout << endl;\n            // for (int i = 2; i <= n-1; i ++) cout << qr(i)-qr(i-1) << ' ';\n            // cout << endl;\n        }\n        // cout << endl;\n        return res;\n    }\n};",
    "submit_ts": 1718507317.0
}