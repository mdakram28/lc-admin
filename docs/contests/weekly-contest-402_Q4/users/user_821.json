{
    "username": "you-jin-plus",
    "submission": "class Solution {\npublic:\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n        int n = nums.size();\n        vector<int> tr(n + 1);\n        auto add = [&](int x, int v) {\n            for (int i = x; i <= n; i += i & -i) tr[i] += v;\n        };\n        auto ask = [&](int x) {\n            int res = 0;\n            for (int i = x; i > 0; i -= i & -i) res += tr[i];\n            return res;\n        };\n        for (int i = 0; i < n; i++) {\n            if (i == 0 || i == n - 1) continue;\n            if (nums[i] > nums[i - 1] && nums[i] > nums[i + 1]) {\n                add(i + 1, 1);\n            }\n        }\n        vector<int> ans;\n        for (auto &q : queries) {\n            if (q[0] == 1) {\n                int cur = ask(q[2]) - ask(q[1] + 1);\n                ans.push_back(max(0, cur));\n            } else {\n                int idx = q[1], val = q[2];\n                if (idx > 0 && idx < n - 1) {\n                    if (nums[idx] > nums[idx - 1] && nums[idx] > nums[idx + 1]) {\n                        if (val <= nums[idx - 1] || val <= nums[idx + 1]) {\n                            add(idx + 1, -1);\n                        }\n                    } else if (val > nums[idx - 1] && val > nums[idx + 1]) {\n                        add(idx + 1, 1);\n                    }\n                }\n                if (idx - 1 > 0) {\n                    if (nums[idx - 1] > nums[idx - 2]) {\n                        if (nums[idx - 1] <= nums[idx] && nums[idx - 1] > val) {\n                            add(idx, 1);\n                        }\n                        if (nums[idx - 1] > nums[idx] && nums[idx - 1] <= val) {\n                            add(idx, -1);\n                        }\n                    }\n                }\n                if (idx + 1 < n - 1) {\n                    if (nums[idx + 1] > nums[idx + 2]) {\n                        if (nums[idx + 1] <= nums[idx] && nums[idx + 1] > val) {\n                            add(idx + 2, 1);\n                        }\n                        if (nums[idx + 1] > nums[idx] && nums[idx + 1] <= val) {\n                            add(idx + 2, -1);\n                        }\n                    }\n                }\n                nums[idx] = val;\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": 1718507951.0
}