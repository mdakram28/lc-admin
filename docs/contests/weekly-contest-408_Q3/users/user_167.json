{
    "username": "user3744L",
    "submission": "class Solution {\npublic:\n    int numberOfSubstrings(string s) {\n        int n = s.size();\n        vector<vector<int>> pref(n, vector<int> (2, 0));\n        for(int i = 0; i < s.size(); i++){\n            pref[i][0] = (i ? pref[i - 1][0] : 0);\n            pref[i][1] = (i ? pref[i - 1][1] : 0);\n            if(s[i] == '0')\n                pref[i][0]++;\n            else \n                pref[i][1]++;\n        }\n        int ans = 0;\n        for(int i = 0; i < s.size(); i++){\n            int l = i;\n            int curr = 0;\n            while(l >= 0){\n                int cnt0 = pref[i][0] - (l ? pref[l - 1][0] : 0);\n                int cnt1 = pref[i][1] - (l ? pref[l - 1][1] : 0);\n                int req = cnt0 * cnt0;\n\n                if(cnt1 >= req){\n                    int cl = 0, cr = l;\n                    int best = -1;\n                    while(cl <= cr){\n                        int mid = (cl + cr) / 2;\n                        int sub_cnt0 = pref[i][0] - (mid ? pref[mid - 1][0] : 0);\n                        if(cnt1 >= sub_cnt0 * sub_cnt0){\n                            cnt1 = pref[i][1] - (mid ? pref[mid - 1][1] : 0);\n                            best = mid;\n                            cr = mid - 1;\n                        } \n                        else {\n                            cl = mid + 1;\n                        }\n                    }\n                    if (best != -1) {\n                        curr += l - best + 1;\n                    }\n                    l = best - 1;\n                }\n                else {\n                    int cl = 0, cr = l;\n                    int best = -1;\n                    while(cl <= cr){\n                        int mid = (cl + cr) / 2;\n                        int sub_cnt1 = pref[i][1] - (mid ? pref[mid - 1][1] : 0);\n                        if(cnt0 * cnt0 > sub_cnt1){\n                            cnt0 = pref[i][0] - (mid ? pref[mid - 1][0] : 0);\n                            best = mid;\n                            cr = mid - 1;\n                        } else {\n                            cl = mid + 1;\n                        }\n                    }\n                    l = best - 1;\n                }\n            }\n            ans += curr;\n        }\n        return ans;   \n    }\n};",
    "submit_ts": "1722137009",
    "subm_id": "1335751487"
}