{
    "username": "Equinox",
    "submission": "auto init = []{\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr);\n    return 0;\n};\nconstexpr int inf32 = 1'000'000'007;\n\nclass Solution {\npublic:\n    long long maximumValueSum(vector<vector<int>>& board) {\n    #define int long long\n        int m = board.size();\n        int n = board[0].size();\n\n        vector<vector<int>> f(n + 1, vector<int>(n + 1, LLONG_MIN / 2));\n        f[0][0] = 0;\n\n        int res = LLONG_MIN / 2;\n\n        for (int i = 0; i < m; ++i) {\n            vector<vector<int>> nf(n + 1, vector<int>(n + 1, LLONG_MIN / 2));\n            int fii = -1, sei = -1, thi = -1;\n            int fi = -inf32, se = -inf32, th = -inf32;\n            for (int j = 0; j < n; ++ j)\n                if (board[i][j] > fi) {\n                    th = se, se = fi, fi = board[i][j];\n                    thi = sei, sei = fii, fii = j;\n                }\n                else if(board[i][j] > se) {\n                    th = se, se = board[i][j];\n                    thi = sei, sei = j;\n                }\n                else if(board[i][j] > th)\n                    th = board[i][j], thi = j;\n\n            for (int k = 0; k <= n; ++k) {\n                for (int x = 0; x <= n; ++x) {\n                    if (k == 0 || k != x) {\n                        nf[k][x] = max({nf[k][x], f[k][x], f[0][k] + (x ? board[i][x - 1] : 0)});\n                        // if (j && k && x) {\n                        //     res = max(res, f[j][k] + board[i][x - 1]);\n                        // }\n                    }\n                    if (k && x) {\n                        int t = fii;\n                        if (t == k - 1 || t == x - 1) t = sei;\n                        if (t == k - 1 || t == x - 1) t = thi;\n                        if (t == -1) continue;\n                        res = max(res, f[k][x] + board[i][t]);\n                    }\n                }\n            }\n            \n            f = std::move(nf);\n        }\n\n        return res;\n    }\n};\n#undef int",
    "submit_ts": "1723907951",
    "subm_id": "556328397"
}