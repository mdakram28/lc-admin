{
    "username": "newhar",
    "submission": "class Solution {\npublic:\n    long long minimumOperations(vector<int>& nums, vector<int>& target) {\n        nums.push_back(0);\n        target.push_back(0);\n        int n = nums.size(), fa[n], has[n];\n        int cnt = 0;\n        function<int(int)> find = [&](int x) -> int {\n            if(fa[x] == -1) return x;\n            return fa[x] = find(fa[x]);\n        };\n        auto merge = [&](int x, int y) {\n            x = find(x), y = find(y);\n            if(x != y) {\n                cnt--;\n                fa[x] = y;\n            }\n        };\n        auto calc = [&](bool up) -> long long {\n            long long res = 0;\n            vector<pair<int,int>> v;\n            for(int i = 0; i < nums.size(); ++i) {\n                if(up) {\n                    if(nums[i] - target[i] > 0) {\n                        v.push_back({nums[i] - target[i], i});\n                    }\n                } else {\n                    if(nums[i] - target[i] < 0) {\n                        v.push_back({target[i] - nums[i], i});\n                    }\n                }\n            }\n            sort(v.begin(), v.end(), greater<pair<int,int>>());\n            memset(fa, -1, sizeof(fa));\n            memset(has, 0, sizeof(has));\n            cnt = 0;\n            for(int i = 0; i < v.size();) {\n                int j = i;\n                while(j < v.size() && v[j].first == v[i].first) {\n                    cnt++;\n                    has[v[j].second] = 1;\n                    if(v[j].second && has[v[j].second - 1]) merge(v[j].second, v[j].second - 1);\n                    if(v[j].second + 1 < n && has[v[j].second + 1]) merge(v[j].second, v[j].second + 1);\n                    j++;\n                }\n                int nxt = 0;\n                if(j < v.size()) nxt = v[j].first;\n                res += 1ll * cnt * (v[i].first - nxt);\n                i = j;\n            }\n            return res;\n        };\n        return calc(true) + calc(false);\n    }\n};",
    "submit_ts": "1721532248",
    "subm_id": "548391235"
}