{
    "username": "yaoking",
    "submission": "class Solution {\npublic:\n    typedef long long ll;\n    ll n,a[100005],sum[100005][31];\n    vector<ll>v[31];\n    bool check(ll l,ll r,ll k){\n        for(int i=0;i<31;i++){\n            if(k&(1<<i)){\n                if(sum[r][i]-sum[l-1][i]!=r-l+1)return false;\n            }\n            \n        }\n        return true;\n    }\n    long long countSubarrays(vector<int>& nums, int k) {\n         n=nums.size();\n        for(int i=1;i<=n;i++)a[i]=nums[i-1];\n        for(int i=1;i<=n;i++){\n            for(int j=0;j<31;j++){\n                if(a[i]&(1<<j))sum[i][j]=sum[i-1][j]+1;\n                else{\n                    sum[i][j]=sum[i-1][j];\n                    v[j].push_back(i);\n                }\n            }\n        }\n        ll res=0;\n        for(int i=1;i<=n;i++){\n            ll l=i,r=n,ans=-1;\n            while(l<=r){\n                ll mid=(l+r)/2;\n                if(check(i,mid,k)){\n                    l=mid+1;\n                    ans=mid;\n                    \n                }\n                else{\n                    r=mid-1;\n                }\n            }\n           \n            if(ans!=-1){\n                ll ma=0;\n                for(int j=0;j<31;j++){\n                    if(!(k&(1<<j))){\n                        ll l=0,r=v[j].size()-1,cnt=-1;\n                        while(l<=r){\n                            ll mid=(l+r)/2;\n                            if(v[j][mid]>=i){\n                                r=mid-1;\n                                cnt=mid;\n                            }\n                            else{\n                                l=mid+1;\n                            }\n                        }\n                        \n                        if(cnt!=-1)\n                        ma=max(ma,v[j][cnt]);\n                        else{\n                            ma=0;\n                            break;\n                        }\n                    }\n                    \n                }\n              \n                if(ma!=0&&ma<=ans)\n                res+=1ll*(ans-ma+1);\n            }\n        }\n        return res;\n    }\n};\n\n// [2,1,2,4,0]\n// 0",
    "submit_ts": "1720278824",
    "subm_id": "544564553"
}