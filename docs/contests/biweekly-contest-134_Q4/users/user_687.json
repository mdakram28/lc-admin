{
    "username": "Sayan_244",
    "submission": "// #include <bits/stdc++.h>\n// #define fastio() \\\n// ios_base::sync_with_stdio(0); \\\n// cin.tie(0); \\\n// cout.tie(0)\n#define ll long long\n#define pb push_back\n#define endl \"\\n\"\n#define siz(a) int((a).size())\n#define pii pair <int, int>\n//using namespace std;\n\nclass Solution {\npublic:\n    long long countSubarrays(vector<int>& nums, int k) {\n      int n = siz(nums);\n      vector <vector <ll>> pre(31, vector <ll> (n + 1));\n      for(int i = 0; i < n; i++) {\n        for(int j = 0; j < 31; j++) {\n          pre[j][i + 1] = pre[j][i];\n          if ((nums[i] >> j) & 1ll) {\n            pre[j][i + 1] += 1;\n          }\n        }\n      }\n\n      //cout<<pre[2][n] - pre[2][3]<<endl;\n      ll ans = 0;\n      for(ll i = 0; i < n; i++) {\n        ll tl = i + 1, tr = n;\n        if (nums[i] < k) {\n          continue;\n        }\n        while (tl < tr) {\n          ll mid = (tl + tr + 1) / 2;\n          ll msk = 0;\n          for(ll j = 0; j < 31; j++) {\n            if (pre[j][mid] - pre[j][i] == mid - (i + 1) + 1) {\n              msk |= (1ll << j);\n            }\n          }\n          // if (i + 1 == 4) {\n          //   cout<<mid<<\" \"<<msk<<endl;\n          // }\n          if (msk >= k) {\n            tl = mid;\n          } else {\n            tr = mid - 1;\n          }\n        }\n\n        ll dl = i, dr = n;\n        while (dl < dr) {\n          ll mid = (dl + dr + 1) / 2;\n          ll msk = 0;\n          for(ll j = 0; j < 31; j++) {\n            if (pre[j][mid] - pre[j][i] == mid - (i + 1) + 1) {\n              msk |= (1ll << j);\n            }\n          }\n          // if (i + 1 == 4) {\n          //   cout<<mid<<\" \"<<msk<<endl;\n          // }\n          if (msk > k) {\n            dl = mid;\n          } else {\n            dr = mid - 1;\n          }\n        }\n\n        ans += max(0ll, tl - dl);\n\n        // if (dl < n) {\n        //   ans += max(0ll,tl - dl);\n        // } else {\n        //   ll msk = 0;\n        //   for(ll j = 0; j < 31; j++) {\n        //     if (pre[j][n] - pre[j][i] == n - (i + 1) + 1) {\n        //       msk |= (1ll << j);\n        //     }\n        //   }\n        //   if (msk == k) {\n        //     ans += max(0ll, dl - tl + 1);\n        //   } else {\n        //     ans += max(0ll,dl - tl);\n        //   }\n        // }\n        //cout<<i<<\" \"<<tl<<\" \"<<dl<<endl;\n      }\n\n      return ans;\n    }\n};",
    "submit_ts": "1720279736",
    "subm_id": "1311763095"
}