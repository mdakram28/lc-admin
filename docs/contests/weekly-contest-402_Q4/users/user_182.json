{
    "username": "Ivan_len",
    "submission": "template<class F>\nstruct segtree{\n    // modify: merge, modify, base case\n    int cnt;  // array size\n    vector<F> t;\n\n    segtree() {}\n    void resize(int n) {\n        cnt = n;\n        t.resize(2 * n);\n    }\n    \n    inline F merge(F a, F b) {\n        return a + b;\n    }\n    \n    void build() {  // build the tree\n        for (int i = cnt - 1; i > 0; --i) {\n            t[i] = merge(t[i<<1], t[i<<1|1]);\n        }\n    }\n    \n    void modify(int p, F value) {  // set value at position p\n        p += cnt;\n        t[p] = value;\n        for (p; p > 1; p >>= 1) t[p>>1] = merge(t[p], t[p^1]);\n    }\n    \n    F query(int l, int r) {  // sum on interval [l, r)\n        F resl = 0, resr = 0;\n        for (l += cnt, r += cnt; l < r; l >>= 1, r >>= 1) {\n            if (l&1) resl = merge(resl, t[l++]);\n            if (r&1) resr = merge(t[--r], resr);\n        }\n        return merge(resl, resr);\n    }\n};\n\nclass Solution {\npublic:\n    vector<int> countOfPeaks(vector<int>& a, vector<vector<int>>& queries) {\n        int n = a.size();\n        segtree<int> T;\n        T.resize(n);\n        for (int i = 1; i < n - 1; i++) {\n            if (a[i] > a[i - 1] && a[i] > a[i + 1]) T.t[i + n] = 1;\n        }\n        T.build();\n        vector<int> ans;\n        for (auto i : queries) {\n            if (i[0] == 1) ans.push_back(T.query(i[1] + 1, i[2]));\n            else {\n                int idx = i[1], val = i[2];\n                a[idx] = val;\n                if (idx - 1 > 0) {\n                    if (a[idx - 1] > a[idx] && a[idx - 1] > a[idx - 2]) T.modify(idx - 1, 1);\n                    else T.modify(idx - 1, 0);\n                }\n                if (idx + 1 < n - 1) {\n                    if (a[idx + 1] > a[idx] && a[idx + 1] > a[idx + 2]) T.modify(idx + 1, 1);\n                    else T.modify(idx + 1, 0);\n                }\n                if (idx > 0 && idx < n - 1) {\n                    if (a[idx] > a[idx - 1] && a[idx] > a[idx + 1]) T.modify(idx, 1);\n                    else T.modify(idx, 0);\n                }\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": 1718506684.0
}