{
    "username": "lydxlx",
    "submission": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nconst int MAXN = 100010;\nint bit[MAXN];\nint N;\n\nint lsb(int index) {\n    return index & -index;\n}\n\nint query(int index) {\n    int sum = 0;\n    while (index > 0) {\n        sum += bit[index];\n        index -= lsb(index);\n    }\n    return sum;\n}\n\nvoid update(int index, int value) {\n    while (index <= N) {\n        bit[index] += value;\n        index += lsb(index);\n    }\n}\n\nclass Solution {\npublic:\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n        N = nums.size();\n        for (int i = 0; i <= N; i++) {\n            bit[i] = 0;\n        }\n        vector<bool> flags(N, false);\n        for (int i = 1; i + 1 < N; i++) {\n            if (nums[i] > nums[i - 1] && nums[i] > nums[i + 1]) {\n                flags[i] = true;\n                update(i + 1, 1);\n            }\n        }\n        vector<int> res;\n        for (int i = 0; i < queries.size(); i++) {\n            if (queries[i][0] == 1) {\n                int right = queries[i][2];\n                int left = queries[i][1];\n                int ans = query(right + 1);\n                ans -= query(left);\n                if (flags[right]) {\n                    ans--;\n                }\n                if (left != right && flags[left]) {\n                    ans--;\n                }\n                res.push_back(ans);\n            }\n            else {\n                int loc = queries[i][1];\n                int value = queries[i][2];\n                nums[loc] = value;\n                for (int j = loc - 1; j <= loc + 1; j++) {\n                    if (j <= 0 || j >= N - 1) {\n                        continue;\n                    }\n                    bool newflag = false;\n                    if (nums[j] > nums[j - 1] && nums[j] > nums[j + 1]) {\n                        newflag = true;\n                    }\n                    if (newflag != flags[j]) {\n                        if (newflag) {\n                            update(j + 1, 1);\n                        }\n                        else {\n                            update(j + 1, -1);\n                        }\n                        flags[j] = newflag;\n                    }\n                }\n            }\n        }\n        return res;\n    }\n};\n",
    "submit_ts": 1718506314.0
}