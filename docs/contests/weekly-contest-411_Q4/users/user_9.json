{
    "username": "Turkhuu Batbayar",
    "submission": "template<class S> struct BIT {\n    int n;vector<S> s;\n    BIT(int n):n(n),s(n+1){}\n    void add(int i,const S&v){for(i++;i<=n;i+=i&-i)s[i]+=v;}\n    S sum(int i){S t{};for(;i;i-=i&-i)t+=s[i];return t;}\n    S sum(int l,int r){return sum(r)-sum(l);}\n};\nclass Solution {\npublic:\n    vector<long long> countKConstraintSubstrings(string s, int k, vector<vector<int>>& queries) {\n        using ll = long long;\n        int n = s.size();\n        vector<int> a(n), c(2);\n        for (int i = 0, j = 0; i < n; i++) {\n            while (j < n && (c[s[j] - '0'] < k || c['1' - s[j]] <= k)) c[s[j++] - '0']++;\n            a[i] = j;\n            c[s[i] - '0']--;\n        }\n        vector<array<int, 2>> b(n);\n        for (int i = 0; i < n; i++) {\n            b[i] = {a[i], i};\n        }\n        sort(b.begin(), b.end());\n        BIT<ll> bit(n);\n        BIT<int> cnt(n);\n        int q = queries.size();\n        vector<ll> ans(q);\n        vector<int> l(q), r(q);\n        vector<array<int, 2>> v(q);\n        for (int i = 0; i < q; i++) {\n            l[i] = queries[i][0];\n            r[i] = queries[i][1]; r[i]++;\n            v[i] = {r[i], i};\n        }\n        sort(v.begin(), v.end());\n        int j = 0;\n        for (auto [R, i] : v) {\n            while (j < n && b[j][0] <= R) {\n                bit.add(b[j][1], b[j][0]);\n                cnt.add(b[j][1], 1);\n                j++;\n            }\n            ll s = bit.sum(l[i], r[i]);\n            int c = cnt.sum(l[i], r[i]);\n            ans[i] = s + 1LL * (r[i] - l[i] - c) * R - (1LL * r[i] * (r[i] - 1) / 2 - 1LL * l[i] * (l[i] - 1) / 2);\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1723950416",
    "subm_id": "1359745434"
}