{
    "username": "ddmike",
    "submission": "\nclass Solution {\nprivate:\n    int lowbit(int x)    // \u5229\u7528\u4e86\u795e\u5947\u7684\u4e8c\u8fdb\u5236 \u7279\u6027 \n    {\n        return x&(-x);\n    }\n    int add(int i,int x)   //  \u52a0\u6570\uff0c\u5f80\u53f3\u8d70\uff0c\u80af\u5b9a\u662f\u5de6\u5b50\u8282\u70b9\uff0c \n    {\n        for(;i<=n;)\n        {\n            d[i]+=x;\n            i=i+lowbit(i);\n        }\n        return 0;\n    }\n    int sum(int c)          // \u8ba1\u7b97\u548c\uff0c\u5f80\u5de6\u8d70 \n    {\n        int s=0;\n        while(c>0)\n        {\n            s+=d[c];\n            c=c-lowbit(c);\n        }\n        return s;\n    }\n\n    int js(const vector<int>& nums, int pos)\n    {\n        if (pos <= 0 || pos >= nums.size() - 1) return 0;\n        if (nums[pos] > nums[pos - 1] && nums[pos] > nums[pos + 1])\n        {\n            return 1;\n        }\n        return 0;\n    }\n    vector<int> d;\n    int n;\npublic:\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n        int m = nums.size();\n        n = m + 1;\n        d.clear();\n        d.resize(n + 1, 0);\n        for (int i = 1; i < m - 1; ++i)\n        {\n            add(i + 1, js(nums, i));\n        }\n        vector<int> ans;\n        for (auto& query : queries)\n        {\n            if (query[0] == 1)\n            {\n                if (query[2] > query[1] + 1) {\n                    ans.push_back(sum(query[2]) - sum(query[1] + 1));\n                }\n                else {\n                    ans.push_back(0);\n                }\n            }\n            else if (query[0] == 2)\n            {\n                for (int j = query[1] - 1; j <= query[1] + 1; ++j)\n                {\n                    if (j > 0 && j < m - 1)\n                    {\n                        add(j + 1, -js(nums, j));\n                    }\n                }\n                nums[query[1]] = query[2];\n                for (int j = query[1] - 1; j <= query[1] + 1; ++j)\n                {\n                    if (j > 0 && j < m - 1)\n                    {\n                        add(j + 1, js(nums, j));\n                    }\n                }\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": 1718507092.0
}