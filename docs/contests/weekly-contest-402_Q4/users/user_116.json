{
    "username": "chen-jn-6",
    "submission": "\nint n,q;\nclass Solution {\n#define For(i_,l_,r_)for(int i_=(l_),g_=(r_);i_<=g_;i_++)\n#define Rep(i_,l_,r_)for(int i_=(l_),g_=(r_);i_>=g_;i_--)\n#define Ci const int\nstruct BIT{\n   vector<int>tr;\n   #define lowbit(x)(x&-x)\n   inline void add(int x,Ci d){\n       for(;x<=n;x+=lowbit(x))tr[x]+=d;\n   }\n   inline int query(int x){\n       int res=0;\n       for(;x;x-=lowbit(x))res+=tr[x];\n       return res;\n   }\n   inline int Q(Ci l,Ci r){\n       if(l>r)return 0;\n       return query(r)-query(l-1);\n   }\n}t;\npublic:\n    vector<int> countOfPeaks(vector<int>& a, vector<vector<int>>& Q) {\n        n=a.size(),q=Q.size();\n        a.push_back(0);Rep(i,n,1)a[i]=a[i-1];a[0]=0;\n        t.tr.resize(n+5);\n        For(i,2,n-1)\n            if(a[i]>a[i-1]&&a[i]>a[i+1])t.add(i,1);\n        vector<int>ans;\n        For(i,0,q-1){\n            int op=Q[i][0],x=Q[i][1],y=Q[i][2];\n            if(op==1)++x,++y,ans.push_back(t.Q(x+1,y-1));\n            else{\n                ++x;\n                if(x>2&&a[x-1]>a[x]&&a[x-1]>a[x-2])t.add(x-1,-1);\n                if(x>1&&x<n&&a[x]>a[x-1]&&a[x]>a[x+1])t.add(x,-1);\n                if(x<n-1&&a[x+1]>a[x]&&a[x+1]>a[x+2])t.add(x+1,-1);\n                a[x]=y;\n                if(x>2&&a[x-1]>a[x]&&a[x-1]>a[x-2])t.add(x-1,1);\n                if(x>1&&x<n&&a[x]>a[x-1]&&a[x]>a[x+1])t.add(x,1);\n                if(x<n-1&&a[x+1]>a[x]&&a[x+1]>a[x+2])t.add(x+1,1);\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": 1718506383.0
}