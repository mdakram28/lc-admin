{
    "username": "Hengdang_killer",
    "submission": "class Solution \n{\npublic:\n    long long countSubarrays(vector<int>& nums, int k) \n    {\n        long long ans = 0;\n        int n = nums.size();\n        vector<vector<int>> v(32, vector<int> (n, 0));\n        for(int i = 0; i < n; i++)\n        {\n            for(int j = 0; j <= 31; j++)\n            {\n                if(i != 0)\n                    v[j][i] += v[j][i-1];\n                if(((nums[i] >> j) & 1))\n                    v[j][i]++;\n            }\n        }\n        for(int i = 0; i < n; i++)\n        {\n            int l = i, r = n-1, idx = -1;\n            while(l <= r)\n            {\n                int mid = l + (r-l) / 2;\n                int len = mid - i + 1;\n                int ok = 1;\n                for(int j = 0; j <= 31; j++)\n                {\n                    if(((k>>j)&1) == 0)\n                        continue;\n                    int cnt = v[j][mid];\n                    if(i != 0)\n                        cnt -= v[j][i-1];\n                    if(cnt != len)\n                    {\n                        ok = 0;\n                        break;\n                    }\n                }\n                if(ok)\n                    idx = mid, l = mid + 1;\n                else\n                    r = mid - 1;\n            }\n            if(idx != -1)\n            {\n                int cur = idx;\n                l = i, r = idx;\n                idx = -1;\n                while(l <= r)\n                {\n                    int mid = l + (r-l) / 2;\n                    int len = mid - i + 1, ok = 1;\n                    for(int j = 0; j <= 31; j++)\n                    {\n                        if(((k>>j)&1) == 1)\n                            continue;\n                        int cnt = v[j][mid];\n                        if(i != 0)\n                            cnt -= v[j][i-1];\n                        if(cnt == len)\n                        {\n                            ok = 0;\n                            break;\n                        }   \n                    }\n                    if(ok)\n                        idx = mid, r = mid - 1;\n                    else\n                        l = mid + 1;\n                }\n                if(idx != -1)\n                {\n                    int len = cur - idx + 1;\n                    ans += len;\n                }\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1720279835",
    "subm_id": "1311766997"
}