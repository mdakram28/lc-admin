{
    "username": "Wibo",
    "submission": "class Solution {\npublic:\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n        int n = nums.size();\n        \n        vector<int> bit(n+1, 0);\n        auto update = [&](int i, int x) -> void {\n            while (i <= n) {\n                bit[i] += x;\n                i += i&-i;\n            }\n        };\n        auto _query = [&](int i) -> int {\n            int ret = 0;\n            while (i > 0) {\n                ret += bit[i];\n                i -= i&-i;\n            }\n            return ret;\n        };\n        auto query = [&](int l, int r) -> int {\n            return _query(r) - _query(l-1);\n        };\n        for (int i=1; i+1<n; i++) {\n            if (nums[i] > nums[i-1] && nums[i] > nums[i+1]) update(i+1, 1);\n        }\n        \n        vector<int> ret;\n        for (auto &vq : queries) {\n            int t = vq[0];\n            if (t == 1) {\n                int l = vq[1], r = vq[2];\n                \n                int ans = query(l+1, r+1);\n                if (l > 0 && l+1 < n && nums[l] > nums[l-1] && nums[l] > nums[l+1]) ans--;\n                if (r > l && r > 0 && r+1 < n && nums[r] > nums[r-1] && nums[r] > nums[r+1]) ans--;\n                \n                ret.push_back(ans);\n            } else {\n                int i = vq[1], x = vq[2];\n                \n                if (i > 0 && i+1 < n && nums[i] > nums[i-1] && nums[i] > nums[i+1]) update(i+1, -1);\n                if (i-1 > 0 && i < n && nums[i-1] > nums[i-2] && nums[i-1] > nums[i]) update(i, -1);\n                if (i+1 > 0 && i+2 < n && nums[i+1] > nums[i] && nums[i+1] > nums[i+2]) update(i+2, -1);\n                \n                nums[i] = x;\n                \n                if (i > 0 && i+1 < n && nums[i] > nums[i-1] && nums[i] > nums[i+1]) update(i+1, 1);\n                if (i-1 > 0 && i < n && nums[i-1] > nums[i-2] && nums[i-1] > nums[i]) update(i, 1);\n                if (i+1 > 0 && i+2 < n && nums[i+1] > nums[i] && nums[i+1] > nums[i+2]) update(i+2, 1);\n            }\n        }\n        \n        return ret;\n    }\n};",
    "submit_ts": 1718506555.0
}