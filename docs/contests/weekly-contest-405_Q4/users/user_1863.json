{
    "username": "arnab_baishnab",
    "submission": "#pragma GCC optimize(\"O3,unroll-loops\")\n#pragma GCC target(\"avx2,bmi,bmi2,lzcnt,popcnt\")\n#define ll long long\n#define pii pair<ll, ll>\n#define ff first\n#define ss second\n\nconst ll MAX_N = 5e4 + 10, mod = 2e9 + 63, base1 = 1e9 + 21, base2 = 1e9 + 181;\nint s[MAX_N]; // 1-indexed\nll pw1[MAX_N], pw2[MAX_N], slen;\n\nvoid pw_calc() {\n    pw1[0] = pw2[0] = 1;\n    for (int i = 1; i < MAX_N; i++) {\n        pw1[i] = (pw1[i - 1] * base1) % mod;\n        pw2[i] = (pw2[i - 1] * base2) % mod;\n    }\n}\n\nstruct Hash {\n    ll h1[MAX_N], h2[MAX_N];\n\n    void init() {\n        h1[0] = h2[0] = 0;\n        for (int i = 1; i <= slen; i++) {\n            h1[i] = (h1[i - 1] * base1 + s[i]) % mod;\n            h2[i] = (h2[i - 1] * base2 + s[i]) % mod;\n        }\n    }\n\n    inline ll hashVal(int l, int r) {\n        ll hsh1 = (h1[r] - h1[l - 1] * pw1[r - l + 1]) % mod;\n        if (hsh1 < 0)\n            hsh1 += mod;\n        ll hsh2 = (h2[r] - h2[l - 1] * pw2[r - l + 1]) % mod;\n        if (hsh2 < 0)\n            hsh2 += mod;\n        return (hsh1 << 32) | hsh2;\n    }\n\n    inline ll hashOne(int l, int r) {\n        ll hsh1 = (h1[r] - h1[l - 1] * pw1[r - l + 1]) % mod;\n        if (hsh1 < 0)\n            hsh1 += mod;\n        return hsh1;\n    }\n\n    inline ll hashTwo(int l, int r) {\n        ll hsh2 = (h2[r] - h2[l - 1] * pw2[r - l + 1]) % mod;\n        if (hsh2 < 0)\n            hsh2 += mod;\n        return hsh2;\n    }\n} fw;\n\nclass Solution {\npublic:\n    int minimumCost(string target, vector<string>& words, vector<int>& costs) {\n        pw_calc();\n\n        vector<pii> vw[26];\n        vector<int> vc[26];\n\n        int oo = 1e9 + 7, c = 0;\n\n        for (string str : words) {\n            slen = str.size();\n            str = '#' + str;\n            for (int i = 1; i <= slen; i++) {\n                s[i] = str[i];\n            }\n            fw.init();\n            vw[str[1]-'a'].push_back({fw.hashVal(1, slen), slen});\n            vc[str[1]-'a'].push_back(costs[c]);\n            ++c;\n        }\n\n        string str = target;\n\n        slen = target.size();\n        str = '#' + str;\n        for (int i = 1; i <= slen; i++) {\n            s[i] = str[i];\n        }\n        fw.init();\n\n        vector<int> dp(slen + 7, oo);\n\n        dp[slen+1] = 0;\n\n        for (int i = slen; i>=1; i--) {\n            c = str[i] - 'a';\n            for (int j = 0; j < vw[c].size(); ++j) {\n                if (i + vw[c][j].ss <= slen + 1 and\n                    vw[c][j].ff == fw.hashVal(i , i + vw[c][j].ss - 1)) {\n                    dp[i] = min(dp[i], vc[c][j] + dp[i + vw[c][j].ss]);\n                }\n            }\n        }\n\n        if (dp[1] >= oo) {\n            dp[1] = -1;\n        }\n        return dp[1];\n    }\n};",
    "submit_ts": "1720324501",
    "subm_id": "1312401062"
}