{
    "username": "leetcode_3604",
    "submission": "class Solution {\npublic:\n    int s[100010];\n    int n;\n    void update(int x, int v) {\n        while(x <= n) {\n            s[x] += v;\n            x += x & (-x);\n        }\n    }\n    int get(int x) {\n        int ret(0);\n        while(x>0) {\n            ret += s[x];\n            x -= x &(-x);\n        }\n        return ret;\n    }\n    vector<int> a;\n    bool peak(int x) {\n        if(x <= 0 || x >= a.size()-1) return false;\n        return a[x] > a[x-1] && a[x] > a[x+1];\n    }\n    bool f[100010];\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n        memset(s, 0, sizeof(s));\n        memset(f, 0, sizeof(f));\n        a = nums;\n        n = nums.size();\n        for(int i=1; i < n-1; ++i) {\n            if(nums[i] > nums[i-1] && nums[i] > nums[i+1]) {\n                update(i+1, 1);\n                f[i] = 1;\n            }\n        }\n        vector<int> ans;\n        for(int i = 0; i < queries.size(); ++i) {\n            int t = queries[i][0];\n            int x = queries[i][1]; \n            int v = queries[i][2];\n            if(t == 1) {\n                int res = max(0, get(v) - get(min(n,x+1)));\n                //printf(\"%d %d\\n\", v, min(n,x+1));\n                ans.push_back(res);\n            } else {\n                a[x] = v;\n                \n                int nf = peak(x);\n                if(nf != f[x]) update(x+1, nf?1:-1);\n                f[x] = nf;\n                if(x-1>= 0) {\n                    nf = peak(x-1);\n                    if(nf != f[x-1]) update(x, nf ? 1 : -1);\n                    \n                    //printf(\"%d %d %d\\n\", x-1, nf, f[x-1]);\n                    f[x-1] = nf;\n                }\n                if(x+1< a.size()) {\n                    nf = peak(x+1);\n                    if(nf != f[x+1]) update(x+2, nf ? 1 : -1);\n                    f[x+1] = nf;\n                }\n            }\n        }\n        return ans;\n    }\n};\n// 1, 10, 7, 9, 10",
    "submit_ts": 1718506965.0
}