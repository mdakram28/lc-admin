{
    "username": "FSPINDLE",
    "submission": "class Solution {\npublic:\n    long long countSubarrays(vector<int>& arr, int k) {\n                   \n                using ll = long long ;\n            \n                int n = arr.size() ;\n//                 int LOG = 20;\n\n//                 vector<vector<ll>>nxt(n + 1 ,vector<ll>(LOG , -1));\n//                 auto table = nxt ;\n\n//                 for(int i = 0 ; i < n ; i ++){\n//                      nxt[i][0] = (i + 1) < n ? i + 1 : - 1;      \n//                      table[i][0] = arr[i] ;\n//                 }\n\n//                 for(int i = 1 ; i < LOG ; i ++){\n                        \n//                         for(int j = 0 ; j < n ; j ++){\n//                              if(nxt[j][i - 1] != -1) {\n//                                      table[j][i] = table[nxt[j][i - 1]][i - 1] & table[j][i - 1] ;\n//                                      nxt[j][i] = nxt[nxt[j][i - 1]][i - 1];\n//                              }\n//                         }\n//                 }\n\n                \n//         auto qry = [&](int x, int kk){\n          \n\n//            int res = x, ret= arr[x] ;\n//            while (kk > 0){\n                \n//             int jump = kk & (-kk);\n//             int bit = __builtin_ctz(jump);\n//              ret &= table[res][bit];\n//              res = nxt[res][bit];         \n//              kk -= jump;\n//           }\n//            return res;\n//         };  \n             \n            // cout << table[0][1] << endl;\n            \n            vector<vector<ll>>pref(n + 1 , vector<ll>(31)) ;\n            \n            for(ll i = 0 ; i < n ; i ++){\n                      for(ll j = 0 ; j < 31  ; j ++){\n                                 bool f = (arr[i] >> j ) & 1 ;\n                                 pref[i + 1][j] += pref[i][j] + f ;\n                      }\n            }\n            auto qry = [&](ll i , ll j){\n                    \n                    ll ret = 0;\n                     for(int bit = 0 ; bit < 31 ; bit ++){\n                               if(pref[j + 1][bit] - pref[i][bit] == j - i + 1) ret |= (1 << bit) ;\n                     }\n                    return ret;\n            };\n            \n             ll ans = 0;\n            \n            for(int i = 0 ; i < n ;i ++){ \n                     \n                     ll low = i , high = n - 1 , x = -1  , y = -1 ; \n                    // cout << i << endl;\n                    \n                    while(low <=  high){\n                              \n                            ll mid = low + (high - low) / 2 ;\n                            // y = low ;\n                             if(qry(i , mid ) <= k){\n                                       high = mid - 1;   \n                                       x = mid  ;\n                             }\n                            else {                                      \n                                     low = mid + 1 ;\n                            }\n                            // y = low ;\n                    }\n                     // y = low ;\n                    low =  i , high = n - 1 ;\n                      \n                    while(low <= high){\n                              \n                            ll mid = low + (high - low) / 2 ;\n                            // if(qry(i , mid  )== k){\n                            //            cout << i << \" \" << mid << endl;\n                            // }\n                            // x = low ;\n                             if(qry(i , mid  ) >= k){\n                                      low = mid + 1;\n                                      y = mid ;\n                                       \n                             }\n                            else {\n                                    high = mid - 1 ;\n                                   // x = mid ;\n                            }\n                            // x = low ;\n                    }\n                    // x = low ;\n                    if((qry(i , x)) != k || x == -1 || y  == -1) continue ;\n                    // if(i == 0){\n                               // cout << i << \" \" << x << \" \" << y << endl;\n                             // cout << qry(i , y) << endl;\n                   //  }\n                    ll len = (y - x  + 1) ;\n                     ans += len ;\n            }\n            \n            \n            return ans;\n                       \n    }\n};\n\n\n\n\n\n\n\n\n\n",
    "submit_ts": "1720281456",
    "subm_id": "1311825821"
}