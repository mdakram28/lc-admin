{
    "username": "szoro",
    "submission": "class Solution {\npublic:\n    int numberOfSubstrings(string s) {\n        int n = s.size();\n        int p[n+1];\n        p[0] = 0;\n        for(int i=0;i<n;i++){\n            p[i+1] = p[i] + s[i]-'0';\n\n\n        }\n        int zero[n+1];\n        zero[n] = n;\n        int len = 0,olen=0;\n        for(int i=n-1;i>=0;i--){\n            if(s[i]=='0')zero[i] = i;\n            else zero[i] = zero[i+1];\n\n            if(s[i]=='1')len++;\n            else len = 0;\n            olen+=len;\n\n        }\n\n        int to = n* (n+1) / 2;\n        if(zero[0] == n){\n            return to;\n        }\n        int zc = 1,ans=0;\n        while(zc<sqrt(n)){\n            int  l= 0;\n            int r = l;\n            int ct = 0;\n            while(r<n){\n                int os = p[r+1]-p[l];\n                int zs = r-l+1 - os;\n                //cout<<zc<<\" \"<<l<<\" \"<<r<<\" \"<<os<<\" \"<<zs<<endl;\n                if(zs>zc){\n                    l= zero[l]+1;\n                    os = p[r+1]-p[l]; \n                    zs = r-l+1 - os;                   \n                }\n\n                if(zc==zs){ \n                    if(os>=zs*zs){\n                        if(s[l]=='0')ans++;\n                        else{\n                            int nxi = zero[l];\n                            int extra = os-zc*zc;\n                            ans+=1+min(extra,nxi-l);\n                            //cout<<nxi<<\" \"<<extra<<\" \"<<ans<<endl;\n\n                        }\n\n                    }\n                }\n                r++;\n            }\n\n            zc++;\n\n        }\n        //cout<<ans<<endl;\n        return ans+olen;\n        // int ans = 0;\n        // for(int len = 1;len<sqrt(n);len++){\n        //     for(int i=0;i<n;i++){\n        //         int st = i;\n        //         int end = i + len + len*len;\n        //         if(end>n)break;\n        //         int o = p[end]-p[st];\n        //         int z = end-st - o;\n        //         if(o>=z*z)ans++;\n        //     }\n        // }\n        // return ans;\n    }\n};",
    "submit_ts": "1722137676",
    "subm_id": "1335770565"
}