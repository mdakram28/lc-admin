{
    "username": "ReturnBack7778",
    "submission": "class Solution {\npublic:\n  void fenwick_update(vector<int>& fenwick, int index, int delta) {\n    for (++index; index < fenwick.size(); index += index & -index)\n        fenwick[index] += delta;\n}\n\nint fenwick_query(const vector<int>& fenwick, int index) {\n    int sum = 0;\n    for (++index; index > 0; index -= index & -index)\n        sum += fenwick[index];\n    return sum;\n}\n\nint fenwick_query(const vector<int>& fenwick, int left, int right) {\n    return fenwick_query(fenwick, right) - fenwick_query(fenwick, left - 1);\n}\n\nbool is_peak(const vector<int>& nums, int i) {\n    return i > 0 && i < nums.size() - 1 && nums[i] > nums[i - 1] && nums[i] > nums[i + 1];\n}\n\nvoid handle_peak_update(vector<int>& nums, vector<int>& fenwick, int index, bool remove) {\n    if (index > 0 && index < nums.size() - 1) {\n        if (is_peak(nums, index)) {\n            fenwick_update(fenwick, index, remove ? -1 : 1);\n        }\n    }\n}\n\nvoid update_peak_count(vector<int>& nums, vector<int>& fenwick, int index, int new_val) {\n    handle_peak_update(nums, fenwick, index - 1, true);\n    handle_peak_update(nums, fenwick, index, true);\n    handle_peak_update(nums, fenwick, index + 1, true);\n\n    nums[index] = new_val;\n\n    handle_peak_update(nums, fenwick, index - 1, false);\n    handle_peak_update(nums, fenwick, index, false);\n    handle_peak_update(nums, fenwick, index + 1, false);\n}\n    \n    \n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n       int n = nums.size();\n    vector<int> fenwick(n + 1, 0);\n\n    // Initial peak detection and update in Fenwick Tree\n    for (int i = 1; i < n - 1; ++i) {\n        if (is_peak(nums, i)) {\n            fenwick_update(fenwick, i, 1);\n        }\n    }\n\n    vector<int> answer;\n    for (const auto& query : queries) {\n        if (query[0] == 1) {\n            int li = query[1], ri = query[2];\n            if (li >= ri - 1) {\n                answer.push_back(0);\n            } else {\n                answer.push_back(fenwick_query(fenwick, li + 1, ri - 1));\n            }\n        } else if (query[0] == 2) {\n            int indexi = query[1], vali = query[2];\n            update_peak_count(nums, fenwick, indexi, vali);\n        }\n    }\n\n    return answer;\n    }\n};",
    "submit_ts": 1718508514.0
}