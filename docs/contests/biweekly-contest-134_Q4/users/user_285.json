{
    "username": "gupta_gopal",
    "submission": "class Solution {\npublic:\n    #define ll long long\n    \n    // BS approach:- // because and will start dec when range is inc.\n    ll start_point(ll i,ll n,ll k,vector<vector<ll>>&dp){\n        ll l=i,r=n-1,ans=-1;\n        while(l<=r){\n            ll m=(l+r)/2,len=m-i+1;\n            ll cur=0;\n            for(ll j=0;j<30;j++){\n                if((dp[m][j]-(i?dp[i-1][j]:0))==len) cur|=(1ll<<j);\n            }\n            // cout<<i<<\" \"<<l<<\" \"<<r<<\" \"<<m<<\" \"<<len<<\" \"<<(dp[m][0]-(l?dp[l-1][0]:0))<<\"      \"<<cur<<\" \"<<ans<<\" \"<<k<<\" \"<<(cur==k)<<\"       \";\n            if(cur==k){\n                ans=m;\n                r=m-1;\n            }\n            else if(cur>k){\n                l=m+1;\n            }\n            else{\n                r=m-1;\n            }\n            // cout<<l<<\" \"<<r<<\" \"<<ans<<'\\n';\n        }\n        // cout<<\"start  \"<<i<<\" \"<<ans<<\"\\n\";\n        return ans;\n    }\n    \n    ll end_point(ll i,ll n,ll k,vector<vector<ll>>&dp){\n        ll l=i,r=n-1,ans=-1;\n        while(l<=r){\n            ll m=(l+r)/2,len=m-i+1;\n            ll cur=0;\n            for(ll j=0;j<30;j++){\n                if((dp[m][j]-(i?dp[i-1][j]:0))==len) cur|=(1ll<<j);\n            }\n            // cout<<i<<\" \"<<l<<\" \"<<r<<\" \"<<m<<\" \"<<len<<\" \"<<(dp[m][0]-(l?dp[l-1][0]:0))<<\"      \"<<cur<<\" \"<<ans<<\" \"<<k<<\" \"<<(cur==k)<<\"       \";\n            if(cur==k){\n                ans=m;\n                l=m+1;\n            }\n            else if(cur>k){\n                l=m+1;\n            }\n            else{\n                r=m-1;\n            }\n            // cout<<l<<\" \"<<r<<\" \"<<ans<<'\\n';\n        }\n        // cout<<\"end  \"<<i<<\" \"<<ans<<\"\\n\";\n        return ans;\n    }\n    \n    long long countSubarrays(vector<int>& v,int k){\n        ios_base::sync_with_stdio(0); cin.tie(0); cout.tie(0);\n        ll n=v.size();\n        vector<vector<ll>>dp(n,vector<ll>(30,0));\n        for(ll i=0;i<n;i++){\n            for(ll j=0;j<30;j++){\n                if(v[i]&(1ll<<j)){\n                    dp[i][j]=1+(i?dp[i-1][j]:0);\n                }\n            }\n        }\n        // cout<<dp[0][0]<<\"\\n\";\n        ll ans=0;\n        for(ll i=0;i<n;i++){\n            ll l=start_point(i,n,k,dp);\n            if(l==-1) continue;\n            ll e=end_point(i,n,k,dp);\n            // cout<<\"in  \"<<i<<\" \"<<l<<\" \"<<e<<'\\n';\n            ans+=e-l+1;\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1720278991",
    "subm_id": "1311732731"
}