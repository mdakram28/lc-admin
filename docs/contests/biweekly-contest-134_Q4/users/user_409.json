{
    "username": "lsqu",
    "submission": "class Solution {\n    public long countSubarrays(int[] nums, int k) {\n        int n = nums.length;\n        int[][] f = new int[n + 1][32];\n        for (int i = 1; i <= n; i++) {\n            int v = nums[i - 1];\n            for (int j = 0; j < 32; j++) {\n                f[i][j] = f[i - 1][j];\n                if ((v >> j & 1) == 1) f[i][j]++;\n            }\n        }\n        \n        long ans = 0;\n        for (int i = 1; i <= n; i++) {\n            int l = 0, r = i - 1;\n            while (l < r) {\n                int m = l + r >>> 1;\n                int v = 0;\n                for (int j = 0; j < 32; j++) {\n                    if (f[i][j] - f[m][j] >= i - m) v |= 1 << j; \n                }\n                if (v >= k) r = m;\n                else l = m + 1;\n            }\n            int le = l;\n            \n            int t = 0;\n            for (int j = 0; j < 32; j++) {\n                if (f[i][j] - f[le][j] >= i - le) t |= 1 << j; \n            }\n            if (t != k) continue;\n            \n            r = i - 1;\n            while (l < r) {\n                int m = l + r + 1 >>> 1;\n                int v = 0;\n                for (int j = 0; j < 32; j++) {\n                    if (f[i][j] - f[m][j] >= i - m) v |= 1 << j; \n                }\n                if (v <= k) l = m;\n                else r = m - 1;\n            }\n            \n            // System.out.println(i + \": \" + le + \" -> \" + r);\n            \n            ans += r - le + 1;\n        }\n        return ans;\n    }\n}",
    "submit_ts": "1720278858",
    "subm_id": "544564735"
}