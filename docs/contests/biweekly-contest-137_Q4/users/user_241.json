{
    "username": "boxlesscat",
    "submission": "using ll = long long;\n\n\nclass Solution {\npublic:\n    long long maximumValueSum(vector<vector<int>>& board) {\n        const int rows = board.size();\n        const int cols = board[0].size();\n\n        vector<vector<pair<ll, int>>> vec(rows, vector<pair<ll, int>>(6, {LLONG_MIN / 4, -1}));\n        \n        ll mn, mni;\n\n        int unq = 1e7;\n\n        for (int row = 0; row < rows; ++row) {\n            for (int i = 0; i < 6; ++i)\n                if (vec[row][i].second == -1)\n                    vec[row][i].second = unq++;\n            for (int col = 0; col < cols; ++col) {\n                mn = LLONG_MAX;\n                for (int i = 0; i < 6; ++i) {\n                    if (vec[row][i].first < mn) {\n                        mn = vec[row][i].first;\n                        mni = i;\n                    }\n                }\n                if (board[row][col] > mn) {\n                    vec[row][mni] = {board[row][col], col};\n                }\n            }\n        }\n\n        vector<vector<pair<ll, int>>> sfx = vec;\n        set<pair<ll, int>> st;\n        for (int row = rows - 1; row >= 0; --row) {\n            for (int i = 0; i < 6; ++i)\n                st.emplace(sfx[row][i]);\n            auto it = st.rbegin();\n            // cout << st.size() << endl;\n            // return {};\n            for (int i = 0; i < 6; ++i) {\n                sfx[row][i] = *it;\n                ++it;\n            }\n        }\n\n        vector<int> taken(cols + 1);\n        ll ans = LLONG_MIN;\n        ll sum = 0;\n\n        for (int i = 0; i < rows - 2; ++i) {\n            for (int ii = 0; ii < 6; ++ii) {\n                if (vec[i][ii].second >= cols)\n                    continue;\n                taken[vec[i][ii].second] = true;\n                sum = vec[i][ii].first;\n                for (int j = i + 1; j < rows - 1; ++j) {\n                    for (int jj = 0; jj < 6; ++jj) {\n                        if (vec[j][jj].second >= cols or taken[vec[j][jj].second])\n                            continue;\n                        taken[vec[j][jj].second] = true;\n                        sum += vec[j][jj].first;\n                        for (int kk = 0; kk < 6; ++kk) {\n                            if (sfx[j + 1][kk].second >= cols or taken[sfx[j + 1][kk].second])\n                                continue;\n                            ans = max(ans, sum + sfx[j + 1][kk].first);\n                        }\n                        sum -= vec[j][jj].first;\n                        taken[vec[j][jj].second] = false;\n                    }\n                }\n                taken[vec[i][ii].second] = false;\n                sum -= vec[i][ii].first;\n            }\n            \n        }\n\n        return ans;\n\n    }\n};",
    "submit_ts": "1723909317",
    "subm_id": "1359187942"
}