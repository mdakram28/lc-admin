{
    "username": "gooday",
    "submission": "class Solution {\npublic:\n    vector<long long> countKConstraintSubstrings(string s, int K, vector<vector<int>>& queries) {\n        int n = (int) s.length();\n        vector<vector<int>> acc(2, vector<int>(n + 1, 0));\n        for (int i = 0; i < n; ++i) {\n            acc[0][i + 1] = acc[0][i];\n            acc[1][i + 1] = acc[1][i];\n            acc[s[i] - '0'][i + 1] += 1;\n        }\n        auto check = [&](int l, int r) {\n            if (l > r) {\n                return true;\n            }\n            for (int j = 0; j < 2; ++j) {\n                int cnt = acc[j][r] - acc[j][l];\n                if (cnt <= K) {\n                    return true;\n                }\n            }\n            return false;\n        };\n        \n        vector<int> rights(n + 1, n);\n        for (int i = n - 1; i >= 0; --i) {\n            int r = rights[i + 1];\n            while (!check(i, r)) {\n                --r;\n            }\n            rights[i] = r;\n        }\n        \n        \n        vector<long long> sums(n + 1, 0);\n        for (int i = 0; i < n; ++i) {\n            sums[i + 1] = sums[i];\n            int L = rights[i] - i;\n            sums[i + 1] += L;\n        }\n        \n        auto query = [&](int l, int r) {\n            int lo = l, hi = r;\n            while (lo < hi) {\n                int mi = (lo + hi) / 2;\n                if (rights[mi] > r) {\n                    hi = mi;\n                } else {\n                    lo = mi + 1;\n                }\n            }\n            \n            long long res = sums[lo] - sums[l];\n            int m = r - lo + 1;\n            res += m * 1LL * (m + 1) / 2;\n            return res;\n        };\n        \n        int sz = (int) queries.size();\n        vector<long long> res(sz, 0);\n        for (int i = 0; i < sz; ++i) {\n            int l = queries[i][0];\n            int r = queries[i][1];\n            res[i] = query(l, r);\n        }\n        return res;\n    }\n};",
    "submit_ts": "1723951687",
    "subm_id": "556407051"
}