{
    "username": "Romy67",
    "submission": "#define rep(i, a, b) for(int i = a; i < (b); ++i)\n#define per(i, a, b) for(int i = a; i > (b); --i)\n#define ar array\n#define sz(x) (int) (x).size()\n#define pii pair<int,int>\n#define fi first\n#define se second\ntypedef long long ll;\ntypedef pair<ll,ll> pll;\ntypedef pair<double,double> pdd;\ntypedef pair<double,int> pdi;\ntypedef vector<int> vi;\n\ntemplate<typename T>\nvoid min_self(T& A, T B) {\n    A = min(A,B);\n}\ntemplate<typename T>\nvoid max_self(T& A, T B) {\n    A = max(A,B);\n}\n\nclass Solution {\npublic:\n    int numberOfSubstrings(string s) {\n        int ans = 0;\n        vector<int> v;\n        int tmp = 0;\n        rep(i,0,sz(s)) {\n            if(s[i]=='0') {\n                v.push_back(tmp);\n                tmp = 0;\n            } else {\n                tmp++;\n            }\n        }\n        v.push_back(tmp);\n        rep(i,0,sz(v)) {\n            ans += v[i]*(v[i]+1)/2;\n        }\n        rep(len,1,201) {\n            if(len*len + len > sz(s)) break;\n            int sm = v[0];\n            int l=0;\n            rep(r,1,sz(v)) {\n                if(r-l <=len) {\n                    sm += v[r];\n                } else {\n                    sm += v[r]-v[l];\n                    l++;\n                }\n                if(r-l == len) {\n                    // cout <<l <<\" \" <<r <<endl;\n                    // cout <<v[l] <<\" \" <<v[r] <<endl;\n                    int sisa = max(0, len*len - sm + v[l]+v[r]);\n                    // cout <<sisa <<endl;\n                    if(sisa==0) {\n                        ans += (v[l]+1)*(v[r]+1);\n                    } else {\n                        if(v[l]>=sisa) {\n                            ans += (v[l]-sisa+1)*(v[r]+1);\n                            // cout <<\"add \" <<(v[l]-sisa+1)*(v[r]+1) <<endl;\n                        }\n                        int ats = min(v[l],sisa-1);\n                        int bw = max(0, sisa-v[r]);\n                        if(bw<=ats) {\n                            int ats2 = v[r]-(sisa-ats)+1;\n                            int bw2 = v[r]-(sisa-bw)+1;\n                            ans += 1ll*(ats2-bw2+1)*(ats2+bw2)/2;\n                            // cout <<\"add \" <<1ll*(ats2-bw2+1)*(ats2+bw2)/2 <<endl;\n                        }\n                    }\n                }\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1722136449",
    "subm_id": "1335734825"
}