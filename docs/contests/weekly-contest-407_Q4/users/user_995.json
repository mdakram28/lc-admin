{
    "username": "ch365",
    "submission": "#pragma region template\n\n#include <iostream>\n#include <string>\n#include <cstring>\n#include <cstdio>\n#include <set>\n#include <map>\n#include <unordered_map>\n#include <cmath>\n#include <queue>\n#include <algorithm>\n#include <array>\n#include <functional>\n#include <cassert>\nusing namespace std;\n\n#define forn(i, n) for(int i = 0; i < (int)(n); i++)\n#define ford(i, n) for(int i = (int)(n) - 1; i >= 0; --i)\n#define forab(i, a, b) for(int i=(a);i<(b);++i)\n#define fore(v, a) for(auto &v: a)\n#define sqr(x) ((x)*(x))\n#define clr(a, b) memset(a, b, sizeof(a))\n#define sz(a) ((int)a.size())\n#define all(a) (a).begin(),(a).end()\n#define fi first\n#define se second\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef map<int,int> mii;\ntypedef map<int,string> mis;\ntypedef map<string,int> msi;\ntemplate <class T> using max_heap = priority_queue<T>;\ntemplate <class T> using min_heap = priority_queue<T, vector<T>, greater<>>;\nconst double eps = 1e-8;\ntemplate <class T> constexpr T inf = numeric_limits<T>::max() / 2;\nint dcmp(double x) { if (x < -eps) return -1; else return x > eps;}\ntemplate <typename T> bool chmax(T &m, const T q) { return m < q ? (m = q, true) : false; }\ntemplate <typename T> bool chmin(T &m, const T q) { return m > q ? (m = q, true) : false; }\nconstexpr pii dx4[4] = {{1, 0}, {0, 1}, {-1, 0}, {0, -1}};\nconstexpr pii dx8[8] = {{1, 0}, {1, 1}, {0, 1}, {-1, 1}, {-1, 0}, {-1, -1}, {0, -1}, {1, -1}};\ntemplate <class T> using vc = vector<T>;\ntemplate <class T> using vvc = vector<vc<T>>;\ntemplate <class T> using vvvc = vector<vvc<T>>;\n#define minall(v) *min_element(all(v))\n#define maxall(v) *max_element(all(v))\n#define lb(c, x) distance((c).begin(), lower_bound(all(c), (x)))\n#define ub(c, x) distance((c).begin(), upper_bound(all(c), (x)))\n#define unq(x) sort(all(x)), x.erase(unique(all(x)), x.end())\nint popcnt(unsigned int x) { return __builtin_popcount(x); }\nint popcntll(unsigned long long x) { return __builtin_popcountll(x); }\ntemplate <class T, class U> ostream& operator<<(ostream& os, const pair<T, U>& p){ return os<<\"(\"<<p.fi<<\",\"<<p.se<<\")\"; }\nvoid see0(){ cout<<endl; }\ntemplate<class H, class ...T> void see0(H && h, T && ...t) { cout<<h<<\",\"; see0(t...); }\n\n#pragma endregion template\n\n#ifdef CHEN_PC\n#include \"lc-struct.h\"\n#define see(...) {cout<<__LINE__<<\": \"<<#__VA_ARGS__<<\" = \";see0(__VA_ARGS__);}\n#define seev(a) {cout<<__LINE__<<\": \"<<#a<<\" = [\"; fore(v, a)cout<<(v)<<\",\"; cout<<\"]\"<<endl;}\n#else\n#define see(...)\n#define seev(...)\n#endif\n\nconst int N = 30010;\nconst int mod = 1000000007; // 10^9+7\n\nclass Solution {\npublic:\n\tlong long minimumOperations(vector<int>& a, vector<int>& b) {\n\t\tint n = sz(a);\n\t\tvl x(n);\n\t\tforn (i, n) x[i] = a[i] - b[i];\n\t\tseev(x);\n\n\t\tauto chk = [&] (ll u, ll v) {\n\t\t\tif (u >= 0 && v >= 0) return 1;\n\t\t\tif (u < 0 && v < 0) return 1;\n\t\t\t// if (u == 0 && v == 0) return 1;\n\t\t\treturn 0;\n\t\t};\n\n\t\tauto gao = [&] (vl z) {\n\t\t\tll ans = 0;\n\t\t\tint m = sz(z);\n\t\t\tif (m == 0) return ans;\n\t\t\tvc<pll> p(m);\n\t\t\tforn (i, m) {\n\t\t\t\tz[i] = abs(z[i]);\n\t\t\t\tp[i] = {z[i], i};\n\t\t\t}\n\t\t\tsort(all(p));\n\t\t\tset<ll> book;\n\t\t\tforn (i, m) {\n\t\t\t\tauto v = p[i];\n\t\t\t\tif (sz(book) == 0) {\n\t\t\t\t\tans += v.fi;\n\t\t\t\t} else {\n\t\t\t\t\tll t = 0;\n\t\t\t\t\tauto itr = book.lower_bound(v.se);\n\t\t\t\t\tif (itr == book.end()) {\n\t\t\t\t\t\titr--;\n\t\t\t\t\t\tt = z[*itr];\n\t\t\t\t\t} else if (itr == book.begin()) {\n\t\t\t\t\t\tt = z[*itr];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tt = z[*itr];\n\t\t\t\t\t\titr--;\n\t\t\t\t\t\tchmax(t, z[*itr]);\n\t\t\t\t\t}\n\t\t\t\t\tans += v.fi - t;\n\t\t\t\t}\n\t\t\t\tbook.insert(v.se);\n\t\t\t}\n\t\t\tseev(z);\n\t\t\tsee(ans);\n\t\t\treturn ans;\n\t\t};\n\n\t\tll ans = 0;\n\t\tvl z;\n\t\tforn (i, n) {\n\t\t\tif (sz(z) == 0) {\n\t\t\t\tz.push_back(x[i]);\n\t\t\t} else if (chk(z.back(), x[i])) {\n\t\t\t\tz.push_back(x[i]);\n\t\t\t} else {\n\t\t\t\tans += gao(z);\n\t\t\t\tz = vl(1, x[i]);\n\t\t\t}\n\t\t}\n\t\tans += gao(z);\n\t\treturn ans;\n\t}\n};",
    "submit_ts": "1721532217",
    "subm_id": "548391071"
}