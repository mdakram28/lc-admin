{
    "username": "MvKaio",
    "submission": "template<typename T> struct rmq {\n\tvector<T> v;\n\tint n; static const int b = 30;\n\tvector<int> mask, t;\n\n\tint op(int x, int y) { return v[x] <= v[y] ? x : y; }\n\tint msb(int x) { return __builtin_clz(1)-__builtin_clz(x); }\n\tint small(int r, int sz = b) { return r-msb(mask[r]&((1<<sz)-1)); }\n\trmq() {}\n\trmq(const vector<T>& v_) : v(v_), n(v.size()), mask(n), t(n) {\n\t\tfor (int i = 0, at = 0; i < n; mask[i++] = at |= 1) {\n\t\t\tat = (at<<1)&((1<<b)-1);\n\t\t\twhile (at and op(i-msb(at&-at), i) == i) at ^= at&-at;\n\t\t}\n\t\tfor (int i = 0; i < n/b; i++) t[i] = small(b*i+b-1);\n\t\tfor (int j = 1; (1<<j) <= n/b; j++) for (int i = 0; i+(1<<j) <= n/b; i++)\n\t\t\tt[n/b*j+i] = op(t[n/b*(j-1)+i], t[n/b*(j-1)+i+(1<<(j-1))]);\n\t}\n\tint index_query(int l, int r) {\n\t\tif (r-l+1 <= b) return small(r, r-l+1);\n\t\tint x = l/b+1, y = r/b-1;\n\t\tif (x > y) return op(small(l+b-1), small(r));\n\t\tint j = msb(y-x+1);\n\t\tint ans = op(small(l+b-1), op(t[n/b*j+x], t[n/b*j+y-(1<<j)+1]));\n\t\treturn op(ans, small(r));\n\t}\n\tT query(int l, int r) { return v[index_query(l, r)]; }\n};\n\nclass Solution {\nint n;\nvector<int> w;\nrmq<int> rm;\n    \n    long long solve(int l, int r, int tot=0) {\n        if (l > r) return 0;\n        if (l == r) return w[l] - tot;\n        \n        int m = rm.index_query(l, r);\n        long long ans = w[m] - tot;\n        ans += solve(l, m - 1, w[m]);\n        ans += solve(m + 1, r, w[m]);\n        return ans;\n    } \n    \npublic:\n    long long minimumOperations(vector<int>& A, vector<int>& B) {\n        n = A.size();\n        using ll = long long;\n        \n        vector<int> v = A;\n        for (int i = 0; i < n; i++) v[i] -= B[i];\n        w = v;\n        for (int i = 0; i < n; i++) {\n            w[i] = abs(w[i]);\n        }\n        \n        rm = rmq<int>(w);\n\n        ll ans = 0, inc = 0, dec = 0;\n        for (int l = 0, r = 0; l < n; l = r) {\n            if (v[l] == 0) {\n                r++;\n            } else {\n                while (r < n && (v[l] < 0) == (v[r] < 0)) r++;\n                ans += solve(l, r - 1, 0);\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1721529987",
    "subm_id": "1327919285"
}