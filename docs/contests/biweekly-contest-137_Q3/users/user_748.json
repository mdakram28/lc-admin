{
    "username": "valavshonok",
    "submission": "struct tab {\n    int lg = 9;\n    vector<vector<int>> a, b;\n    tab(vector<int>& aa) {\n        int n = aa.size();\n        a.resize(n, vector<int>(lg));\n        for (int i = 0; i < n; i++)\n            a[i][0] = aa[i];\n        b = a;\n        for (int j = 1; j < lg; j++)\n            for (int i = 0; i + (1 << j - 1) < n; i++)\n                b[i][j] = max(b[i][j - 1], b[i + (1 << j - 1)][j - 1]);\n    }\n    long long mx(int l, int r) {\n        if (r <= l)\n            return -2e9;\n        int c = log2(r - l);\n        return max(b[l][c], b[r - (1 << c)][c]);\n    }\n};\n\nclass Solution {\npublic:\n    long long maximumValueSum(vector<vector<int>>& a) {\n        int n = a.size(), m = a[0].size();\n        vector<tab> t;\n        for (auto i : a)\n            t.push_back(tab(i));\n        vector<vector<int>> b = a;\n        for (int i = 1; i < n; i++)\n            for (int j = 0; j < m; j++)\n                b[i][j] = max(b[i][j], b[i - 1][j]);\n        long long ans = -3e9;\n        for (int i = 0; i < m; i++)\n            for (int j = i + 1; j < m; j++) {\n                long long mx = -3e9;\n                for (int ii = n - 1; ii > 1; ii--) {\n                    mx = max({ mx, t[ii].mx(0, i), t[ii].mx(i + 1, j),\n                              t[ii].mx(j + 1, m) });\n                    ans = max(ans, mx + b[ii - 2][i] + a[ii - 1][j]);\n                    ans = max(ans, mx + b[ii - 2][j] + a[ii - 1][i]);\n                }\n            }\n        return ans;\n    }\n};",
    "submit_ts": "1723907500",
    "subm_id": "1359110614"
}