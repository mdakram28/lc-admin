{
    "username": "Redamancy",
    "submission": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#ifdef LOCAL_DEBUG\n#include \"debug2.hpp\"\n#else\n#define debug(...) 42\n#endif\n\ntypedef long long ll;\n\nclass Solution\n{\npublic:\n    vector<long long> countKConstraintSubstrings(string s, int k, vector<vector<int>> &q)\n    {\n        int n = s.size();\n        vector<int> R(n);\n        for (int i = 0, c0 = 0, c1 = 0, j = -1; i < n; i++) {\n            while (j < n && (c0 <= k || c1 <= k)) {\n                ++j;\n                if (j < n) {\n                    c0 += s[j] == '0';\n                    c1 += s[j] == '1';\n                }\n            }\n            R[i] = j - 1;\n            c0 -= s[i] == '0';\n            c1 -= s[i] == '1';\n        }\n        vector<ll> ans;\n        vector<ll> slen(n + 1);\n        for (int i = 0; i < n; ++i)\n            slen[i + 1] = slen[i] + R[i] - i + 1;\n\n        // debug(R);\n\n        for (auto qry : q) {\n            int l = qry[0], r = qry[1];\n\n            int nl = l, nr = r, p = l - 1;\n            while (nl <= nr) {\n                int mid = (nl + nr) / 2;\n                if (R[mid] <= r) {\n                    p = mid;\n                    nl = mid + 1;\n                } else {\n                    nr = mid - 1;\n                }\n            }\n\n            // debug(l, r, p);\n            // debug(slen);\n            \n            ans.push_back(0);\n            // [l, p]\n            if (p >= l) {\n                ans.back() += slen[p + 1] - slen[l];\n            }\n            // [p + 1, r]\n            if (r >= p + 1) {\n                int l = r - p;\n                ans.back() += (1ll + l) * l / 2;\n            }\n        }\n        return ans;\n    }\n};\n",
    "submit_ts": "1723951497",
    "subm_id": "556405808"
}