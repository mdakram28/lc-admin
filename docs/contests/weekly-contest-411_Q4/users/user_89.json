{
    "username": "Paras Yadav",
    "submission": "class Solution {\n    public long[] countKConstraintSubstrings(String S, int k, int[][] qu) {\n        s = S.toCharArray();\n        n = s.length;\n        ans = new long[qu.length];\n        int pz[] = new int[n];\n        int po[] = new int[n];\n        for(int i = 0; i < n; i++){\n            if(s[i] == '0')\n                pz[i] = 1;\n            else\n                po[i] = 1;\n            if(i > 0){\n                pz[i] += pz[i - 1];\n                po[i] += po[i - 1];\n            }\n        }\n        int next[] = new int[n];\n        for(int i = 0; i < n; i++){\n            int low = i, high = n - 1;\n            while(low <= high){\n                int mid = (low + high) >> 1;\n                int sumz = pz[mid] - (i == 0 ? 0 : pz[i - 1]);\n                int sumo = po[mid] - (i == 0 ? 0 : po[i - 1]);\n                // System.out.println(low+\" \"+mid+\" \"+sumz+\" \"+sumo);\n                if(sumz > k && sumo > k)\n                    high = mid - 1;\n                else\n                    low = mid + 1;\n            }\n            next[i] = low;\n        }\n        long pn[] = new long[n];\n        pn[0] = next[0];\n        for(int i = 1; i < n; i++)\n            pn[i] = next[i] + pn[i - 1];\n        int ansInd = 0;\n        // System.out.println(Arrays.toString(next));\n        for(int[] q : qu){\n            int l = q[0], r = q[1];\n            int low = l, high = r;\n            while(low <= high){\n                int mid = (low + high) >> 1;\n                if(next[mid] <= r)\n                    low = mid + 1;\n                else\n                    high = mid - 1;\n            }\n            long sum = 0;\n            if(high >= l && high <= r){\n                sum = pn[high] - (l == 0 ? 0 : pn[l - 1]);\n                long temp = (r + 1) * 1l * (high - l + 1);\n                sum = temp - sum;\n            }\n                \n            long tot = (r - l + 1);\n            tot = (tot * (tot + 1)) >> 1;\n            ans[ansInd++] = tot - sum;\n            // System.out.println(l+\" \"+r+\" \"+low+\" \"+sum+\" \"+tot);\n        }\n        return ans;\n    }\n    int n;\n    char s[];\n    long ans[];\n}",
    "submit_ts": "1723952925",
    "subm_id": "1359808015"
}