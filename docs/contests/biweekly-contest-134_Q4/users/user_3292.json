{
    "username": "1234zxc",
    "submission": "#define ll long long \nclass Solution\n{\npublic:\n    long long countSubarrays(vector<int> &nums, int k)\n    {\n        int n = nums.size();\n        vector<vector<int>> pre(n + 1, vector<int>(35, 0));\n        for (int i = 0; i < n; ++i)\n            for (int j = 0; j < 32; ++j)\n            {\n                if (i > 0)\n                    pre[i][j] = pre[i - 1][j];\n                if (nums[i] & (1 << j))\n                    pre[i][j]++;\n            }\n        auto getand = [&](int l, int r)\n        {\n            int res = 0;\n            for (int i = 0; i < 32; ++i)\n            {\n                int cur = pre[r][i];\n                if (l > 0)\n                    cur -= pre[l - 1][i];\n                if (cur == r - l + 1)\n                    res |= (1 << i);\n            }\n            return res;\n        };\n        ll ans = 0;\n        for (int i = 0; i < n; ++i)\n        {\n            int st = -1, en = -1;\n            int lo = i + 1;\n            int hi = n - 1;\n            int op = 0;\n            while (lo <= hi)\n            {\n                int mid = lo + (hi - lo) / 2;\n                int cur = getand(i, mid);\n                if (cur > k)\n                {\n                    lo = mid + 1;\n                }\n                else if (cur < k)\n                    hi = mid - 1;\n                else if (cur == k)\n                {\n                    st = mid;\n                    hi = mid - 1;\n                }\n            }\n\n            lo = i;\n            hi = n - 1;\n            op = 0;\n            while (lo <= hi)\n            {\n                int mid = lo + (hi - lo) / 2;\n                if (getand(i, mid) < k)\n                    hi = mid - 1;\n\n                else\n                {\n                    en = mid;\n                    lo = mid + 1;\n                }\n            }\n            if (st != -1 && en != -1)\n                ans += en - st + 1;\n            if (nums[i] == k)\n                ans++;\n        }\n\n        return ans;\n    }\n};",
    "submit_ts": "1720281575",
    "subm_id": "1311830523"
}