{
    "username": "vrangr",
    "submission": "template<typename type> inline void print(const type &var) {\n    cout << var;\n}\ntemplate<typename type> inline void print(const vector<type> &vec) {\n    for (auto &it : vec) {\n        print(it); cout << \" \";\n    }\n}\n#define debug(x) if(true){cout<<#x<<\": \";print(x);cout<<endl;}\nauto _=[]{ios_base::sync_with_stdio(false),cin.tie(0),cout.tie(0);return 0;}();\ntypedef long long int ll;\nconst ll mod = (ll)1e9+7ll;\nvector<vector<vector<ll>>> dp(301,vector<vector<ll>>(301,vector<ll>(401,-1)));\nclass Solution {\npublic:\n    int numberOfPermutations(ll n, vector<vector<int>>& req) {\n        ll m = req.size();\n        sort(req.begin(),req.end(),[](const vector<int> &a, const vector<int> &b) {\n            return a[0] < b[0];\n        });\n        // debug(req);\n        auto get = [](auto &&self, ll len, ll bd, ll t) -> ll {\n            if (len < 0 || bd < 0 || t < 0) return 0;\n            assert(len < dp.size());\n            assert(bd < dp[0].size());\n            assert(t < dp[0][0].size());\n            if (dp[len][bd][t] != -1) return dp[len][bd][t];\n            if (len == 1ll) {\n                return dp[len][bd][t] = (bd >= t);\n            }\n            assert(len > 1);\n            dp[len][bd][t] = 0ll;\n            for (ll cur = 0; cur <= bd; ++cur) {\n                dp[len][bd][t] += self(self,len-1ll, bd+1ll, t-cur);\n                dp[len][bd][t]%=mod;\n            }\n            return dp[len][bd][t];\n        };\n        ll sol = 1, last = -1ll, lcn = 0ll;\n        for (ll i = 0; i < m; ++i) {\n            // debug('\\n');\n            // debug(i);\n            // debug(req[i]);\n            // debug(last);\n            // debug(lcn);\n            // debug(get(get,req[i][0]-last,last+1ll,req[i][1]-lcn));\n            sol*=get(get,req[i][0]-last, last+1ll, req[i][1]-lcn);\n            sol%=mod;\n            // debug(sol);\n            last = req[i][0];\n            lcn = req[i][1];\n        }\n        return sol;\n    }\n};\n\n/*\n3\n[[2,2],[0,0]]\n3\n[[2,2],[1,1],[0,0]]\n2\n[[0,0],[1,0]]\n3\n[[2,0]]\n5\n[[0,0],[4,4],[3,3],[2,2]]\n\n2\n1\n1\n1\n2\n\n*/",
    "submit_ts": 1719069254.0
}