{
    "username": "Mohamed Shata",
    "submission": "typedef long long ll;\n#define rall(v) v.rbegin(), v.rend()\n#define F first\n#define S second\nclass Solution {\npublic:\n    long long maximumValueSum(vector<vector<int>>& board) {\n        int n=board.size();\n        int m=board[0].size();\n        vector<vector<pair<int,int>>> myboard(n,vector<pair<int,int>>(3));\n        for(int i=0;i<n;i++){\n            vector<pair<int,int>> v;\n            for(int j=0;j<m;j++)\n                v.push_back({board[i][j],j});\n            sort(rall(v));\n            for(int j=0;j<3;j++){\n                myboard[i][j]=v[j];\n            }\n        }\n        vector<vector<vector<bool>>> vis(n,vector<vector<bool>>(m+1,vector<bool>(m+1,false)));\n        vector<vector<vector<ll>>> dp(n,vector<vector<ll>>(m+1,vector<ll>(m+1)));\n\n        auto rec([&](int i,int lst,int lst1,auto &&rec){\n            if(i>=n-(lst==m)-(lst1==m))\n                return ll(-4e9);\n            if(vis[i][lst][lst1])\n                return dp[i][lst][lst1];\n            vis[i][lst][lst1]=true;\n\n            ll ans=rec(i+1,lst,lst1,rec);\n            if(lst1!=m&&lst!=m){\n                for (int j = 0; j < 3; ++j)\n                    if(myboard[i][j].S!=lst&&myboard[i][j].S!=lst1)\n                        ans=max(ans,ll(myboard[i][j].F));\n            }\n            else if(lst==m){\n                for (int j = 0; j <3; ++j)\n                    if(myboard[i][j].S!=lst&&myboard[i][j].S!=lst1)\n                        ans=max(ans,rec(i+1,myboard[i][j].S,lst1,rec)+myboard[i][j].F);\n            }\n            else if(lst1==m){\n                for (int j = 0; j < 3; ++j)\n                    if(myboard[i][j].S!=lst&&myboard[i][j].S!=lst1)\n                        ans=max(ans,rec(i+1,lst,myboard[i][j].S,rec)+myboard[i][j].F);\n            }\n            return dp[i][lst][lst1]=ans;\n        });\n        return rec(0,m,m,rec);\n    }\n};",
    "submit_ts": "1723909631",
    "subm_id": "1359199879"
}