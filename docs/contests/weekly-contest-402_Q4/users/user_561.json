{
    "username": "Coding_Dancer",
    "submission": "class Solution {\npublic:\n    struct Tr{\n        int n;\n        vector<int> tr;\n        int lowbit(int x) {\n            return x & (-x);\n        }\n\n        void add(int x, int c) {\n            for(int i = x ; i <= n ; i += lowbit(i))\n                tr[i] += c;\n        }\n\n        int sum(int x) {\n            int res = 0;\n            for(int i = x ; i ; i -=lowbit(i))\n                res += tr[i];\n            return res;\n        }\n\n        Tr(int sz) {\n            n = sz;\n            tr.resize(sz + 1, 0);\n        }\n    };\n\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n        int n = nums.size();\n        auto btr = Tr(n);\n        vector<int> ans;\n        vector<bool> flag(n, false);\n\n        for(int i = 1 ; i < n - 1 ; i ++) {\n            if(nums[i] > nums[i - 1] && nums[i] > nums[i + 1])\n                btr.add(i + 1, 1), flag[i] = true;\n        }\n\n        for(auto q : queries) {\n            if(q[0] == 1) {\n                int l = q[1], r = q[2];\n                l ++, r ++;\n                int cnt = 0;\n                if(l + 1 <= r - 1)\n                    cnt = btr.sum(r - 1) - btr.sum(l);\n                ans.push_back(cnt);\n            } else {\n                int pos = q[1], val = q[2];\n                nums[pos] = val;\n                for(int i = pos - 1 ; i <= pos + 1 ; i ++) {\n                    if(i >= 1 && i < n - 1) {\n                        if(nums[i] > nums[i - 1] && nums[i] > nums[i + 1]) {\n                            if(flag[i]) continue;\n                            btr.add(i + 1, 1);\n                            flag[i] = true;\n                        } else {\n                            if(flag[i]) {\n                                btr.add(i + 1, -1);\n                                flag[i] = false;\n                            }\n                        }\n                    }\n                }\n\n            }\n        }\n\n        return ans;\n    }\n};",
    "submit_ts": 1718507599.0
}