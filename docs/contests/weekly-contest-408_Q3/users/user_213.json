{
    "username": "half_blood_prince_",
    "submission": "class Solution {\npublic:\n    #define ll long long\n    int numberOfSubstrings(string s) {\n        int n=s.size();\n        vector<ll>po(n,0),pz(n,0);\n        for(int i=0;i<n;i++){\n            if(s[i]=='1'){\n                po[i]=1;\n            }\n            else {\n                pz[i]=1;\n            }\n            if(i!=0){\n                po[i]+=po[i-1];\n                pz[i]+=pz[i-1];\n            }\n        }\n        vector<ll>ind(n,n);\n        int last=n;\n        for(int i=n-1;i>=0;i--){\n            if(s[i]=='0'){\n                last=i;\n            }\n            else {\n                ind[i]=last;\n            }\n        }\n        ll cc=0;\n        for(ll i=0;i<n;i++){\n            ll zero=0,one=0;\n            ll j=i;\n            while(j<n){\n                if(s[j]=='0'){\n                    if(i==0){\n                        zero=pz[j];\n                    }\n                    else {\n                        zero=(pz[j]-pz[i-1]);\n                    }\n                    if(i==0){\n                        one=po[j];\n                    }\n                    else {\n                        one=(po[j]-po[i-1]);\n                    }\n                    if(one>=(zero*1ll*zero)){\n                        cc++;\n                        j++;\n                    }\n                    else {\n                        ll rest=(zero*1ll*zero)-one;\n                        j+=rest;\n                        if(j>=n){\n                            break;\n                        }\n                    }\n                }\n                else {\n                    if(i==0){\n                        one=po[j];\n                    }\n                    else {\n                        one=(po[j]-po[i-1]);\n                    }\n                    if(i==0){\n                        zero=pz[j];\n                    }\n                    else {\n                        zero=(pz[j]-pz[i-1]);\n                    }\n                    if(one>=(zero*1ll*zero)){\n                        cc+=(ind[j]-j);\n                        j=ind[j];\n                    }\n                    else{\n                        ll rest=(zero*1ll*zero)-one;\n                        j+=rest;\n                        if(j>=n){\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n        return cc;\n    }\n};",
    "submit_ts": "1722137254",
    "subm_id": "1335758537"
}