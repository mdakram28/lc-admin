{
    "username": "manoj230322",
    "submission": "class Solution {\npublic:\n    vector<long long> countKConstraintSubstrings(string s, int k, vector<vector<int>>& queries) {\n        long long n = s.size();\n        long long m = queries.size();\n        vector<long long> pfx(n+1,0);\n        vector<long long> ends(n+1);\n        vector<long long> ones,zeroes;\n        vector<long long> orn(n+1,0),zrn(n+1,0);\n        long long co=0,cz=0;\n        for(long long i = 0 ; i<n  ; i++){\n            if(s[i]=='0'){\n                zeroes.push_back(i+1);\n                zrn[i+1]=zrn[i]+1;\n                orn[i+1]=orn[i];\n                cz++;\n            }else{\n                ones.push_back(i+1);\n                orn[i+1]=orn[i]+1;\n                zrn[i+1]=zrn[i];\n                co++;\n            }\n        }\n        \n        for(long long i =1 ; i<=n ; i++){\n            long long currzero = zrn[i-1]+k+1;\n            long long currones = orn[i-1]+k+1;\n            if(currzero>cz){\n                ends[i]=n;\n               \n            }else if(currones>co){\n                ends[i]=n;\n               \n            }else{\n                ends[i]=max(zeroes[currzero-1]-1,ones[currones-1]-1);\n            }\n            pfx[i]+=(ends[i]-i+1);\n            pfx[i]+=pfx[i-1];\n        }\n        vector<long long> ans;\n        for(int i =0 ;i<m; i++){\n            long long l = queries[i][0]+1,r=queries[i][1]+1;\n            if(l==r){\n                ans.push_back(1);\n            }else if((l==1) && (r==n)){\n                ans.push_back(pfx[n]);\n            }else{\n               \n                long long l1 = l-1,r1=r+1;\n                while(r1>l1+1){\n                    long long mid = (l1+r1)/2;\n                    if(ends[mid]>r){\n                        r1=mid;\n                    }else{\n                        l1=mid;\n                    }\n                }\n                int x = r1;\n                if(x==r+1){\n                    ans.push_back(pfx[r]-pfx[l-1]);\n                }else if(x==l){\n                    long long z = r-l+1;\n                    long long sum = ((z)*(z+1))/2;\n                    ans.push_back(sum);\n                }else{\n                    long long sum = pfx[x-1]-pfx[l-1];\n                    long long z = r-x+1;\n                    sum+=((z)*(z+1))/2;\n                    ans.push_back(sum);\n                } \n            }\n        }\n        \n        return ans;\n    }\n};",
    "submit_ts": "1723952125",
    "subm_id": "1359788518"
}