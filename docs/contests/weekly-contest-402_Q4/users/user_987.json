{
    "username": "Animmah",
    "submission": "class Solution {\npublic:\n    vector<int>bit;\n    int n;\n    int query(int idx) {\n        int res = 0;\n        while(idx>0){\n            res+=bit[idx];\n            idx-=idx&-idx;\n        }\n        return res;\n    }\n\n    int query(int l, int r) {\n        return query(r) - query(l - 1);\n    }\n\n    void add(int idx, int val) {\n        while(idx<=n){\n            bit[idx]+=val;\n            idx+=idx&-idx;\n        }\n    }\n    vector<int> countOfPeaks(vector<int>& v, vector<vector<int>>& q) {\n        n=v.size();\n        bit.resize(n+1);\n        vector<int>dif(n);\n        for(int i=1;i+1<n;i++){\n            if(v[i-1]<v[i] && v[i]>v[i+1])\n                add(i+1,1),dif[i]=1;\n        }\n        vector<int>ans;\n        for(auto i:q){\n            if(i[0] == 1){\n                int l=i[1]+1,r=i[2]+1;\n                if(l+1>r-1){\n                    ans.push_back(0);\n                }\n                else\n                ans.push_back(query(l+1,r-1));\n            }\n            else{\n                int idx=i[1],val=i[2];\n                if(dif[idx]){\n                    dif[idx]=0;\n                    add(idx+1,-1);\n                }\n                if(idx>0 && dif[idx-1]){\n                    add(idx,-1);\n                }\n                if(idx+1<n && dif[idx+1]){\n                    add(idx+2,-1);\n                }\n                \n                if(idx-1>=0 && idx+1<n &&v[idx-1]<val && val>v[idx+1]){\n                    dif[idx]=1;\n                    add(idx+1,1);\n                }\n                if(idx>0){\n                    if(idx-2>=0 &&v[idx-2]<v[idx-1] && v[idx-1]>val){\n                        add(idx,1);\n                        dif[idx-1]=1;\n                    }\n                    else dif[idx-1]=0;\n                }\n                if(idx<n-1){\n                    if(idx+2<n && v[idx+2]<v[idx+1] && v[idx+1]>val)\n                        add(idx+2,1),dif[idx+1]=1;\n                    else dif[idx+1]=0;\n                }\n                v[idx]=val;\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": 1718508039.0
}