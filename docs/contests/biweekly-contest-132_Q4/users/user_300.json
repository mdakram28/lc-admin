{
    "username": "CAEL0",
    "submission": "#include <bits/stdc++.h>\n#define sz size()\n#define bk back()\n#define fi first\n#define se second\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\n\nclass Solution {\n  public:\n    int maximumLength(vector<int> &v, int k) {\n        int n = v.sz;\n        vector<vector<int>> dp(k + 1, vector<int>(n));\n\n        for (int i = n - 1; i >= 0; i--) {\n            dp[0][i] = 1;\n\n            for (int j = i + 1; j < n; j++) {\n                if (v[i] == v[j]) {\n                    dp[0][i] = 1 + dp[0][j];\n                    break;\n                }\n            }\n        }\n\n        for (int kk = 1; kk <= k; kk++) {\n            vector<pii> w;\n            unordered_map<int, int> mp;\n\n            for (int i = n - 1; i >= 0; i--) {\n                if (w.sz >= 1 && w[0].se == v[i])\n                    w[0].fi = max(w[0].fi, dp[kk - 1][i]);\n                else if (w.sz >= 2 && w[1].se == v[i])\n                    w[1].fi = max(w[1].fi, dp[kk - 1][i]);\n                else\n                    w.push_back({dp[kk - 1][i], v[i]});\n\n                sort(w.begin(), w.end());\n                reverse(w.begin(), w.end());\n\n                if (w.sz == 3)\n                    w.pop_back();\n\n                dp[kk][i] = 1;\n\n                if (w[0].se != v[i])\n                    dp[kk][i] = max(dp[kk][i], 1 + w[0].fi);\n                else if (w.sz >= 2)\n                    dp[kk][i] = max(dp[kk][i], 1 + w[1].fi);\n\n                if (mp.count(v[i]))\n                    dp[kk][i] = max(dp[kk][i], 1 + dp[kk][mp[v[i]]]);\n\n                mp[v[i]] = i;\n            }\n        }\n\n        int ret = 0;\n        for (int i = 0; i < n; i++)\n            ret = max(ret, dp[k][i]);\n\n        return ret;\n    }\n};",
    "submit_ts": "1717860385",
    "subm_id": "1281755840"
}