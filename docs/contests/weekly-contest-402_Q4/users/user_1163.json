{
    "username": "nihao-54",
    "submission": "class Solution {\npublic:\n    vector<int> tr;\n    int n;\n    int lowbit(int x) {\n        return x & -x;\n    }\n\n    void add(int x, int c) {\n        for(int i = x; i <= n; i += lowbit(i)) tr[i] += c;\n    }\n\n    int sum(int x) {\n        int res = 0;\n        for(int i = x; i; i -= lowbit(i)) res += tr[i];\n        return res;\n    }\n\n    bool calc(vector<int>& a, int i) {\n        return i > 0 && i < n - 1 && a[i] > a[i - 1] && a[i] > a[i + 1];\n    }\n\n    vector<int> countOfPeaks(vector<int>& a, vector<vector<int>>& queries) {\n        n = a.size();\n        tr.resize(n + 1);\n        for (int i = 0; i < n; i++)\n            if (calc(a, i))\n                add(i + 1, 1);\n        vector<int> ans;\n        for (auto q : queries) {\n            int x = q[0], i = q[1], j = q[2];\n            if (x == 1) {\n                int r = 0;\n                if (calc(a, i)) r += 1;\n                if (i != j && calc(a, j)) r += 1;\n                ans.push_back(sum(j + 1) - sum(i) - r);\n            }\n            else {\n                bool r1 = 0, r2 = 0, r3 = 0;\n                if (calc(a, i)) r1 = 1;\n                if (calc(a, i - 1)) r2 = 1;\n                if (calc(a, i + 1)) r3 = 1;\n                a[i] = j;\n                if (r1 != calc(a, i)) add(i + 1, r1 ? -1 : 1);\n                if (r2 != calc(a, i - 1)) add(i, r2 ? -1 : 1);\n                if (r3 != calc(a, i + 1)) add(i + 2, r3 ? -1 : 1);\n            }\n        }\n        // for (int i = 1; i <= n; i++)\n        //     cout << i << ' ' << sum(i) << endl;\n        return ans;\n\n    }\n};",
    "submit_ts": 1718509400.0
}