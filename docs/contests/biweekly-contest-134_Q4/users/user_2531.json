{
    "username": "upceric",
    "submission": "class Solution {\npublic:\nusing ll=long long;\nstruct seg {\n        vector<ll> a,ln,rn;\n    ll mask=((ll)1<<60)-1;\n        ll cnt=0;\n        seg(ll n) {\n                a.resize(n*4+5,0); ln.resize(n*4+5,0); rn.resize(n*4+5,0); cnt=0;\n        }\n        void update(ll &v,ll l,ll r,ll p,ll val) {\n                if(v==0) v=++cnt;\n                if(l>p||r<p) return;\n                if(l==r) { a[v]=val; return; }\n                ll m=(l+r)>>1;\n                if(m>=p) update(ln[v],l,m,p,val);\n                else update(rn[v],m+1,r,p,val);\n                a[v]=a[ln[v]]&a[rn[v]];\n        }\n        ll q(ll v,ll l,ll r,ll left,ll right) {\n                if(v==0) return mask; if(left>right) return mask; if(l>right||r<left) return mask; if(l>=left && r<=right) return a[v];\n                ll m=(l+r)>>1; ll res=mask; if(m>=left) res=res&q(ln[v],l,m,left,right);\n                if(m<right) res=res&q(rn[v],m+1,r,left,right);\n                return res;\n        }\n};\nstatic const int logn = 21;\nstatic const int maxn = 200001;\nll f[maxn][logn + 1], Logn[maxn + 1];\nvoid pre() {  // \u51c6\u5907\u5de5\u4f5c\uff0c\u521d\u59cb\u5316\n  Logn[1] = 0;\n  Logn[2] = 1;\n  for (int i = 3; i < maxn; i++) {\n    Logn[i] = Logn[i / 2] + 1;\n  }\n}\n\n\n    long long countSubarrays(vector<int>& a, int k) {\n        //cout<<\"d\"<<endl;\n            int n=a.size();\n        for(int i=1;i<=n;i++) f[i][0]=a[i-1];\n        pre();\n  for (int j = 1; j <= logn; j++)\n    for (int i = 1; i + (1 << j) - 1 <= n; i++)\n      f[i][j] = f[i][j - 1] & f[i + (1 << (j - 1))][j - 1];  // ST\u8868\u5177\u4f53\u5b9e\u73b0\n        ll res=0;\n        cout<<\"ok\"<<endl;\n        for(int i=1;i<=n;i++) {\n            ll l=i,r=n;\n            while(l<r) {\n                ll m=(l+r)>>1;\n                ll x = i, y = m;\n                ll s = Logn[y - x + 1];\n                ll cur=f[x][s] & f[y - (1 << s) + 1][s];\n                if(cur>k) {\n                    l=m+1;\n                } else {\n                    r=m;\n                }\n            }\n            ll b2=l;\n            l=b2;r=n;\n            while(l<r) {\n                ll m=(l+r+1)>>1;\n                ll x = i, y = m;\n                ll s = Logn[y - x + 1];\n                ll cur=f[x][s] & f[y - (1 << s) + 1][s];\n                if(cur>=k) {\n                    l=m;\n                } else {\n                    r=m-1;\n                }\n            }\n            ll b1=l;\n            //cout<<i<<\" \"<<b1<<\" \"<<b2<<endl;\n                ll x = i, y = l;\n                ll s = Logn[y - x + 1];\n                ll cur=f[x][s] & f[y - (1 << s) + 1][s];\n            if(cur==k) {\n                res+=(b1-b2+1);\n            }\n        }\n        return res;\n        \n    }\n};",
    "submit_ts": "1720281516",
    "subm_id": "1311828030"
}