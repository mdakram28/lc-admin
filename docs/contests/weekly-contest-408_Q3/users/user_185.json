{
    "username": "hkmaxi",
    "submission": "#define ll long long\nclass Solution {\npublic:\n    int numberOfSubstrings(string s) {\n        ll n=s.size();\n        ll lim=sqrt(n)+5;\n        ll ans=0;\n        \n        vector<ll> nx_0(n,n),nx_1(n,n);\n        \n        for(ll i=n-1;i>=0;i--){\n            if(s[i]=='0'){\n                if(i+1<n and s[i+1]=='0'){\n                    nx_1[i]=nx_1[i+1];\n                }else if(i+1<n and s[i+1]=='1'){\n                    nx_1[i]=i+1;\n                }\n            }else{\n                if(i+1<n and s[i+1]=='1'){\n                    nx_0[i]=nx_0[i+1];\n                }else if(i+1<n and s[i+1]=='0'){\n                    nx_0[i]=i+1;\n                }\n            }            \n        }\n        \n        \n        \n        for(ll i=0;i<n;i++){\n            ll j=i,c0=0,c1=0;\n            while(j<n){\n                if(s[j]=='1'){\n                    ll lo=1,hi=nx_0[j]-j;\n                    ll r=hi+1;\n                    ll tot=hi;\n                    \n                    \n                    \n                    while(hi>=lo){\n                        ll mid=(hi+lo)/2ll;\n                        if(c1+mid>=c0*c0){\n                            r=min(r,mid);\n                            hi=mid-1;\n                        }else{\n                            lo=mid+1;\n                        }\n                    }\n                    \n                \n                    \n                    \n                    \n                    ans=ans+(tot-r+1);\n                    c1+=tot;\n                    j=nx_0[j];\n                    \n                \n                }else{\n                    \n                    ll lo=1,hi=nx_1[j]-j;\n                    ll tot=hi;\n                    ll r=0;\n                    \n                    while(hi>=lo){\n                        ll mid=(hi+lo)/2ll;\n                        if(c1>=(c0+mid)*(c0+mid)){\n                            r=max(r,mid);\n                            lo=mid+1;\n                        }else{\n                            hi=mid-1;\n                        }\n                    }\n                    \n                    ans=ans+r;\n                    c0+=tot;\n                    j=nx_1[j];\n                    \n                }\n                \n                \n                \n                if(c0>lim){\n                    break;\n                }\n            }\n        }\n        \n        \n        return ans;\n    }\n};",
    "submit_ts": "1722136276",
    "subm_id": "1335729266"
}