{
    "username": "ypsirK",
    "submission": "#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/pb_ds/tree_policy.hpp>\nusing namespace __gnu_pbds;\ntemplate<typename T> using pmultiset = tree<T,null_type,less_equal<T>,rb_tree_tag,tree_order_statistics_node_update>;\n\nclass Solution {\npublic:\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n        int n = nums.size();\n        vector<int> pre(n,0);\n        vector<int> ans;\n        for(int i = 1;i < n-1;i++){\n            pre[i] = (nums[i] > nums[i-1]) && (nums[i] > nums[i+1]);\n            pre[i] += pre[i-1];\n        }\n        pre[n-1] = pre[n-2];\n        pmultiset<int> wp,bp;\n        for(int i = 0;i < queries.size();i++){\n            int t = queries[i][0];\n            if(t == 1){\n                int l = queries[i][1],r = queries[i][2];\n                if(r <= l+1){\n                    ans.push_back(0);\n                    continue;\n                }\n                int c = pre[r-1]-pre[l];\n                //cout << c << \"\\n\";\n                int p2 = wp.order_of_key(r)-wp.order_of_key(l+1);\n                c -= p2;\n                //cout << p2 << \"\\n\";\n                p2 = bp.order_of_key(r)-bp.order_of_key(l+1);\n                c += p2;\n                //cout << p2 << \"\\n\";\n                ans.push_back(c);\n            }else{\n                int ind = queries[i][1],val = queries[i][2];\n                for(int j = ind-1;j <= ind+1;j++){\n                    if(j > 0 && j < n-1 && nums[j] > nums[j-1] && nums[j] > nums[j+1]){\n                  //      cout << \"w \" << j << \"\\n\";\n                        wp.insert(j);\n                    }   \n                }\n                nums[ind] = val;\n                for(int j = ind-1;j <= ind+1;j++){\n                    if(j > 0 && j < n-1 && nums[j] > nums[j-1] && nums[j] > nums[j+1]){\n                    //    cout << \"b \" << j << \"\\n\";\n                        bp.insert(j);\n                    }   \n                }\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": 1718508517.0
}