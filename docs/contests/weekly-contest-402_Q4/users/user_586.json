{
    "username": "bai-ci-2m",
    "submission": "const int N = 1e5 + 5;\nint c[N];\n\nvoid init(int n) {\n    memset(c, 0, sizeof(int) * (n + 1));\n}\n\nvoid add(int x, int k, int n) {\n    for (; x <= n; x += -x & x) c[x] += k;\n}\n\nint ask(int x) {\n    int ans = 0;\n    for (; x; x -= -x & x) ans += c[x];\n    return ans;\n}\n\nclass Solution {\npublic:\n    vector<int> countOfPeaks(vector<int>& a, vector<vector<int>>& q) {\n        int n = a.size();\n        init(n);\n        for (int i = 2; i < n; ++i) {\n            if (a[i - 1] > a[i - 2] && a[i - 1] > a[i]) add(i, 1, n);\n        }\n        vector<int> ans;\n        for (auto &p : q) {\n            if (p[0] == 1) {\n                if (p[2] - p[1] + 1 >= 3)\n                    ans.emplace_back(ask(p[2]) - ask(p[1] + 1));\n                else\n                    ans.emplace_back(0);\n            } else {\n                if (p[1] - 2 >= 0) {\n                    int k = 0;\n                    if (a[p[1] - 1] > a[p[1] - 2] && a[p[1] - 1] > a[p[1]]) --k;\n                    if (a[p[1] - 1] > a[p[1] - 2] && a[p[1] - 1] > p[2]) ++k;\n                    if (k) add(p[1], k, n);\n                    // cout << p[1] << ' ' << k << '\\n';\n                }\n                if (p[1] - 1 >= 0 && p[1] + 1 < n) {\n                    int k = 0;\n                    if (a[p[1]] > a[p[1] - 1] && a[p[1]] > a[p[1] + 1]) --k;\n                    if (p[2] > a[p[1] - 1] && p[2] > a[p[1] + 1]) ++k;\n                    if (k) add(p[1] + 1, k, n);\n                    // cout << p[1] + 1 << ' ' << k << '\\n';\n                }\n                if (p[1] + 2 < n) {\n                    int k = 0;\n                    if (a[p[1] + 1] > a[p[1]] && a[p[1] + 1] > a[p[1] + 2]) --k;\n                    if (a[p[1] + 1] > p[2] && a[p[1] + 1] > a[p[1] + 2]) ++k;\n                    if (k) add(p[1] + 2, k, n);\n                    // cout << p[1] + 2 << ' ' << k << '\\n';\n                }\n                a[p[1]] = p[2];\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": 1718507687.0
}