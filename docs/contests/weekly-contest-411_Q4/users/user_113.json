{
    "username": "Ujimatsu_Chiya",
    "submission": "\n# include <bits/stdc++.h>\n# define mem(a,b) memset(a,b,sizeof(a))\n# define lb(x) ((x) & -(x))\n# define pi pair<int,int>\n# define X first\n# define Y second\n# ifdef LOCAL\n# include \"leetcode.h\"\n# endif // LOCAL\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\nint dx[4]={-1,1,0,0},dy[4]={0,0,-1,1};\n\ntemplate<typename T>\nostream & operator << (ostream &out,const set<T>&obj){out<<\"set(\";for(auto it=obj.begin();it!=obj.end();it++) out<<(it==obj.begin()?\"\":\", \")<<*it;out<<\")\";return out;}\ntemplate<typename T>\nostream & operator << (ostream &out,const unordered_set<T>&obj){out<<\"unordered_set(\";for(auto it=obj.begin();it!=obj.end();it++) out<<(it==obj.begin()?\"\":\", \")<<*it;out<<\")\";return out;}\ntemplate<typename T1,typename T2>\nostream & operator << (ostream &out,const map<T1,T2>&obj){out<<\"map(\";for(auto it=obj.begin();it!=obj.end();it++) out<<(it==obj.begin()?\"\":\", \")<<it->first<<\": \"<<it->second;out<<\")\";return out;}\ntemplate<typename T1,typename T2>\nostream & operator << (ostream &out,const unordered_map<T1,T2>&obj){out<<\"unordered_map(\";for(auto it=obj.begin();it!=obj.end();it++) out<<(it==obj.begin()?\"\":\", \")<<it->first<<\": \"<<it->second;out<<\")\";return out;}\ntemplate<typename T1,typename T2>\nostream & operator << (ostream &out,const pair<T1,T2>&obj){out<<\"<\"<<obj.first<<\", \"<<obj.second<<\">\";return out;}\ntemplate<typename T>\nostream & operator << (ostream &out,const vector<T>&obj){out<<\"vector(\";for(auto it=obj.begin();it!=obj.end();it++) out<<(it==obj.begin()?\"\":\", \")<<*it;out<<\")\";return out;}\n\ntemplate <typename T>\nstruct HashTable {\n  vector<T> val;\n  void add(T x) { val.push_back(x); }\n  void init() {\n    sort(ALL(val));\n    val.erase(unique(ALL(val)), val.end());\n  }\n  int query(T x) { return lower_bound(ALL(val), x) - val.begin() + 1; }\n  T operator[](const int t) const { return val[t - 1]; }\n  int size() { return val.size(); }\n  void clear(){val.clear();}\n};\nll mod=1e9+7;\nvoid add(int &x, int y) {\n    (x += y) >= mod && (x -= mod);\n}\nvoid sub(int &x, int y) {\n    (x -= y) < 0 && (x += mod);\n}\n\n\nclass Solution {\npublic:\n    int s0[100004],s1[100004];\n    int mxr[100004];\n    ll ms[100004];\n    vector<long long> countKConstraintSubstrings(string s, int k, vector<vector<int>>& que) {\n        int n=s.size();\n        int q=que.size();\n        for(int i=0;i<n;i++){\n            s0[i+1]=s0[i]+(s[i]=='0');\n            s1[i+1]=s1[i]+(s[i]=='1');\n        }\n        for(int i=1,p=1;i<=n;i++){\n            while(p+1<=n&&(s0[p+1]-s0[i-1]<=k||s1[p+1]-s1[i-1]<=k)) ++p;\n            mxr[i]=p;\n            //printf(\"%d %d %d %d\\n\",i,mxr[i],s0[i],s1[i]);\n            ms[i]=ms[i-1]+mxr[i];\n        }\n        vector<ll>ans(q);\n        vector<vector<int>>ques;\n        for(int i=0;i<q;i++){\n            ques.push_back({que[i][1]+1,que[i][0]+1,i});\n        }\n        sort(ques.begin(),ques.end());\n        reverse(ques.begin(),ques.end());\n        int pos=n;\n        for(auto &qu:ques){\n            int r=qu[0],l=qu[1],id=qu[2];\n            ll val=0;\n            while(mxr[pos]>r) --pos;\n            if(pos>r) val=ms[r]-ms[l-1];\n            else val=ms[max(pos,l-1)]-ms[l-1]+1ll*r*(r-max(pos,l-1));\n            //cout<<l<<' ' << r << ' ' << pos<<' '<<val<<\"DD\"<<endl;\n            val-=1ll*(l+r)*(r-l+1)/2-(r-l+1);\n            ans[id]=val;\n        }\n        return ans;\n    }\n};\n",
    "submit_ts": "1723951373",
    "subm_id": "556405013"
}