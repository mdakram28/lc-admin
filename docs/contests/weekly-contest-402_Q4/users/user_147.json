{
    "username": "limausine",
    "submission": "struct bit {\n  int n;\n  vector<int> t;\n  bit(int _n) {\n    n=_n;\n    t.resize(n+20);\n  }\n  int qry(int i) {\n    int res=0;\n    for (; i; i-=i&-i) res+=t[i];\n    return res;\n  }\n    \n    int qry(int l, int r) {\n        return qry(r)-qry(l-1);\n    }\n\n  void upd(int i, int x) {\n    for (; i<=n; i+=i&-i) {\n      t[i]+=x;\n    }\n  }\n};\n\nconst int inf=2e9;\n\nclass Solution {\npublic:\n    vector<int> countOfPeaks(vector<int>& _a, vector<vector<int>>& Q) {\n        int n=_a.size();\n        vector<int> a(n+10);\n        for (int i=0; i<n; i++) {\n            a[i+1]=_a[i];\n        }\n        a[0]=inf;\n        a[n+1]=inf;\n        \n        bit bit(n);\n        for (int i=2; i<n; i++) {\n            if (a[i]>a[i-1]&&a[i]>a[i+1]) {\n                bit.upd(i,1);\n            }\n        }\n        \n        auto Print = [&]() {\n            for (int i=1; i<=n; i++) cout<<bit.qry(i,i)<<\" \";\n            cout<<endl;\n        };\n        \n        \n        \n        \n        \n        vector<int> ans;\n        for (auto qu: Q) {\n            if (qu[0]==1) {\n                int l=qu[1]+1;\n                int r=qu[2]+1;\n                int res=0;\n                if (r-l+1>=3) {\n                    res=bit.qry(l+1,r-1);\n                }\n                ans.push_back(res);\n            } else {\n                int idx=qu[1]+1;\n                int v=qu[2];\n                \n                for (int i: {idx-1,idx,idx+1}) {\n                    if (i<1 || i>n) continue;\n                    if (a[i]>a[i-1]&&a[i]>a[i+1]) {\n                        bit.upd(i,-1);\n                    }\n                }\n                \n                a[idx]=v;\n                for (int i: {idx-1,idx,idx+1}) {\n                    if (i<1 || i>n) continue;\n                    if (a[i]>a[i-1]&&a[i]>a[i+1]) {\n                        bit.upd(i,+1);\n                    }\n                }\n                \n                // Print();\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": 1718506250.0
}