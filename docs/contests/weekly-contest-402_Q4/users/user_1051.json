{
    "username": "wang-gan-yu",
    "submission": "class Solution {\n    int[] a;\n    int n;\n    int lowbit(int x) {\n        return x & -x;\n    }\n    //\u5355\u70b9\u66f4\u65b0\n    void update(int x, int num) {\n        for(int i = x; i <= n; i += lowbit(i)) {\n            a[i] += num;\n        }\n    }\n    //\u533a\u95f4\u67e5\u8be2\n    int query(int x) {\n        int res = 0;\n        for(int i = x; i > 0; i -= lowbit(i)) {\n            res += a[i];\n        }\n        return res;\n    }\n    public List<Integer> countOfPeaks(int[] nums, int[][] queries) {\n        //\u5cf0\u503c\u5143\u7d20\n        //\u6c42\u5cf0\u503c\u5143\u7d20\u7684\u6570\u76ee\n        //\u5c06nums[] \u53d8\u4e3a val\n        //\u6811\u72b6\u6570\u7ec4\n        n = nums.length;\n        a = new int[n + 1];\n        for(int i = 0; i < n; i ++ ) {\n            if(i >= 1 && i <= n - 2) {\n                if(nums[i - 1] < nums[i] && nums[i + 1] < nums[i]) {\n                    update(i + 1, 1);\n                }\n            }\n        }\n        List<Integer> ans = new ArrayList<>();\n        for(int[] q: queries) {\n            if(q[0] == 1) {\n                int l = q[1], r = q[2];\n                if(l == r) ans.add(0);\n                else\n                ans.add(query(r) - query(l + 1));\n            } else {\n                int index = q[1], val = q[2];\n                //\u5224\u65ad\u4e09\u4e2a\u70b9\u65f6\u5019\u6709\u66f4\u65b0\n                int or = nums[index];\n                for(int i = -1; i < 2; i ++ ) {\n                    if(index + i <= 0 || index + i >= n - 1) continue;\n                    int t1 = 0, t2 = 0;\n                    int to = index + i;\n                    if(nums[to - 1] < nums[to] && nums[to + 1] < nums[to]) {\n                        t1 = 1;\n                    }\n                    nums[index] = val;\n                    if(nums[to - 1] < nums[to] && nums[to + 1] < nums[to]) {\n                        t2 = 1;\n                    }\n                    if(t1 != t2) {\n                        update(to + 1, t2 - t1);\n                    }\n                    nums[index] = or;\n                }\n                nums[index] = val;\n            }\n        }\n        return ans;\n    }\n}",
    "submit_ts": 1718508812.0
}