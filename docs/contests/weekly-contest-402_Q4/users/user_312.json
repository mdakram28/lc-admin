{
    "username": "socrates1232",
    "submission": "class Solution {\n    int[] lt, vs, nums;\n    int n;\n    public void update(int t, int diff) {\n        int i = 1, l = 0, r = n - 1;\n        while(true) {\n            lt[i] += diff;\n            if(l == r) {\n                return;\n            }\n            int mid = (l + r) >> 1;\n            if(t <= mid) {\n                i <<= 1;\n                r = mid;\n            } else {\n                i = (i << 1) + 1;\n                l = mid + 1;\n            }\n        }\n    }\n    public int get(int i, int l, int r, int tl, int tr) {\n        if(tr < tl || tl > r || tr < l) {\n            return 0;\n        }\n        if(tl <= l && tr >= r) {\n            return lt[i];\n        }\n        int mid = (l + r) >> 1;\n        return get(i << 1, l, mid, tl, tr) + get((i << 1) | 1, mid + 1, r, tl, tr);\n    }\n    public void check(int x) {\n        if(x < 0 || x >= n) {\n            return;\n        }\n        int pre = vs[x];\n        if(x > 0 && x < n - 1 && nums[x] > nums[x - 1] && nums[x] > nums[x + 1]) {\n            vs[x] = 1;\n        } else {\n            vs[x] = 0;\n        }\n        if(vs[x] != pre) {\n            //System.out.println(x + \" \" + (vs[x] - pre));\n            update(x, vs[x] - pre);\n        }\n    }\n    public List<Integer> countOfPeaks(int[] nums1, int[][] queries) {\n        nums = nums1;\n        n = nums.length;\n        vs = new int[n];\n        lt = new int[(n << 2) + 3];\n        for(int i = 1; i < n - 1; i ++) {\n            if(nums[i] > nums[i - 1] && nums[i] > nums[i + 1]) {\n                vs[i] = 1;\n                update(i, 1);\n            }\n        }\n        List<Integer> ans = new ArrayList();\n        for(int[] q : queries) {\n            if(q[0] == 1) {\n                ans.add(get(1, 0, n - 1, q[1] + 1, q[2] - 1));\n            } else {\n                nums[q[1]] = q[2];\n                check(q[1]);\n                check(q[1] + 1);\n                check(q[1] - 1);\n            }\n        }\n        return ans;\n    }\n}",
    "submit_ts": 1718506760.0
}