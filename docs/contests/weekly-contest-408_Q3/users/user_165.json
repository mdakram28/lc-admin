{
    "username": "fsyun",
    "submission": "class Solution {\n    int f(int a, int b, int min) {\n        if (min < 0)\n            return (a + 1) * (b + 1);\n        if (a > b) {\n            int tmp = a;\n            a = b;\n            b = tmp;\n        }\n        if (a + b < min)\n            return 0;\n        if (b < min) {\n            int b1 = min - a, n = b - b1 + 1;\n            return (n + 1) * n / 2;\n        }\n        if (a < min) {\n            int b1 = min - a, n1 = b - b1 + 1, n0 = n1 - a;\n            return (n1 + n0) * (n1 - n0 + 1) / 2;\n        }\n        return (a - min + 1) * (b + 1) + (b * 2 - min + 1) * min / 2;\n    }\n    public int numberOfSubstrings(String s) {\n        char[] str = s.toCharArray();\n        int n = str.length;\n        int[] sum = new int[n + 1];\n        for (int i = 1; i <= n; i++)\n            sum[i] = sum[i - 1] + (str[i - 1] - '0');\n        int[] l0 = new int[n], r0 = new int[n];\n        int pos = -1;\n        pos = -1;\n        for (int i = 0; i < n; i++) {\n            l0[i] = pos;\n            if (str[i] == '0')\n                pos = i;\n        }\n        pos = n;\n        for (int i = n - 1; i >= 0; i--) {\n            r0[i] = pos;\n            if (str[i] == '0')\n                pos = i;\n        }\n        int ans = 0;\n        for (int c0 = 0; c0 * c0 + c0 <= n; c0++) {\n            //System.out.printf(\"c0 = %d\\n\", c0);\n            if (c0 == 0) {\n                int p = 0;\n                while (true) {\n                    while (p < n && str[p] == '0')\n                        p++;\n                    if (p == n)\n                        break;\n                    int q = p + 1;\n                    while (q < n && str[q] == '1')\n                        q++;\n                    int len = q - p;\n                    ans += len * (len + 1) / 2;\n                    //System.out.printf(\"add %d\\n\", len * (len + 1) / 2);\n                    p = q;\n                }\n            } else {\n                int p = str[0] == '0' ? 0 : r0[0];\n                if (p == n)\n                    break;\n                int cnt = 1, q = p;\n                while (cnt < c0) {\n                    q = r0[q];\n                    if (q == n)\n                        break;\n                    cnt++;\n                }\n                if (cnt < c0)\n                    break;\n                while (true) {\n                    int e = sum[q + 1] - sum[p];\n                    int a = p - l0[p] - 1, b = r0[q] - q - 1, min = c0 * c0 - e;\n                    //System.out.printf(\"p = %d, q = %d, a = %d, b = %d, e = %d, min = %d\\n\", p, q, a, b, e, min);\n                    ans += f(a, b, min);\n                    //System.out.printf(\"add %d\\n\", f(a, b, min));\n                    p = r0[p];\n                    q = r0[q];\n                    if (q == n)\n                        break;\n                }\n            }\n        }\n        return ans;\n    }\n}",
    "submit_ts": "1722138144",
    "subm_id": "1335783279"
}