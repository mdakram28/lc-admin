{
    "username": "niumingyang",
    "submission": "using ll = long long;\nclass Solution {\npublic:\n    vector<int> v;\n    vector<int> loc;\n    vector<vector<int>> pos;\n    int n;\n    ll ans;\n    // \u627e x \u4e2d\u7b2c\u4e00\u4e2a\u5927\u4e8e\u7b49\u4e8e y \u7684\u6570\uff0cn\u4ee3\u8868\u6ca1\u6709\u8fd9\u6837\u7684\u6570\n    int find_next(vector<int>& x, int y) {\n        if (x.size() == 0) return n;\n        int l = 0, r = x.size()-1;\n        while (l < r) {\n            int mid = (l+r) / 2;\n            if (x[mid] < y) {\n                l = mid + 1;\n            }\n            else if (x[mid] > y) {\n                r = mid;\n            }\n            else return x[mid];\n        }\n        if (x[l] < y) return n;\n        else return x[l];\n    }\n    long long countSubarrays(vector<int>& nums, int k) {\n        pos = vector<vector<int>>(32);\n        ans = 0;\n        v = nums;\n        n = v.size();\n        for (int i = 0; i < n; ++i) {\n            if ((nums[i] & k) != k)\n                loc.push_back(i);\n            else {\n                nums[i] -= k;\n                for (int j = 0; j < 32; ++j) {\n                    if ((nums[i] & (1<<j)) == 0) {\n                        pos[j].push_back(i);\n                    }\n                }\n            }\n        }\n        // for (int i = 0; i < 32; ++i) {\n        //     for (int j = 0; j < pos[i].size(); ++j) {\n        //         cout << pos[i][j] << ' ';\n        //     }\n        //     cout << endl;\n        // }\n        // for (int j = 0; j < loc.size(); ++j) {\n        //     cout << loc[j] << ' ';\n        // }\n        // cout << endl;\n        for (int i = 0; i < n; ++i) {\n            // cout << \"enter, i=\" << i << \"\\n\";\n            int last = find_next(loc, i);\n            if (last == i) {\n                continue;\n            }\n            // cout << last << endl;\n            int r = -1;\n            for (int j = 0; j < 32; ++j) {\n                int ret = find_next(pos[j], i);\n                r = max(r, ret);\n            }\n            // cout << r << endl;\n            if (r >= last) {\n                i = last;\n                continue;\n            }\n            // cout << r << endl;;\n            ans += (last-r);\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1720281250",
    "subm_id": "544575053"
}