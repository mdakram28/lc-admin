{
    "username": "yi-ming-1",
    "submission": "typedef long long ll;\ntypedef pair<int, int> pii;\nstatic constexpr int MAXN = 100005;\nstatic constexpr int INF = 0x3f3f3f3f;\nstatic constexpr int LIM = 10;\nstatic constexpr ll MOD = 1e9 + 7;\n\ninline int lowbit(int x) { return x & -x; }\n\nstruct BIT {\n    ll a[MAXN];\n    ll t1[MAXN], t2[MAXN];  // \u7ef4\u62a4\u533a\u95f4\u7684\u589e\u91cf (t1 \u7ef4\u62a4t[i] ,t2 \u7ef4\u62a4t[i] * i)\n    int n;\n    inline void init(int _n) {\n        n = _n;\n        for (int i = 1; i <= n; i++) a[i] = t1[i] = t2[i] = 0;\n    }\n\n    inline ll ask(int x) {  // \u8be2\u95ee\u70b9 x \u7684\u503c\n        ll ans = a[x];\n        for (int i = x; i; i -= lowbit(i)) ans += (x + 1) * t1[i] - t2[i];\n        return ans;\n    }\n    inline void add(int x, ll k) {  // \u70b9 x \u7684\u589e\u91cf +k\n        for (int i = x; i <= n; i += lowbit(i)) t1[i] += k, t2[i] += x * k;\n    }\n    inline void modify(int l, ll k) {  // \u533a\u95f4\u4fee\u6539\n        add(l, k);\n        add(l + 1, -k);\n    }\n    inline ll query(int l, int r) {  // \u533a\u95f4\u6c42\u548c\n        if (l > r)  return 0;\n        return ask(r) - ask(l - 1);\n    }\n} fff;\n\ninline bool pk(int pos, vector<int>& a) {\n    return a[pos] > a[pos - 1] && a[pos] > a[pos + 1];\n}\n\nclass Solution {\n    public:\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n        int n = nums.size();\n        vector<int> val(n + 5);\n        for (int i = 0; i < n; i ++) {\n            val[i + 1] = nums[i];\n        }\n        fff.init(n);\n        for (int i = 2; i < n; i ++) {\n            if (pk(i, val)) {\n                fff.modify(i, 1);\n            }\n        }\n        vector<int> ans;\n        for (auto& q : queries) {\n            int opt = q[0], l = q[1], r = q[2];\n            if (opt == 1) {\n                l++, r++;\n                cout << l + 1 << \" \" << r - 1 << \"\\n\";\n                ans.emplace_back(fff.query(l + 1, r - 1));\n            } else {\n                l ++;\n                if (l - 1 >= 2 && pk(l - 1, val)) {\n                    fff.modify(l - 1, -1);\n                }\n                if (l + 1 < n && pk(l + 1, val)) {\n                    fff.modify(l + 1, -1);\n                }\n                if (2 <= l && l < n && pk(l, val)) {\n                    fff.modify(l, -1);\n                }\n                val[l] = r;\n                if (l - 1 >= 2 && pk(l - 1, val)) {\n                    fff.modify(l - 1, 1);\n                }\n                if (l + 1 < n && pk(l + 1, val)) {\n                    fff.modify(l + 1, 1);\n                }\n                if (2 <= l && l < n && pk(l, val)) {\n                    fff.modify(l, 1);\n                }\n            }\n        }\n        return ans;\n    }\n};\n",
    "submit_ts": 1718509083.0
}