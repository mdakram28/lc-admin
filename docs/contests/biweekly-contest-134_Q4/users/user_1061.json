{
    "username": "iamonborderline",
    "submission": "class Solution {\npublic:\n    #define ll long long\n    ll dp[100005][32];\n    bool isvalid(ll l,ll hi,ll k){\n        ll ans=0;\n        for(ll i=0;i<32;i++){\n            ll a=dp[hi][i];\n            ll b=(l-1>=0 ? dp[l-1][i] : 0);\n            ll between=a-b;\n            if(hi-l+1==between){\n                ans|=(1<<i);\n            }\n        }\n        // cout<<l<<\" \"<<hi<<\" \"<<ans<<endl;\n        // cout<<ans<<endl;\n        return ans<k;\n    }\n    ll cntsubarrays(vector<int>&nums,int k){\n        ll cnt=0;\n        \n        for(ll i=0;i<nums.size();i++){\n            ll l=i;\n            ll hi=nums.size()-1;\n            ll ans=-1;\n            while(l<=hi){\n                ll mid=l+(hi-l)/2;\n                if(isvalid(i,mid,k)){\n                    ans=mid;\n                    \n                    hi=mid-1;\n                }\n                else{\n                    l=mid+1;\n                }\n        \n            }\n            cnt+=(ans==-1 ? 0 : (nums.size()-ans));\n        }\n        return cnt;\n        \n    }\n    long long countSubarrays(vector<int>& nums, int k) {\n        memset(dp,0,sizeof dp);\n        \n        for(int i=0;i<nums.size();i++){\n            for(int j=0;j<32;j++){\n                ll num=nums[i];\n                if(num&(1<<j)){\n                    dp[i][j]=1+(i-1>=0 ? dp[i-1][j] : 0);\n                    \n\n\n                }\n                else{\n                    dp[i][j]=(i-1>=0 ? dp[i-1][j] :0);\n                    \n                    \n                }\n            }\n            \n        }\n        \n        ll b=cntsubarrays(nums,k+1);\n        ll c=cntsubarrays(nums,k);\n        \n        return b-c;\n        \n        \n    }\n};",
    "submit_ts": "1720280282",
    "subm_id": "1311783606"
}