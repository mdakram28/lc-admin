{
    "username": "Lucky7",
    "submission": "class Solution {\npublic:\n    #define ll long long\n\tvector <ll> R,pre;\n\n    vector<long long> countKConstraintSubstrings(string s, int k, vector<vector<int>>& queries) {\n        int n=s.size();\n\t\tR.resize(n);\n\t\tpre.resize(n);\n\t\tint c0=0,c1=0;\n\t\tint r=0;\n\t\tfor(int i=0;i<n;i++){\n\t\t\twhile(r<n ){\n                int t0=0,t1=0;\n                if(s[r]=='0') t0=1;\n                else t1=1;\n\n\t\t\t\tif(c0+t0<=k || c1+t1<=k) r++,c0+=t0,c1+=t1;\n                else break;\n\t\t\t}\n            // cout<<i<<\" \"<<r<<endl;\n\t\t\tR[i]=r;\n\t\t\tif(s[i]=='0') c0--;\n\t\t\telse c1--;\n\t\t}\n\t\tpre[0]=R[0];\n\t\tfor(int i=1;i<n;i++) pre[i]=pre[i-1]+R[i];\n\n\t\tvector <ll> ans;\n\t\tfor(auto j:queries){\n\t\t\tint l=j[0],r=j[1];\n\t\t\tll sum=pre[r]-(l? pre[l-1]:0);\n\t\t\tsum-=1LL*(l+r)*(r-l+1)/2;\n            // cout<<sum<<endl;\n\n            int L=l,rr=r+1,mid;\n            while(L<rr){\n                mid=(L+rr)>>1;\n                if(R[mid]>r+1) rr=mid;\n                else L=mid+1;\n            }\n            int p=L;\n            \n\t\t\tif(p<=r){\n\t\t\t\tll t=pre[r]-(p ?pre[p-1]:0);\n\t\t\t\tt-=1LL*(r-p+1)*(r+1);\n                sum-=t;\n\t\t\t}\n\t\t\t\n\t\t\tans.push_back(sum);\n\t\t}\n        return ans;\n    }\n};",
    "submit_ts": "1723949889",
    "subm_id": "556395625"
}