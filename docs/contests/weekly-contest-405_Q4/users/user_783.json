{
    "username": "uwi",
    "submission": "\tclass Solution {\n\t\tpublic int minimumCost(String target, String[] words, int[] costs) {\n\t\t\tint n = target.length();\n\t\t\tRollingHash61 rh = new RollingHash61(31, n);\n\t\t\tfor(int i = 0;i < n;i++){\n\t\t\t\trh.add(target.charAt(i));\n\t\t\t}\n\t\t\tint m = words.length;\n\t\t\tMap<Integer, Map<Long, Integer>> cs = new HashMap<>();\n\t\t\tfor(int i = 0;i < m;i++){\n\t\t\t\tString w = words[i];\n\t\t\t\tint u = w.length();\n\t\t\t\tlong hh = 0;\n\t\t\t\tfor(int j = 0;j < u;j++){\n\t\t\t\t\thh = hh * 31 + words[i].charAt(j);\n\t\t\t\t}\n\t\t\t\tif(!cs.containsKey(u)){\n\t\t\t\t\tcs.put(u, new HashMap<>());\n\t\t\t\t}\n\t\t\t\tcs.get(u).put(hh, Math.min(cs.get(u).getOrDefault(hh, Integer.MAX_VALUE), costs[i]));\n\t\t\t}\n\n\t\t\tint[] dp = new int[n+1];\n\t\t\tArrays.fill(dp, Integer.MAX_VALUE / 2);\n\t\t\tdp[0] = 0;\n\t\t\tfor(int i = 1;i <= n;i++){\n\t\t\t\tfor(int k : cs.keySet()){\n\t\t\t\t\tif(i-k >= 0){\n\t\t\t\t\t\tlong hh = rh.h(i-k, i);\n\t\t\t\t\t\tdp[i] = Math.min(dp[i], dp[i-k] + cs.get(k).getOrDefault(hh, Integer.MAX_VALUE / 2));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn dp[n] >= Integer.MAX_VALUE / 2 ? -1 : dp[n];\n\t\t}\n\n\t\tpublic static long[] pows = makePows(31, 55000);\n\n\t\tprivate static long[] makePows(long M, int n)\n\t\t{\n\t\t\tlong[] ret = new long[n+1];\n\t\t\tret[0] = 1;\n\t\t\tfor(int i = 1;i <= n;i++)ret[i] = mul(ret[i-1], M);\n\t\t\treturn ret;\n\t\t}\n\n\t\tpublic static long mul(long a, long b)\n\t\t{\n\t\t\treturn a*b;\n\t\t}\n\n\t\tpublic static class RollingHash61\n\t\t{\n\t\t\tpublic long M;\n\t\t\tpublic long[] hs;\n\t\t\tpublic int hp;\n\n\t\t\tpublic RollingHash61(long M, int n) {\n\t\t\t\tassert M > 0;\n\t\t\t\tassert n > 0;\n\t\t\t\tthis.M = M;\n\t\t\t\tthis.hs = new long[n+1];\n\t\t\t\tthis.hp = 0;\n\t\t\t}\n\n\t\t\tpublic void add(long x)\n\t\t\t{\n\t\t\t\ths[hp+1] = mul(hs[hp], M) + x;\n\t\t\t\thp++;\n\t\t\t}\n\n\t\t\tpublic long h(int l, int r)\n\t\t\t{\n\t\t\t\tassert l <= r;\n\t\t\t\treturn hs[r] - mul(hs[l], pows[r-l]);\n\t\t\t}\n\t\t}\n\n\t}\n",
    "submit_ts": "1720321680",
    "subm_id": "1312329447"
}