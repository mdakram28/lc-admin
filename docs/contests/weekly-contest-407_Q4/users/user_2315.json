{
    "username": "testimony2014",
    "submission": "using LL = long long;\nclass Solution {\npublic:\n    LL minimumOperations(vector<int>& nums, vector<int>& target) {\n        int n = nums.size();\n        vector<int> diff(n);\n        for (int i = 0; i < n; ++i) {\n            diff[i] = nums[i] - target[i];\n        }\n        \n        LL res = 0;\n        int head = 0;\n        for (int i = 0; i <= n; ++i) {\n            if (i == n || diff[i] == 0 || diff[head] == 0 || (diff[head] < 0) != (diff[i] < 0)) {\n                res += getSteps(diff, head, i);\n                head = i;\n            }\n        }\n        return res;\n    }\nprivate:\n    LL getSteps(vector<int> &diff, int head, int end) {\n        if (diff[head] == 0) {\n            return 0;\n        }\n        \n        for (int i = head; i < end; ++i) {\n            diff[i] = abs(diff[i]);\n        }\n        \n        vector<int> right(end - head);\n        stack<int> st;\n        for (int i = head; i <= end; ++i) {\n            while (!st.empty() && (i == end || diff[st.top()] > diff[i])) {\n                right[st.top() - head] = i;\n                st.pop();\n            }\n            st.push(i);\n        }\n        \n        st = stack<int>();\n        vector<int> left(end - head);\n        for (int i = end - 1; i >= head - 1; --i) {\n            while (!st.empty() && (i == head - 1 || diff[st.top()] >= diff[i])) {\n                left[st.top() - head] = i;\n                st.pop();\n            }\n            st.push(i);\n        }\n        \n        LL res = 0;\n        for (int i = head; i < end; ++i) {\n            if (left[i - head] >= head && diff[left[i - head]] == diff[i]) {\n                continue;\n            }\n            \n            LL decrease = diff[i];\n            if (left[i - head] >= head) {\n                decrease = min(decrease, abs((LL)diff[i] - diff[left[i - head]]));\n            }\n            if (right[i - head] < end) {\n                decrease = min(decrease, abs((LL)diff[i] - diff[right[i - head]]));\n            }\n            res += decrease;\n        }\n        return res;\n    }\n};",
    "submit_ts": "1721533931",
    "subm_id": "1328019861"
}