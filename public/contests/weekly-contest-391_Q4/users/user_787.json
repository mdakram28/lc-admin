{
    "username": "chuan-chih",
    "submission": "class Solution:\n    def minimumDistance(self, points: List[List[int]]) -> int:\n        min_sum = max_sum = sum(points[0])\n        min_max_sum = [min_sum, max_sum]\n        x, y = points[0]\n        min_diff = max_diff = x - y\n        min_max_diff = [min_diff, max_diff]\n        min_sum_i = [0]\n        max_sum_i = [0]\n        min_diff_i = [0]\n        max_diff_i = [0]\n        n = len(points)\n        \n        def update(curr, low_high, low_i, high_i):\n            low, high = low_high\n            if curr < low:\n                low = curr\n                low_i.clear()\n            if curr == low:\n                low_i.append(i)\n            if curr > high:\n                high = curr\n                high_i.clear()\n            if curr == high:\n                high_i.append(i)\n            low_high[:] = low, high\n        \n        for i in range(1, n):\n            x, y = points[i]\n            update(x + y, min_max_sum, min_sum_i, max_sum_i)\n            update(x - y, min_max_diff, min_diff_i, max_diff_i)\n        # print(min_sum_i, max_sum_i)\n        # print(min_diff_i, max_diff_i)\n        \n        sum_dist, diff_dist = (min_max_sum[1] - min_max_sum[0], min_max_diff[1] - min_max_diff[0])\n        \n        # print(sum_dist, diff_dist)\n        \n        indices = []\n        \n        if sum_dist > diff_dist:\n            if len(min_sum_i) == 1:\n                indices.append(min_sum_i.pop())\n            if len(max_sum_i) == 1:\n                indices.append(max_sum_i.pop())\n        elif diff_dist > sum_dist:\n            if len(min_diff_i) == 1:\n                indices.append(min_diff_i.pop())\n            if len(max_diff_i) == 1:\n                indices.append(max_diff_i.pop())\n        else:\n            if len(min_sum_i) == 1:\n                indices.append(min_sum_i.pop())\n            if len(max_sum_i) == 1:\n                indices.append(max_sum_i.pop())\n            diff_i = []\n            if len(min_diff_i) == 1:\n                diff_i.append(min_diff_i.pop())\n            if len(max_diff_i) == 1:\n                diff_i.append(max_diff_i.pop())\n            indices = set(indices) & set(diff_i)\n        \n        if not indices:\n            return max(sum_dist, diff_dist)\n        \n        def max_dist(ii):\n            min_max_sum = [math.inf, -math.inf]\n            min_max_diff = [math.inf, -math.inf]\n            for i in range(n):\n                if i != ii:\n                    x, y = points[i]\n                    curr = x + y\n                    if curr < min_max_sum[0]:\n                        min_max_sum[0] = curr\n                    if curr > min_max_sum[1]:\n                        min_max_sum[1] = curr\n                    curr = x - y\n                    if curr < min_max_diff[0]:\n                        min_max_diff[0] = curr\n                    if curr > min_max_diff[1]:\n                        min_max_diff[1] = curr\n            return max(min_max_sum[1] - min_max_sum[0], min_max_diff[1] - min_max_diff[0])\n            \n        # print(indices)\n        return min(max_dist(i) for i in indices)\n            \n            "
}