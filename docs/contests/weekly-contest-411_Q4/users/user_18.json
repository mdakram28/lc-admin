{
    "username": "Zhan Kurbanbayev",
    "submission": "/// In The Name Of God\n \n#include <bits/stdc++.h>\n \n#define f first\n#define s second\n \n#define pb push_back\n#define pp pop_back\n#define mp make_pair\n \n#define sz(x) (int)x.size()\n#define sqr(x) ((x) * 1ll * (x))\n#define all(x) x.begin(), x.end()\n \n#define rep(i, l, r) for (int i = (l); i <= (r); i++)\n#define per(i, l, r) for (int i = (l); i >= (r); i--)\n \n#define Kazakhstan ios_base :: sync_with_stdio(0), cin.tie(0), cout.tie(0);\n \n#define nl '\\n'\n#define ioi exit(0);\n \ntypedef long long ll;\ntypedef long double ld;\ntypedef unsigned long long ull;\n \nconst int N = (int)5e5 + 7;\nconst int inf = (int)1e9 + 7;\nconst int mod = (int)1e9 + 7;\nconst ll linf = (ll)1e18 + 7;\n \nconst int dx[] = {-1, 0, 1, 0, 1, -1, -1, 1};\nconst int dy[] = {0, 1, 0, -1, 1, -1, 1, -1};\n \nusing namespace std;\n\n\nclass Solution {\npublic:\n    ll get(ll r) {\n        return r * (r + 1) / 2;\n    }\n    ll sum(ll l, ll r) {\n        return get(r) - get(l - 1);\n    }\n    vector<long long> countKConstraintSubstrings(string s, int k, vector<vector<int>>& queries) {\n        int n = sz(s);\n        vector<ll> nxt(n, 0);\n        vector<ll> pref(n, 0);\n        {\n            int r = n - 1;\n            int c0 = 0, c1 = 0;\n            per(i, n - 1, 0) {\n                if (s[i] == '0') c0++;\n                else c1++;\n                \n                while (min(c0, c1) > k) {\n                    if (s[r] == '0') c0--;\n                    else c1--;\n                    r--;\n                }\n\n                nxt[i] = r;\n            }      \n            rep(i, 0, n - 1) {\n                pref[i] = nxt[i];\n                if (i) pref[i] += pref[i - 1];\n            } \n        }\n        \n        vector<ll> ans;\n\n        for (auto it : queries) {\n            ll x = it[0], y = it[1];\n            ll l = x, r = y, pos = x - 1;\n            while (l <= r) {\n                int mid = l + r >> 1;\n                if (nxt[mid] <= y) pos = mid, l = mid + 1;\n                else r = mid - 1;\n            }\n            ll res = 0;\n            // rep(i, x, y) {\n            //     res += min(nxt[i], y) - i + 1;\n            // }\n            // ans.pb(res);\n            // continue;\n\n            if (pos >= x) {\n                res += pref[pos];\n                if (x) res -= pref[x - 1];\n            }\n            res += (y - pos) * y;\n            res += y - x + 1;\n            res -= sum(x, y);\n\n            ans.pb(res);\n        }\n        return ans;\n    }\n};\n\n\n/*\n    rep(i, l, r) {\n        ans += min(nxt[i], r) - i + 1;\n    }\n\n*/",
    "submit_ts": "1723950532",
    "subm_id": "1359748406"
}