{
    "username": "gonglinyuan",
    "submission": "def calc_is_peak(a, n, i):\n    return (i > 0 and i + 1 < n and a[i] > a[i - 1] and a[i] > a[i + 1])\n\n\nclass BIT:\n    def __init__(self, n):\n        self.n = n\n        self.tree = [0] * (n + 1)\n\n    def update(self, idx, delta):\n        \"\"\" Update the value at index idx by adding delta \"\"\"\n        while idx <= self.n:\n            self.tree[idx] += delta\n            idx += idx & -idx\n\n    def query(self, idx):\n        \"\"\" Query the prefix sum from index 1 to idx \"\"\"\n        sum_ = 0\n        while idx > 0:\n            sum_ += self.tree[idx]\n            idx -= idx & -idx\n        return sum_\n\n    def range_query(self, l, r):\n        \"\"\" Query the sum from index l to r \"\"\"\n        return self.query(r) - self.query(l - 1)\n\n# Example usage\n# bit = BIT(10)  # Initialize a BIT for an array of size 10\n# bit.update(1, 5)  # Add 5 to index 1\n# bit.update(3, 8)  # Add 8 to index 3\n# bit.update(6, 7)  # Add 7 to index 6\n# print(bit.range_query(1, 3))\n\nclass Solution:\n    def countOfPeaks(self, a: List[int], queries: List[List[int]]) -> List[int]:\n        n = len(a)\n        is_peak = [calc_is_peak(a, n, i) for i in range(n)]\n        tree = BIT(n)\n        for i in range(n):\n            if is_peak[i]:\n                tree.update(i + 1, 1)\n        ans = []\n        for op, o1, o2 in queries:\n            if op == 1:\n                # print(is_peak)\n                r = tree.range_query(o1 + 1, o2 + 1)\n                r -= int(is_peak[o1]) + int(is_peak[o2])\n                if is_peak[o1] and o1 == o2:\n                    r += 1\n                ans.append(r)\n            elif op == 2:\n                a[o1] = o2\n                for j in range(o1 - 1, o1 + 2):\n                    if 0 <= j < n:\n                        new_is_peak = calc_is_peak(a, n ,j)\n                        tree.update(j + 1, int(new_is_peak) - (is_peak[j]))\n                        is_peak[j] = new_is_peak\n        return ans\n            ",
    "submit_ts": 1718506943.0
}