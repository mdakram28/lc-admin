{
    "username": "Chasey",
    "submission": "#define ll long long\n#define REP(i,n)        FOR(i,0,n)\n#define SORT(v)         sort((v).begin(),(v).end())\n#define FOR(i,a,b)      for(ll i=(a);i<(b);i++)\n\n#define ll long long\n#define REP(i,n)        FOR(i,0,n)\n#define SORT(v)         sort((v).begin(),(v).end())\n#define FOR(i,a,b)      for(ll i=(a);i<(b);i++)\n\nclass Solution {\npublic:\n    ll calc(ll from, ll to, vector<vector<ll>>& pref) {\n        ll res = 0;\n        REP(j, 32) if (pref[to+1][j] - pref[from][j] == to-from+1) res |= (1<<j);\n        return res;\n    }\n\n    long long countSubarrays(vector<int>& nums, int k) {\n        ll n = nums.size();\n        vector<vector<ll>> pref(n+1, vector<ll>(32, 0));\n        REP(i, n) {\n            REP(j, 32) pref[i+1][j] = pref[i][j];\n            REP(j, 32) if (nums[i] & (1<<j)) pref[i+1][j]++;\n        }\n\n        vector<ll> v(n, 0); REP(i, n) if ((nums[i] & k) == k) v[i] = 1;\n        vector<ll> len(n+1, 0); \n        for (ll i = n-1; i >= 0; i--) if (v[i] == 1) len[i] = 1 + len[i+1];\n\n        ll res = 0;\n        REP(i, n) {\n            if (v[i] == 0) continue;\n            if (nums[i] == k) { res += len[i]; continue; }\n            ll l = i; ll h = i+len[i]-1; if (calc(i, h, pref) > k) continue;\n            while (l < h) {\n                ll m = (l+h)/2;\n                calc(i, m, pref) == k ? h = m : l = m+1;\n            }\n            res += (i+len[i]-1 - l + 1);\n        }\n        return res;\n    }\n};",
    "submit_ts": "1720278487",
    "subm_id": "1311711301"
}