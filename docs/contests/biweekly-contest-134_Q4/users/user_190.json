{
    "username": "lucifer357",
    "submission": "typedef long long ll;\n\nstruct node{\n    ll ad;\n};\n\nnode combine(node n1 , node n2){\n    node n3;\n    n3.ad = (n1.ad&n2.ad);\n\n    return n3;\n}\n\nconst ll SZ = 1e6;\nll inf;\n\nvector<node> sgt(SZ);\n\nvoid build(ll v , ll tl , ll tr , vector<int> &a){\n    if(tl == tr){\n        sgt[v].ad = a[tl];\n    }\n    else{\n        ll tm = (tl + tr)>>1;\n\n        build(2*v , tl , tm , a);\n        build(2*v + 1 , tm + 1 , tr , a);\n\n        sgt[v] = combine(sgt[2*v] , sgt[2*v+1]);\n    }\n}\n\nll query(ll v ,ll tl ,ll tr ,ll l , ll r){\n    if(l > r) return inf;\n\n    if(tl == l && tr == r){\n        return sgt[v].ad;\n    }\n    ll tm = (tl + tr)>>1;\n\n    ll num1 = query(2*v , tl , tm , l , min(tm , r));\n    ll num2 = query(2*v + 1 , tm+1 , tr , max(l , tm + 1) , r);\n\n    return (num1&num2);\n}\n\n\nclass Solution {\npublic:\n    long long countSubarrays(vector<int>& a, int k) {\n        sgt.clear();\n        ll n = a.size();\n        sgt.resize(6*n + 50);\n\n        inf = (1LL<<40) - 1;\n\n        build(1 , 0 , n-1 , a);\n\n        ll ans = 0;\n\n        for(ll i = 0 ; i < n ; i++){\n            if(a[i] < k) continue;\n\n\n            ll mini = i , maxi = i-1;\n\n            ll low = i , high = n-1;\n\n            while(low <= high){\n                ll mid = (low + high)>>1;\n\n                ll num = query(1 , 0 , n-1 , i , mid);\n                if(num == k){\n                    mini = mid;\n                    high = mid-1;\n                    continue;\n                }\n                if(num > k && num != inf){\n                    low = mid+1;\n                }\n                else{\n                    high = mid-1;\n                }\n            }\n\n            low = i ;\n            high = n-1;\n\n            while(low <= high){\n                ll mid = (low + high)>>1;\n\n                ll num = query(1 , 0 , n-1 , i , mid);\n                if(num == k){\n                    maxi = mid;\n                    low = mid+1;\n                    continue;\n                }\n                if(num > k && num != inf){\n                    low = mid+1;\n                }\n                else{\n                    high = mid-1;\n                }\n            }\n\n            ans += (maxi - mini + 1);\n        }\n\n        return ans;\n    }\n};",
    "submit_ts": "1720277980",
    "subm_id": "1311688837"
}