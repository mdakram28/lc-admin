{
    "username": "kzyKT",
    "submission": "#define F first\n#define S second\n#define R cin>>\n#define ll long long\n#define ln cout<<'\\n'\n#define in(a) insert(a)\n#define pb(a) push_back(a)\n#define pd(a) printf(\"%.10f\\n\",a)\n#define mem(a) memset(a,0,sizeof(a))\n#define all(c) (c).begin(),(c).end()\n#define iter(c) __typeof((c).begin())\n#define rrep(i,n) for(ll i=(ll)(n)-1;i>=0;i--)\n#define REP(i,m,n) for(ll i=(ll)(m);i<(ll)(n);i++)\n#define rep(i,n) REP(i,0,n)\n#define tr(it,c) for(iter(c) it=(c).begin();it!=(c).end();it++)\nll check(ll n,ll m,ll x,ll y){return x>=0&&x<n&&y>=0&&y<m;}void pr(){ln;}\ntemplate<class A,class...B>void pr(const A &a,const B&...b){cout<<a<<(sizeof...(b)?\" \":\"\");pr(b...);}\ntemplate<class A>void PR(A a,ll n){rep(i,n){if(i)cout<<' ';cout<<a[i];}ln;}\nconst ll MAX=1e9+7,MAXL=1LL<<61,dx[8]={-1,0,1,0,-1,-1,1,1},dy[8]={0,1,0,-1,-1,1,1,-1};\ntypedef pair<ll,ll> P;\n\nint n;\nvector<P> v[222222];\n\nint d[222222];\n\nP dfs(int x,int t) {\n  d[x]=t;P p=P(d[x],x);\n  rep(i,v[x].size())if(d[v[x][i].F]==MAX)p=max(p,dfs(v[x][i].F,t+1));\n  return p;\n}\n\nP calc(ll n) {\n  fill(d,d+n,MAX);P p=dfs(0,0);\n  fill(d,d+n,MAX);P q=dfs(p.S,0);\n  return P(p.S,q.S);\n}\n\nint c[2][222222];\n\nvoid bfs(int s,int k) {\n  fill(c[k],c[k]+n,MAX);\n  c[k][s]=0;\n  queue<ll> que;\n  que.push(s);\n  while(!que.empty()) {\n    ll x=que.front();que.pop();\n    rep(i,v[x].size()) {\n      ll y=v[x][i].F;\n      if(c[k][y]!=MAX) continue;\n      c[k][y]=c[k][x]+1;\n      que.push(y);\n    }\n  }\n}\nvector<ll> calc2(P p) {\n  bfs(p.F,0);\n  bfs(p.S,1);\n  vector<ll> a;\n  ll M=MAX;\n  rep(i,n) {\n    ll M2=max(c[0][i],c[1][i]);\n    if(M2<M) {\n      a.clear();\n      a.pb(i);\n      M=M2;\n    } else if(M2==M) a.pb(i);\n  }\n  return a;\n}\n\nclass Solution {\npublic:\n  int minimumDiameterAfterMerge(vector<vector<int>>& e1, vector<vector<int>>& e2) {\n    int ans=0;\n    vector<ll> a,b;\n    n=e1.size()+1;\n    rep(i,n) v[i].clear();\n    rep(i,e1.size()) {\n      v[e1[i][0]].pb(P(e1[i][1],-1));\n      v[e1[i][1]].pb(P(e1[i][0],-1));\n    }\n    {\n      P p=calc(n);\n      a=calc2(p);\n      ans=max(ans,d[p.S]+1);\n    }\n    n=e2.size()+1;\n    rep(i,n) v[i].clear();\n    rep(i,e2.size()) {\n      v[e2[i][0]].pb(P(e2[i][1],-1));\n      v[e2[i][1]].pb(P(e2[i][0],-1));\n    }\n    {\n      P p=calc(n);\n      b=calc2(p);\n      ans=max(ans,d[p.S]+1);\n    }\n    if(a.size()==2&&b.size()==2) ans++;\n    n=e1.size()+1;\n    rep(i,e2.size()) {\n      e2[i][0]+=n;\n      e2[i][1]+=n;\n    }\n    rep(i,b.size()) b[i]+=n;\n    n+=e2.size()+1;\n    rep(x,a.size()) {\n      rep(y,b.size()) {\n        rep(i,n) v[i].clear();\n        rep(i,e1.size()) {\n          v[e1[i][0]].pb(P(e1[i][1],-1));\n          v[e1[i][1]].pb(P(e1[i][0],-1));\n        }\n        rep(i,e2.size()) {\n          v[e2[i][0]].pb(P(e2[i][1],-1));\n          v[e2[i][1]].pb(P(e2[i][0],-1));\n        }\n        v[a[x]].pb(P(b[y],-1));\n        v[b[y]].pb(P(a[x],-1));\n        P p=calc(n);\n        ans=min(ans,d[p.S]);\n      }\n    }\n    return ans;\n  }\n};",
    "submit_ts": 1719719084.0
}