{
    "username": "jlallas384",
    "submission": "struct st {\n    pair<int,int> t[100001 * 4];\n    st() {\n        fill(t, t + 100001 * 4, make_pair((int) 1e9, (int) 1e9));\n    }\n    void upd(int i, int x, int p = 1, int l = 0, int r = 100000) {\n        if (l == r) {\n            t[p] = {x, i};\n        } else {\n            int m = (l + r) / 2;\n            if (i <= m) upd(i, x, p * 2, l, m);\n            else upd(i, x, p * 2 + 1, m + 1, r);\n            t[p] = min(t[p * 2], t[p * 2 + 1]);\n        }\n    }\n    pair<int,int> qry(int i, int j, int p = 1, int l = 0, int r = 100000) {\n        if (i <= l && r <= j) return t[p];\n        if (r < i || j < l) return {1e9, 1e9};\n        int m = (l + r) / 2;\n        return min(qry(i, j, p * 2, l, m), qry(i, j, p * 2 + 1, m + 1, r));\n    }\n};\n\nclass Solution {\npublic:\n    long long minimumOperations(vector<int>& nums, vector<int>& target) {\n        vector<int> ds;\n        int n = nums.size();\n        for (int i = 0; i < n; i++) {\n            ds.push_back(target[i] - nums[i]);\n        }\n        int i = 0;\n        long long ans = 0;\n        st st;\n        for( ; i < n; ) {\n            vector<int> ts;\n            if (ds[i] > 0) {\n                while (i < n && ds[i] > 0) {\n                    ts.push_back(ds[i++]);\n                }\n            } else if(ds[i] < 0) {\n                while (i < n && ds[i] < 0) {\n                    ts.push_back(-ds[i++]);\n                }                \n            } else if (ds[i] == 0) {\n                i++;\n            }\n            if (ts.empty()) continue;\n            for (int i = 0; i < ts.size(); i++) {\n                st.upd(i, ts[i]);\n            }\n            function <void(int, int, int)> go = [&](int l, int r, int decr) {\n                if (l > r) return;\n                auto mn = st.qry(l, r);\n                st.upd(mn.second, 1e9);\n                vector<int> inds = {l - 1, mn.second};\n                if (l != r) {\n                    while (true) {\n                        auto tmn = st.qry(l, r);\n                        if (tmn.first != mn.first) break;\n                        st.upd(tmn.second, 1e9);\n                        inds.push_back(tmn.second);\n                    }\n                }\n                inds.push_back(r + 1);\n                ans += mn.first - decr;\n                if (l != r) {\n                    for (int i = 0; i < (int) inds.size() - 1; i++) {\n                        go(inds[i] + 1, inds[i + 1] - 1, mn.first);\n                    }\n                }\n            };\n            go(0, ts.size() - 1, 0);\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1721532529",
    "subm_id": "1327988013"
}