{
    "username": "kevinjshan",
    "submission": "#define ll long long\n#define all(x) x.begin(), x.end()\n#define pb push_back\n#define mp make_pair\n#define ps push\n#define in insert\n#define f first\n#define s second\n\nconst int MOD = 1e9 + 7;\nconst int p = 373;\nll fpow(ll b, ll p){\n    ll r = 1;\n    for(; p; p>>=1, b=b*b%MOD) if(p&1) r=r*b%MOD;\n    return r;\n}\nll minv(ll a) { return fpow(a, MOD-2); }\n\nclass Solution {\npublic:\n    int minimumCost(string target, vector<string>& words, vector<int>& costs) {\n        int n = target.size();\n        vector<ll> pw(n,1);\n        vector<ll> rev(n,1);\n        unordered_map<ll, int> best;\n        set<int> sz;\n        for(int i=0; i<words.size(); i++) sz.insert(words[i].size());\n        \n        for(int i=1; i<n; i++) pw[i] = pw[i-1] * p % MOD;\n        for(int i=0; i<n; i++) rev[i] = minv(pw[i]);\n        \n        ll hsh[n];\n        for(int i=0; i<n; i++) {\n            hsh[i] = (i ? hsh[i-1] : 0) + pw[i] * (target[i] - 'a' + 1) % MOD;\n            hsh[i] %= MOD;\n        }\n        for(int i=0; i<words.size(); i++) {\n            if(words[i].size() > n) {\n                continue;\n            }\n            ll h = 0;\n            for(int j=0; j<words[i].size(); j++) {\n                h += pw[j] * (words[i][j] - 'a' + 1) % MOD;\n                h %= MOD;\n            }\n            if(best.count(h) == 0) best[h] = costs[i];\n            else best[h] = min(best[h], costs[i]);\n        }\n        \n        \n        vector<ll> dp(n, -1);\n        for(int i=0; i<n; i++){\n            ll pv = (i ? dp[i-1] : 0);\n            if(pv == -1) continue;\n            for(auto x:sz) {\n                if(i+x-1 >= n) break;\n                ll goal = (hsh[i + x - 1] - (i?hsh[i-1]:0) + MOD) % MOD;\n                goal = goal * rev[i] % MOD;\n                if(best.count(goal)) {\n                    if(dp[i+x-1] == -1) dp[i+x-1] = pv + best[goal];\n                    else dp[i+x-1] = min(dp[i+x-1], pv + best[goal]);\n                }\n            }\n        }\n        return dp[n-1];\n    }\n};",
    "submit_ts": "1720321756",
    "subm_id": "1312331439"
}