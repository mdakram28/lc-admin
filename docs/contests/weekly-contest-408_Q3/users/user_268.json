{
    "username": "AntonMelnyk",
    "submission": "class Solution {\npublic:\n    int numberOfSubstrings(string s) {\n        int n = s.size();\n        int r = 0;\n\n        vector<int> z;\n        vector<int> o; \n\n        for (int i = 0; i < n; ++i) {\n            if (s[i] == '1') {\n                o.push_back(i);\n            } else {\n                z.push_back(i);\n            }\n        }\n        \n        z.push_back(n);\n\n        for (int i = 0; i < n; ++i) {\n            int x = 1;\n            int a = 0, b = 0;\n\n            int j = lower_bound(z.begin(), z.end(), i) - z.begin();\n            if (j == z.size()) break;\n\n            int c = z[j] - i;\n            r += c;\n\n            a += c;\n            b += x;\n            x += 2;\n\n            if (a >= b && z[j] != n) {\n                r += 1;\n            }\n\n            int l = z[j];\n            int k = j;\n\n            while (true) {\n                j = k + 1;\n                if (j == z.size()) break;\n\n                c = z[j] - l - 1;\n\n                if (a >= b) {\n                    r += c;\n                } else if ((a + c) >= b) {\n                    r += max(a + c - b + 1, 0);\n                }\n\n                a += c;\n                b += x;\n                x += 2;\n\n                \n                if (a >= b && z[j] != n) {\n                    r += 1;\n                }\n\n                if (b >= (a + n - z[j])) {\n                    break;\n                }\n\n                l = z[j];\n                k += 1;\n            }\n        }\n\n        return r;\n    }\n};\n",
    "submit_ts": "1722138864",
    "subm_id": "1335801663"
}