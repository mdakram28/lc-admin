{
    "username": "colicon",
    "submission": "class Solution {\n    #define rep(i, a, b) for(int i = a; i < (b); ++i)\n#define all(x) begin(x), end(x)\n#define sz(x) (int)(x).size()\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef vector<int> vi;\n    struct FT {\n\tvector<ll> s;\n\tFT(int n) : s(n) {}\n\tvoid update(int pos, ll dif) { // a[pos] += dif\n\t\tfor (; pos < sz(s); pos |= pos + 1) s[pos] += dif;\n\t}\n\tll query(int pos) { // sum of values in [0, pos)\n\t\tll res = 0;\n\t\tfor (; pos > 0; pos &= pos - 1) res += s[pos-1];\n\t\treturn res;\n\t}\n\tint lower_bound(ll sum) {// min pos st sum of [0, pos] >= sum\n\t\t// Returns n if no sum is >= sum, or -1 if empty sum is.\n\t\tif (sum <= 0) return -1;\n\t\tint pos = 0;\n\t\tfor (int pw = 1 << 25; pw; pw >>= 1) {\n\t\t\tif (pos + pw <= sz(s) && s[pos + pw-1] < sum)\n\t\t\t\tpos += pw, sum -= s[pos-1];\n\t\t}\n\t\treturn pos;\n\t}\n    };\n    \npublic:\n    vector<int> countOfPeaks(vector<int>& a, vector<vector<int>>& q) {\n        vector<int> ans;\n        \n        int n = size(a);\n        \n        FT ft(n);\n        \n        vector<int> p(n);\n        \n        for (int i = 1; i < n-1; i++) {\n            if (a[i-1] < a[i] and a[i] > a[i+1]) {\n                p[i] = 1;\n                ft.update(i, 1);\n            }\n        }\n        \n        for (auto qu: q) {\n            int t = qu[0];\n            \n            if (t == 1) {\n                int l = qu[1], r = qu[2];\n                \n                if (r-l+1 <= 2) {\n                    ans.push_back(0);\n                }\n                else {\n                    ans.push_back(ft.query(r) - ft.query(l+1));\n                }\n            }\n            else {\n                int j = qu[1], v = qu[2];\n                \n                a[j] = v;\n                \n                for (int i = max(0, j-1); i <= min(n-1, j+1); i++)\n                if (i > 0 and i < n-1) {\n                    int prev = p[i];\n\n                    p[i] = a[i-1] < a[i] and a[i] > a[i+1];\n                    \n                    int diff = p[i] - prev;\n                    ft.update(i, diff);\n                }\n            }\n        }\n        \n        return ans;\n    }\n};",
    "submit_ts": 1718507025.0
}