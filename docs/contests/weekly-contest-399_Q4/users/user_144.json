{
    "username": "tonyli00000",
    "submission": "class Solution {\npublic:\n\tconst long long MOD = 1e9 + 7;\n\tstruct bucket {\n\t\tlong long incl_all;\n\t\tlong long ex_left;\n\t\tlong long ex_right;\n\t\tlong long middle;\n\t};\n\tbucket calc(vector<int>& nums, int l, int r) {\n\t\tvector<long long>a(2);\n\t\tbucket b;\n\t\tb.incl_all = 0LL;\n\t\tb.ex_left = 0LL;\n\t\tb.ex_right = 0LL;\n\t\tb.middle = 0LL;\n\t\tfor (int i = l; i <= r; i++) {\n\t\t\tlong long xx = a[0] + max(0LL, 1LL * nums[i]), yy = max(a[0], a[1]);\n\t\t\ta[0] = yy;\n\t\t\ta[1] = xx;\n\t\t\tif (i == r - 1) b.ex_right = max(a[0], a[1]);\n\t\t}\n\t\tb.incl_all = max(a[0], a[1]);\n\t\ta = { 0,0 };\n\t\tfor (int i = l+1; i <= r; i++) {\n\t\t\tlong long xx = a[0] + max(0LL, 1LL * nums[i]), yy = max(a[0], a[1]);\n\t\t\ta[0] = yy;\n\t\t\ta[1] = xx;\n\t\t\tif (i == r - 1)b.middle = max(a[0], a[1]);\n\t\t}\n\t\tb.ex_left = max(a[0], a[1]);\n\t\treturn b;\n\t}\n\tlong long solve(vector<bucket>& a) {\n\t\tint n = a.size();\n\t\t// 0 - include last, 1 - don't include last\n\t\tvector<long long>ret(2, 0);\n\t\tret[0] = a[0].incl_all;\n\t\tret[1] = a[0].ex_right;\n\t\tfor(int i=1;i<n;i++){\n\t\t\tlong long x = ret[0] + max(0LL, a[i].ex_left);\n\t\t\tx = max(x, ret[1] + max(0LL, a[i].incl_all));\n\n\t\t\tlong long y = ret[1] + max(0LL, a[i].ex_right);\n\t\t\ty = max(y, ret[0] + max(0LL, a[i].middle));\n\t\t\tret[0] = x;\n\t\t\tret[1] = y;\n\t\t}\n\t\treturn max(ret[0], ret[1]);\n\t}\n\tint maximumSumSubsequence(vector<int>& nums, vector<vector<int>>& queries) {\n\t\tint n = nums.size(), m = queries.size();\n\t\tint sz = sqrt(n), buckets = n / sz + (n % sz != 0);\n\t\tvector<bucket>a(buckets);\n\t\tfor (int i = 0; i < buckets; i++)a[i] = calc(nums, i * sz, min(n - 1, i * sz + sz - 1));\n\t\tlong long sum = 0;\n\t\tfor (int i = 0; i < m; i++) {\n\t\t\tnums[queries[i][0]] = queries[i][1];\n\t\t\tint pos = queries[i][0] / sz;\n\t\t\ta[pos] = calc(nums, pos * sz, min(n - 1, pos * sz + sz - 1));\n\t\t\tsum = (sum + solve(a)) % MOD;\n\t\t}\n\t\treturn sum;\n\t}\n};",
    "submit_ts": "1716695425",
    "subm_id": "1268141416"
}