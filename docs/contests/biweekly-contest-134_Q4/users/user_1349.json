{
    "username": "a-dong-b0",
    "submission": "class Solution {\n    public long countSubarrays(int[] nums, int k) {\n        int n = nums.length;\n        long res = 0;\n        int[][] pre = new int[n + 1][40];\n        for (int i = 1; i <= n; i++) {\n            for (int j = 0; j < 30; j++) {\n                pre[i][j] = pre[i - 1][j];\n                if (((nums[i - 1] >> j) & 1) == 1) pre[i][j] ++;\n            }\n        }\n        for (int i = 1; i <= n; i++) {\n            int l = 1; int r = i;\n            while (l < r) {\n                int mid = (l + r + 1) >> 1;\n                if (check1(mid, i, k, pre)) r = mid - 1;\n                else l = mid;\n            }\n            boolean st = true;\n            for (int j = 0; j <= 30; j++) {\n                if (((k >> j) & 1) == 1 && pre[i][j] - pre[l - 1][j] != i - l + 1) st = false;\n                if (((k >> j) & 1) == 0 && pre[i][j] - pre[l - 1][j] == i - l + 1) st = false;\n            }\n            int ll = l;\n            if (!st) continue;\n            l = 1; r = i;\n            while (l < r) {\n                int mid = (l + r) >> 1;\n                if (check2(mid, i, k, pre)) r = mid;\n                else l = mid + 1;\n            }\n            res += ll - l + 1;\n        }\n        return res;\n    }\n\n    private boolean check1(int l, int r, int k, int[][] pre) {\n        int count = Integer.bitCount(k);\n        int t = 0;\n        for (int i = 0; i <= 30; i++) {\n            if (pre[r][i] - pre[l - 1][i] == r - l + 1) t ++;\n            if (((k >> i) & 1) == 1) {\n                if (pre[r][i] - pre[l - 1][i] != r - l + 1) return false;\n            }\n        }\n        return t > count;\n    }\n\n    private boolean check2(int l, int r, int k, int[][] pre) {\n        for (int i = 0; i <= 30; i++) {\n            if (((k >> i) & 1) == 1) {\n                if (pre[r][i] - pre[l - 1][i] != r - l + 1) return false;\n            }\n        }\n        return true;\n    }\n}",
    "submit_ts": "1720280118",
    "subm_id": "544570603"
}