{
    "username": "Konstantin Kostin",
    "submission": "class Solution {\n\n    int binSearch(int[] a, int l, int r, int x) {\n        if (x <= a[l]) {\n            return l;\n        }\n        if (a[r] < x) {\n            return r + 1;\n        }\n        while (r - l > 1) {\n            int m = (l + r) / 2;\n            if (a[m] >= x) {\n                r = m;\n            } else {\n                l = m;\n            }\n        }\n        return r;\n    }\n\n    public long[] countKConstraintSubstrings(String s, int k, int[][] queries) {\n        int n = s.length();\n        int[] rr = new int[n];\n        for (int i = 0, j = 0, cnt0 = 0, cnt1 = 0; i < n; ++i) {\n            while (j < n && (cnt0 <= k || cnt1 <= k)) {\n                if (s.charAt(j) == '0') {\n                    cnt0++;\n                } else {\n                    cnt1++;\n                }\n                j++;\n            }\n            if (cnt0 > k && cnt1 > k) {\n                rr[i] = j - 1;\n            } else {\n                rr[i] = j;\n            }\n            if (s.charAt(i) == '0') {\n                cnt0--;\n            } else {\n                cnt1--;\n            }\n        }\n        long[] rs = new long[n];\n        rs[0] = rr[0] - 0;\n        for (int i = 1; i < n; ++i) {\n            rs[i] = rs[i - 1] + (rr[i] - i);\n        }\n\n        long[] ans = new long[queries.length];\n        for (int q = 0; q < queries.length; q++) {\n            int l = queries[q][0];\n            int r = queries[q][1];\n            int m = binSearch(rr, l, r, r + 1);\n            long cnt = 0;\n            // All substring that start from l...(m-1) are ok\n            if (l < m) {\n                cnt += rs[m - 1] - (l > 0 ? rs[l - 1] : 0);\n            }\n            if (m <= r) {\n                // All substring starting from (m...r) must be truncated at r\n                long len = r - m + 1;\n                cnt += len * (len + 1) / 2;\n            }\n            ans[q] = cnt;\n        }\n        return ans;\n    }\n}",
    "submit_ts": "1723952867",
    "subm_id": "1359806601"
}