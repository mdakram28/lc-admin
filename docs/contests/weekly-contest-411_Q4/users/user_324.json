{
    "username": "Anshul Agarwal",
    "submission": "#define ll long long\nclass Solution {\npublic:\n    vector<long long> countKConstraintSubstrings(string s, int k, vector<vector<int>>& q) {\n        int n = s.length(),j = 0,cnto = 0,cntz = 0;\n        vector<int> v;\n        for(int i = 0;i<n;i++){\n            j = max(j,i);\n            while(j<n && (cnto<=k || cntz<=k))\n            {\n                if(s[j]=='1'){\n                    cnto++;\n                    if(cnto>k && cntz>k){\n                        cnto--;\n                        break;\n                    }\n                }\n                else{\n                    cntz++;\n                    if(cnto>k && cntz>k){\n                        cntz--;\n                        break;\n                    }\n                }\n                \n                j++;\n            }\n            v.push_back(j); \n            if(j!=i){\n            if(s[i]=='1')\n                cnto--;\n            else\n                cntz--;\n            }\n          \n        }\n        \n        vector<ll> psum(n),p(n);\n        psum[0] = v[0];\n        for(int i = 1;i<n;i++){\n            psum[i] = psum[i-1]+v[i];\n            p[i] = p[i-1]+i;\n        }\n        vector<ll> ans;\n        for(auto i : q){\n            ll l = i[0],r = i[1];\n            ll res = 0;\n            ll l1 = v[l];\n            ll x = upper_bound(v.begin(),v.end(),r)-v.begin()-1;\n            x = max(x,l-1);\n            if(x>=0){\n            ll lft = 0,lft2 = 0;\n            if(l)\n                lft = psum[l-1];\n            if(l)\n                lft2 = p[l-1];\n            res+=(psum[x]-lft-(p[x]-lft2));\n            }\n            if(x<n-1){\n                ll l2 = v[x+1];\n                ll r2 = v[r];\n                ll lft = 0;\n                if(x>=0)\n                    lft = p[x];\n                res+=((r+1)*(r-x)-(p[r]-lft));\n            }\n            ans.push_back(res);\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1723953031",
    "subm_id": "1359810581"
}