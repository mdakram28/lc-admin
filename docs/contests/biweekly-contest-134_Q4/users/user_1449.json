{
    "username": "Shams_Ahnaf_Rafid",
    "submission": "class Solution {\npublic:\n    long long countSubarrays(vector<int>& nums, int k) {\n        long long ans = 0;\n        int sz = nums.size();\n        int pref[sz][31];\n        int suff[sz][31];\n        for (int i = 0; i < sz; i++) {\n            for (int j = 0; j < 31; j++) {\n                pref[i][j] = 0;\n                suff[i][j] = sz;\n            }\n        }\n        for (int i = 0; i < sz; i++) {\n            for (int j = 0; j < 31; j++) {\n                if (i) pref[i][j] = pref[i-1][j];\n                if (((1LL<<j)&nums[i])) pref[i][j]++;\n            }\n        }\n        for (int i = sz-1; i >= 0; i--) {\n            for (int j = 0; j < 31; j++) {\n                if (i < sz-1) suff[i][j] = suff[i+1][j];\n                if (((1LL<<j)&nums[i]) == 0) suff[i][j] = i;\n            }\n        }\n        for (int i = 0; i < sz; i++) {\n            int mx = 0;\n            for (int j = 0; j < 31; j++) {\n                if (((1LL<<j)&k) == 0) {\n                    mx = max (mx, suff[i][j]);\n                }\n            }\n            if (mx != sz) {\n                int f = 0;\n                int sum = 0;\n                for (int j = 0; j < 31; j++) {\n                    sum = pref[mx][j];\n                    if (i) sum -= pref[i-1][j];\n                    if (sum == (mx-i+1)) f += (1LL<<j);\n                }\n                if (f == k) {\n                    ///cout << mx << endl;\n                    int l = mx, r = sz-1, mid, pos = mx;\n                    while (l <= r) {\n                        mid = (l+r)/2;\n                        int g = 0;\n                        int val;\n                        for (int j = 0; j < 31; j++) {\n                            val = pref[mid][j];\n                            if (i) val -= pref[i-1][j];\n                            if (val && val == (mid-i+1)) g += (1LL<<j);\n                        }\n                        ///cout << g << endl;\n                        if (g == k) {\n                            pos = mid;\n                            l = mid+1;\n                        }\n                        else r = mid-1;\n                    }\n                    ///cout << pos << endl;\n                    ans += (pos-mx+1);\n                }\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1720280364",
    "subm_id": "1311786604"
}