{
    "username": "sanmai_reddy377",
    "submission": "#pragma GCC optimize(\"unroll-loops,O3,Ofast\") //even 10^8+ also works with this\n#pragma GCC target(\"avx2,avx,fma,bmi,bmi2,lzcnt,popcnt\")\ntypedef long long ll;\n \n#define pb push_back\n#define ppb pop_back\n#define ff first\n#define ss second\n#define rt return;\n#define set_bits(a) __builtin_popcountll(a)\n#define mine(a)    (*min_element((a).begin(), (a).end()))\n#define maxe(a)    (*max_element((a).begin(), (a).end()))\n#define mini(a)    ( min_element((a).begin(), (a).end()) - (a).begin())\n#define maxi(a)    ( max_element((a).begin(), (a).end()) - (a).begin())\n#define lowb(a, x) ( lower_bound((a).begin(), (a).end(), (x)) - (a).begin())\n#define uppb(a, x) ( upper_bound((a).begin(), (a).end(), (x)) - (a).begin())\n#define disp(a) {for(int i=0;i<a.size();i++) cout<<a[i]<<\" \"; cout<<endl;}\n#define all(v) (v).begin(),(v).end()\n#define rall(v) (v).rbegin(),(v).rend()\n#define inp(a) {for(int i=0;i<(a).size();i++) cin>>(a)[i];}\n#define fill(a,b) memset(a, b, sizeof(a))\n#define prt(a) cout<<(a)<<endl;\n#define endl \"\\n\"\n#define NO cout<<\"NO\"<<endl;\n#define YES cout<<\"YES\"<<endl;\n#define vll vector<ll>\n#define vvll vector<vector<ll>>\n#define double double\n#define de(a) cout<<\"(\"<<a<<\")\"<<endl;\n#define de2(a) cout<<\"*\"<<a<<\"*\"<<endl;\n#define ft front()\n#define bk back()\n#define minpq priority_queue<ll, vector<ll>, greater<ll> >\n#define maxpq priority_queue<ll>\n#define nl cout<<endl;\n#define IOS ios::sync_with_stdio(0); cin.tie(0); cout.tie(0);\n#define cont continue;\n#define vpll vector<pair<ll,ll>>\n#define vvii vector<vector<int>>\n#define vi vector<int>\n#define vvpll vector<vector<pair<ll,ll>>>\n#define pll pair<ll,ll>\n\n//const ll M=998244353;\nconst ll M=1e9+7;\nconst ll N=1e5+5;  \nconst ll inf=1e18; //keeping inf may not give soln every time,try 1e9, 1e15\n\nll bit(ll n,ll i){return (n&(1LL<<i)) ? 1 : 0;}\nll add(ll a,ll b){return ((a%M)+(b%M))%M;}\nll mul(ll a,ll b){return ((a%M) * (b%M))%M;}\n\nclass Solution {\npublic:\n    ll fun(ll a,string &s,vll &cnt,vll &cnt2){\n       ll n=s.size(),j=0,ct0=0,ct1=0,ans=0;\n       for(int i=0;i<n;i++){\n         while(j<n && (ct0<a || (ct0==a && s[j]=='1'))){\n            if(s[j]=='0') ct0++;\n            else ct1++;\n            j++;\n         }\n         if(ct0==a && ct1>=ct0*ct0){\n            ll val=0;\n            if(i>0) val=cnt[i-1];\n            ll ind=lowb(cnt,ct0*ct0+val); //ind--;\n            val=0;\n            if(i>0) val=cnt2[i-1];\n            ll ind2=lowb(cnt2,ct0+val); \n            // de(ind2)\n            ans+=(j-max({ind,i*1LL,ind2}));\n         }\n         if(s[i]=='0') ct0--;\n         else ct1--;\n       }\n       return ans;\n    }\n    int numberOfSubstrings(string s) {\n        ll n=s.size(),ans=0,ct0=0;\n        vll cnt(n),cnt2(n);\n        for(int i=0;i<n;i++){\n           if(s[i]=='1') cnt[i]++;\n           if(i>0) cnt[i]+=cnt[i-1];\n           if(s[i]=='0') ct0++;\n           cnt2[i]=ct0;\n        }\n        for(ll i=0;i*i+i<=n && i<=ct0;i++){\n           ll val=fun(i,s,cnt,cnt2);\n        //    de2(val)\n           ans+=val;\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1722139065",
    "subm_id": "1335806900"
}