{
    "username": "alexlin87",
    "submission": "import java.util.*;\n\nclass Solution {\n    private int[] f;\n    public long countSubarrays(int[] a, int k) {\n        long ans = 0;\n        f = new int[31];\n        for(int i = 0; i < 31; i++) {\n            f[i] = (k & (1 << i)) != 0 ? 1 : 0;\n        }\n        List<Integer> l = new ArrayList<>();\n        for(int x : a) {\n            if((x & k) >= k) {\n                l.add(x);\n            }\n            else {\n                ans += compute(l);\n                l.clear();\n            }\n        }\n        ans += compute(l);\n        return ans;\n    }\n    private long compute(List<Integer> l) {\n        if(l.size() == 0) {\n            return 0;\n        }\n        int n = l.size();\n        int[][] ps = new int[n][31];\n        for(int i = 0; i < n; i++) {\n            for(int j = 0; j < 31; j++) {\n                ps[i][j] = (i > 0 ? ps[i - 1][j] : 0) + ((l.get(i) & (1 << j)) != 0 ? 1 : 0);\n            }\n        }\n        long ans = 0;\n        for(int i = 0; i < n; i++) {\n            int j = bs(ps, i);\n            ans += j + 1;\n        }\n        return ans;\n    }\n    private int bs(int[][] ps, int i) {\n        int l = 0, r = i;\n        while(l < r - 1) {\n            int mid = l + (r - l) / 2;\n            if(check(ps, mid, i)) {\n                l = mid;\n            }\n            else {\n                r = mid - 1;\n            }\n        }\n        if(check(ps, r, i)) {\n            return r;\n        }\n        else if(check(ps, l, i)) {\n            return l;\n        }\n        return -1;\n    }\n    private boolean check(int[][] ps, int x1, int x2) {\n        int[] d = new int[31];\n        for(int i = 0; i < 31; i++) {\n            d[i] = ps[x2][i] - (x1 > 0 ? ps[x1 - 1][i] : 0);\n        }\n        for(int i = 0; i < 31; i++) {\n            if(f[i] == 0 && d[i] == x2 - x1 + 1) {\n                return false;\n            }\n        }\n        return true;\n    }\n    public static void main(String[] args) {\n        Solution solution = new Solution();\n        int[] a = new int[]{1,2,3};\n        solution.countSubarrays(a,2);\n    }\n}",
    "submit_ts": "1720279412",
    "subm_id": "1311750160"
}