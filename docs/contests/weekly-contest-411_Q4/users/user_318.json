{
    "username": "\u5c0f\u9547\u505a\u9898\u5bb6",
    "submission": "class Solution {\n    public long[] countKConstraintSubstrings(String s, int k, int[][] queries) {\n        int[][] dp=new int[s.length()][3];\n        long[] ans= new long[queries.length];\n        int count0=0;\n        int count1=0;\n        HashMap<Integer,Integer> map0=new HashMap<>();\n        HashMap<Integer,Integer> map1=new HashMap<>();\n        map0.put(0,-1);\n        map1.put(0,-1);\n        for (int i = 0; i < s.length(); i++) {\n            if(s.charAt(i)=='0'){\n                count0++;\n                map0.put(count0,i);\n            }else {\n                count1++;\n                map1.put(count1,i);\n            }\n            dp[i][0]=count0;\n            dp[i][1]=count1;\n            dp[i][2]=i+1;\n            int temp=-1;\n            temp=Integer.max(temp,i-map0.get(Integer.max(count0-k,0)));\n            temp=Integer.max(temp,i-map1.get(Integer.max(count1-k,0)));\n            if(temp!=-1){\n                dp[i][2]=temp;\n            }\n        }\n        long[] sum=new long[s.length()];\n        int[] start=new int[s.length()];\n        sum[0]=dp[0][2];\n        for (int i = 1; i < s.length(); i++) {\n            sum[i]=dp[i][2]+sum[i-1];\n            start[i]=i-dp[i][2]+1;\n        }\n        for (int i = 0; i < queries.length; i++) {\n            int cur0=dp[queries[i][0]][0];\n            int cur1=dp[queries[i][0]][1];\n            int startindex=binarySearch(start,queries[i][0]);\n            if(startindex<=queries[i][1]){\n                ans[i]=sum[queries[i][1]]-sum[startindex]+dp[startindex][2];\n            }\n            long length=startindex-queries[i][0];\n            length=Long.min(queries[i][1]-queries[i][0]+1,length);\n            ans[i]=ans[i]+length*(length+1)/2;\n        }\n        return ans;\n    }\n    public int binarySearch(int[] nums, int target) {\n        int low=0,high=nums.length-1;\n        while(low<=high){\n            int mid=(low+high)/2;\n            if(nums[mid]>=target){\n                high=mid-1;\n            }else {\n                low=mid+1;\n            }\n        }\n        return low;\n    }\n}",
    "submit_ts": "1723952602",
    "subm_id": "556412561"
}