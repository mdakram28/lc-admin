{
    "username": "scanhex",
    "submission": "class Solution {\npublic:\n    long long maximumScore(vector<vector<int>>& grid) {\n\n        using nagai = long long;\n        int n = grid.size(); \n        for (int i = 0; i < n; ++i)\n            for (int j = 0; j < i; ++j) swap(grid[i][j], grid[j][i]);\n        vector<vector<nagai>> dp(n + 1, vector<nagai>(n + 1)), dp1(n + 1, vector<nagai>(n + 1));\n        vector<vector<nagai>> pref(n, vector<nagai>(n + 1));\n        for (int i = 0; i < n; ++i) {\n            for (int j = 0; j < n; ++j) { \n                pref[i][j + 1] = pref[i][j] + grid[i][j];\n            }\n        }\n        nagai ans = 0;\n        for (int i = 1; i < n; ++i) {\n            for (int j = 0; j <= n; ++j) {\n                dp[i][j] = pref[i - 1][j];\n                dp1[i][j] = pref[i - 1][j];\n                for (int k = max(0, i - 5); k < i; ++k) {\n                    for (int l = 0; l <= n; ++l) {\n                        nagai val = dp[k][l];\n                        if (i == k + 1) {\n                            val = dp1[k][l];\n                            if (j <= l) val = max(val, dp[k][l]);\n                            if (j > l) val += pref[i - 1][j] - pref[i - 1][l];\n                            else val += pref[i][l] - pref[i][j];\n                            dp[i][j] = max(dp[i][j], val);\n                            if (j >= l) dp1[i][j] = max(dp1[i][j], val);\n                            continue;\n                        }\n                        if (i == k + 2) val += pref[i - 1][max(j, l)];\n                        if (i > k + 2) {\n                            val += pref[k + 1][l];\n                            val += pref[i - 1][j];\n                        }\n                        dp1[i][j] = max(dp[i][j], val);\n                    }\n                }\n                dp[i][j] = max(dp[i][j], dp1[i][j]);\n                ans = max(ans, dp[i][j]);\n                if (i + 1 < n) ans = max(ans, dp[i][j] + pref[i + 1][j]);\n            }\n        }\n        return ans;\n    }\n};\n",
    "submit_ts": "1721488302",
    "subm_id": "1327417977"
}