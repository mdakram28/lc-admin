{
    "username": "vigorous-boumanram",
    "submission": "class Solution {\npublic:\n    long long countSubarrays(vector<int>& ns, int K) {\n        int n=ns.size();\n        int s[n+1][31];\n        memset(s, 0, sizeof s);\n        for(int i=1; i<=n; i++){\n            for(int j=0; j<31; j++){\n                s[i][j]=s[i-1][j];\n                if(ns[i-1]>>j&1){\n                    s[i][j]++;\n                }\n            }\n        }\n        \n        long long res=0;\n        for(int i=0; i<n; i++){\n            if(ns[i]>=K){\n                int l1=i, r1=n;\n                while(l1<r1){\n                    int mid=l1+r1>>1;\n                    int x=0;\n                    for(int j=0; j<31; j++){\n                        if(s[mid+1][j]-s[i][j]==mid-i+1){\n                            x|=1<<j;\n                        }\n                    }\n                    \n                    if(x<=K) r1=mid;\n                    else l1=mid+1;\n                }\n                \n                int l2=i, r2=n-1;\n                while(l2<r2){\n                    int mid=l2+r2+1>>1;\n                    int x=0;\n                    for(int j=0; j<31; j++){\n                        if(s[mid+1][j]-s[i][j]==mid-i+1){\n                            x|=1<<j;\n                        }\n                    }\n                    \n                    if(x>=K) l2=mid;\n                    else r2=mid-1;\n                }\n                // cout << i << ' ' << r1 << ' ' << r2;\n                \n                if((r1==i && ns[i]>K)) continue;\n                if(r1==n) continue;\n                // cout << \"  Y\" << endl;\n                res+=r2-r1+1;\n            }\n        }\n        return res;\n    }\n};\n\n/*\n\u8f93\u5165\uff1a\n[1,1,2]\n1\n\u8f93\u51fa\uff1a\n2\n\u9884\u671f\uff1a\n3\n\n\u8f93\u5165\uff1a\n[3,5,5,3,10]\n0\n\u8f93\u51fa\uff1a\n-6\n\u9884\u671f\uff1a\n3\n\n\u8f93\u5165\uff1a\n[6,6,9,0,0]\n6\n\u8f93\u51fa\uff1a\n1\n\u9884\u671f\uff1a\n3\n*/",
    "submit_ts": "1720280332",
    "subm_id": "544571494"
}