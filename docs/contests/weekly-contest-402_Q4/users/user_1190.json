{
    "username": "wasd_1234",
    "submission": "class Solution {\npublic:\n    int n;\n    vector<int>seg;\n    vector<int>a;\n    \n    int merge(int cnt1, int cnt2, int l1, int r1, int l2, int r2){\n        int ret=cnt1+cnt2;\n        if(r1-l1>0 && a[r1]>a[r1+1] && a[r1]>a[r1-1]) ret++;\n        else if(r2-l2>0 && a[r1+1]>a[r1] && a[r1+1]>a[r1+2]) ret++;\n        return ret;\n    }\n    \n    void build(int id, int l, int r){\n        if(r-l==1){\n            seg[id]=0;\n            return;\n        }\n        int mid=(l+r)/2;\n        build(2*id,l,mid); build(2*id+1,mid,r);\n        seg[id]=merge(seg[2*id],seg[2*id+1],l,mid-1,mid,r-1);\n    }\n    \n    int query(int x, int y, int id, int l, int r){\n        if(x<=l && r<=y) return seg[id];\n        if(x>=r || y<=l) return 0;\n        int mid=(l+r)/2;\n        int val1=query(x,y,2*id,l,mid);\n        int val2=query(x,y,2*id+1,mid,r);\n        int ans=val1+val2;\n        if(mid>x && mid<y-1){\n            if(r-mid>1 && a[mid]>a[mid-1] && a[mid]>a[mid+1]) ans++;\n        }\n        mid--;\n        if(mid>x && mid<y-1){\n            if(mid-l>=1 && a[mid]>a[mid-1] && a[mid]>a[mid+1]) ans++;\n        }\n        return ans;\n    }\n    \n    void modify(int pos, int val, int id, int l, int r){\n        if(r-l==1){\n            a[pos]=val;\n            return ;\n        }\n        int mid=(l+r)/2;\n        if(mid>pos) modify(pos,val,2*id,l,mid);\n        else modify(pos,val,2*id+1,mid,r);\n        seg[id]=merge(seg[2*id],seg[2*id+1],l,mid-1,mid,r-1);\n    }\n    \n    \n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n        n=nums.size();\n        seg.resize(4*n+1);\n        a=nums;\n        build(1,0,n);\n        vector<int>ans;\n        // cout<<seg[1]<<\"\\n\";\n        for(auto x:queries){\n            if(x[0]==1){\n                ans.push_back(query(x[1],x[2]+1,1,0,n));\n            }\n            else{\n                modify(x[1],x[2],1,0,n);\n            }\n        }\n        return ans;\n        \n        \n    }\n};",
    "submit_ts": 1718509147.0
}