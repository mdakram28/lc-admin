{
    "username": "transcend_2002",
    "submission": "int prefix[100010][32];\nclass Solution {\n   public:\n    long long countSubarrays(vector<int>& nums, int k) {\n        long long answer = 0;\n        int n = nums.size();\n        vector<int> v = nums;\n        memset(prefix, 0, sizeof(prefix));\n        v.insert(begin(v), 0);\n        for (int i = 1; i <= n; i++) {\n            for (int j = 0; j < 32; j++) {\n                prefix[i][j] += prefix[i - 1][j];\n                if ((1LL << j) & v[i]) {\n                    prefix[i][j]++;\n                }\n            }\n        }\n        for (int i = 1; i <= n; i++) {\n            int start = i, end = n;\n            int a = 1, b = 0;\n            while (start <= end) {\n                int mid = (start + end) >> 1;\n                int value = 0;\n                for (int j = 0; j < 32; j++) {\n                    int c = prefix[mid][j] - prefix[i - 1][j];\n                    if (c == mid - i + 1) {\n                        value |= 1 << j;\n                    }\n                }\n                if (value > k) {\n                    start = mid + 1;\n                } else if (value == k) {\n                    a = mid;\n                    end = mid - 1;\n                } else {\n                    end = mid - 1;\n                }\n            }\n            start = i, end = n;\n            while (start <= end) {\n                int mid = (start + end) >> 1;\n                int value = 0;\n                for (int j = 0; j < 32; j++) {\n                    int c = prefix[mid][j] - prefix[i - 1][j];\n                    if (c == mid - i + 1) {\n                        value |= 1 << j;\n                    }\n                }\n                if (value > k) {\n                    start = mid + 1;\n                } else if (value == k) {\n                    b = mid;\n                    start = mid + 1;\n                } else {\n                    end = mid - 1;\n                }\n            }\n            answer += b - a + 1;\n        }\n        return answer;\n    }\n};",
    "submit_ts": "1720278879",
    "subm_id": "1311728146"
}