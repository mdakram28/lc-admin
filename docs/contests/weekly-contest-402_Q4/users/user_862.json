{
    "username": "selfknow",
    "submission": "template <typename T>\nstruct Fenwick {\n    int n;\n    std::vector<T> a;\n    \n    Fenwick(int n = 0) {\n        init(n);\n    }\n    \n    void init(int n) {\n        this->n = n;\n        a.assign(n, T());\n    }\n    \n    void add(int x, T v) {\n        for (int i = x + 1; i <= n; i += i & -i) {\n            a[i - 1] += v;\n        }\n    }\n    \n    T sum(int x) {\n        auto ans = T();\n        for (int i = x; i > 0; i -= i & -i) {\n            ans += a[i - 1];\n        }\n        return ans;\n    }\n    \n    T rangeSum(int l, int r) {\n        return sum(r) - sum(l);\n    }\n    \n    int kth(T k) {\n        int x = 0;\n        for (int i = 1 << std::__lg(n); i; i /= 2) {\n            if (x + i <= n && k >= a[x + i - 1]) {\n                x += i;\n                k -= a[x - 1];\n            }\n        }\n        return x;\n    }\n};\nclass Solution {\npublic:\n\n    vector<int> countOfPeaks(vector<int>& a, vector<vector<int>>& q) {\n        int n = a.size();\n        Fenwick<int> fen(n + 2);\n        \n        for(int i = 1; i < n - 1; i ++) \n            if(a[i] > a[i - 1] && a[i] > a[i + 1]) \n                fen.add(i,1);\n        \n        vector<int> res;\n        for(int i = 0; i < q.size(); i ++) {\n            if(q[i][0] == 1) {\n                int l = q[i][1] , r = q[i][2];\n                if(r - l + 1 < 3) res.push_back(0);\n                else res.push_back(fen.rangeSum(l + 1,r));\n            } else {\n                int x = q[i][1], v = q[i][2];\n                if(x > 0 && x + 1 < n) {\n                    if(a[x] > a[x - 1] && a[x] > a[x + 1])\n                        fen.add(x,-1);\n                    if(v > a[x - 1] && v > a[x + 1])\n                        fen.add(x,1);\n                }\n                if(x >= 2 && a[x - 1] > a[x - 2]) {\n                    if(a[x - 1] > a[x])\n                        fen.add(x - 1,-1);\n                    if(a[x - 1] > v)\n                        fen.add(x - 1,1);\n                }\n                \n                if(x + 2 < n && a[x + 2] < a[x + 1]) {\n                    if(a[x + 1] > a[x])\n                        fen.add(x + 1, -1);\n                    if(a[x + 1] > v)\n                        fen.add(x + 1,1);\n                }\n                a[x] = v;\n            }\n        }\n            return res;\n        \n    }\n};",
    "submit_ts": 1718508955.0
}