{
    "username": "Silly PanininDo",
    "submission": "class BIT:\n    \"\"\"\u533a\u95f4\u66f4\u65b0\uff0c\u533a\u95f4\u548c\u67e5\u8be2 \"\"\"  \n    __slots__ = \"size\", \"_tree1\", \"_tree2\"\n    def __init__(self, n: int):\n        self.size = n\n        self._tree1 = [0]*(n+1)\n        self._tree2 = [0]*(n+1)\n\n    def add(self, left: int, right: int, delta: int) -> None:\n        \"\"\"\u95ed\u533a\u95f4[left, right]\u52a0delta\"\"\"\n        self._add(left, delta)\n        self._add(right + 1, -delta)\n\n    def query(self, left: int, right: int) -> int:\n        \"\"\"\u95ed\u533a\u95f4[left, right]\u7684\u548c\"\"\"\n        return self._query(right) - self._query(left - 1)\n\n    def _add(self, index: int, delta: int) -> None:\n        rawIndex = index\n        while index <= self.size:\n            self._tree1[index] += delta\n            self._tree2[index] += (rawIndex - 1) * delta\n            index += index & -index\n\n    def _query(self, index: int) -> int:\n        if index > self.size:\n            index = self.size\n        rawIndex = index\n        res = 0\n        while index > 0:\n            res += rawIndex * self._tree1[index] - self._tree2[index]\n            index -= index & -index\n        return res\nclass Solution:\n    def countKConstraintSubstrings(self, s: str, k: int, queries: List[List[int]]) -> List[int]:\n        n=len(s)\n        pre=[[0,0]]\n        for i in s:\n            pre.append(pre[-1][:])\n            pre[-1][int(i)]+=1\n        query=[[] for _ in range(n+1)]\n        q=len(queries)\n        res=[0]*q\n        for i in range(q):\n            l,r=queries[i]\n            m=r-l+1\n            res[i]=(1+m)*m//2\n            query[r+1].append((i,l+1))\n        bit=BIT(n+5)\n        l=0\n        for r in range(1,n+1):\n            while pre[r][0]-pre[l][0]>k and pre[r][1]-pre[l][1]>k:\n                l+=1\n            if l>0:\n                bit.add(1,l,1)\n            for i,tmp in query[r]:\n                res[i]-=bit.query(tmp,r)\n        return res\n            \n        \n        ",
    "submit_ts": "1723949589",
    "subm_id": "556393745"
}