{
    "username": "ZEON3099",
    "submission": "struct Tree {\n\ttypedef long long T;\n\tstatic constexpr T unit = 0;\n\tT f(T a, T b) { return a + b; } // (any associative fn)\n\tvector<T> s; int n;\n\tTree(int n = 0, T def = unit) : s(2*n, def), n(n) {}\n\tvoid update(int pos, T val) {\n\t\tfor (s[pos += n] = val; pos /= 2;)\n\t\t\ts[pos] = f(s[pos * 2], s[pos * 2 + 1]);\n\t}\n\tT query(int b, int e) { // query [b, e)\n\t\tT ra = unit, rb = unit;\n\t\tfor (b += n, e += n; b < e; b /= 2, e /= 2) {\n\t\t\tif (b % 2) ra = f(ra, s[b++]);\n\t\t\tif (e % 2) rb = f(s[--e], rb);\n\t\t}\n\t\treturn f(ra, rb);\n\t}\n};\n\n\nclass Solution {\npublic:\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& qw) {\n        \n        int n = nums.size();\n        \n        Tree seg(n);\n        \n        vector<int> da(nums.begin(),nums.end());\n        \n        for(int i = n-1 ; i >= 1 ; --i)\n            da[i] -= da[i-1];\n        \n        for(int i = 1 ; i < n-1 ; ++i)\n            if(da[i]>0 && da[i+1]<0)\n                seg.update(i,1);\n            \n        vector<int> ans;\n        \n        for(auto&a:qw){\n            \n            if(a[0]==2){\n                int x = a[1] , y = a[2];\n                \n                if(nums[x]==y)\n                    continue;\n                else{\n                    \n                    da[x] = y-(x==0?0:nums[x-1]);\n                    if(x+1<n)\n                        da[x+1] = nums[x+1]-y;\n                    \n                    // for(auto&a:da)\n                    //     cout<<a<<\" \";\n                    // cout<<endl;\n                    \n                    for(int i = -1 ; i <= 2 ; ++i)\n                        if(i + x > 0 && i+x < n-1)\n                            if(da[i+x]>0 && da[i+x+1]<0)\n                                seg.update(i+x,1);\n                            else\n                                seg.update(i+x,0);\n                    \n                    nums[x] = y;\n                }\n                \n            }\n            else{\n                if(a[1]+1<=a[2]-1)\n                    ans.push_back(seg.query(a[1]+1,a[2]));\n                else\n                {\n                    // cout<<12;\n                    ans.push_back(0);\n                }\n            }\n        }\n        \n        \n        return ans;\n        \n    }\n};",
    "submit_ts": 1718507967.0
}