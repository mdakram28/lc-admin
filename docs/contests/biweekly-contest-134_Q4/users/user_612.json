{
    "username": "wixton",
    "submission": "class Solution {\npublic:\n#define ll long long \n    int BIT = 30;\n    int getAnd(int l, int r, vector<vector<ll>> &dp) {\n        ll ans = 0;\n        for(int j = 0; j < BIT; j++) {\n            if(dp[r][j] - dp[l-1][j] == (r - l + 1)) {\n                ans += (1ll << j);\n            }\n        }\n        return ans;\n    }\n    ll bs1(int i, vector<int> &ar, int k, vector<vector<ll>> &dp) {\n        int idx = -1;\n        int n = ar.size();\n        int l = i, r = n - 1;\n        while(l <= r) {\n            int mid = (l + r) / 2;\n            ll AND = getAnd(i + 1, mid + 1, dp);\n            // cout << mid << \" \" << AND << endl;\n            if(AND < k) {\n                r = mid - 1;\n            }\n            else if(AND > k) {\n                l = mid + 1;\n            }\n            else {\n                idx = mid;\n                l = mid + 1;\n            }\n        }\n        return idx;\n    }\n    ll bs2(int i, vector<int> &ar, int k, vector<vector<ll>> &dp) {\n        int idx = -1;\n        int n = ar.size();\n        int l = i, r = n - 1;\n        while(l <= r) {\n            int mid = (l + r) / 2;\n            ll AND = getAnd(i + 1, mid + 1, dp);\n            if(AND < k) {\n                r = mid - 1;\n            }\n            else if(AND > k) {\n                l = mid + 1;\n            }\n            else {\n                idx = mid;\n                r = mid - 1;\n            }\n        }\n        return idx;\n    }\n    long long countSubarrays(vector<int>& ar, int k) {\n        long long res = 0;\n        int n = ar.size();\n        \n        vector<vector<ll>> dp(n + 1, vector<ll> (BIT));\n        for(int i = 1; i <= n; i++) {\n            for(int j = 0; j < BIT; j++) {\n                dp[i][j] = dp[i-1][j];\n                if(ar[i-1] & (1ll << j)) {\n                    dp[i][j]++;\n                }\n            }\n        }\n\n        for(int i = 0; i < n; i++) {\n            ll r = bs1(i, ar, k, dp);\n            ll l = bs2(i, ar, k, dp);\n            if(r != -1)\n                res += r - l + 1;\n        }\n        return res;\n    }\n};",
    "submit_ts": "1720278992",
    "subm_id": "1311732789"
}