{
    "username": "johnwu",
    "submission": "class Solution:\n    def countOfPeaks(self, nums: List[int], queries: List[List[int]]) -> List[int]:\n        def count(idx):\n            ans = 0\n            while idx > 0:\n                ans += bits[idx]\n                idx -= idx & (-idx)\n            return ans\n        bits = [0 for _ in range(len(nums) + 1)]\n        for idx, num in enumerate(nums):\n            if idx == 0 or idx == len(nums) - 1:\n                continue\n            if num <= nums[idx-1] or num <= nums[idx+1]:\n                continue\n            tmp = idx + 1\n            while tmp < len(bits):\n                bits[tmp] += 1\n                tmp += tmp & (-tmp)\n        ans = []\n        for t, s, e in queries:\n            # print(nums, bits)\n            if t == 2:\n                before = []\n                for pos in [s - 1, s, s + 1]:\n                    before.append(0)\n                    if pos <= 0 or pos >= len(nums) - 1:\n                        continue\n                    if nums[pos-1] < nums[pos] and nums[pos] > nums[pos+1]:\n                        before[-1]= 1\n                after = []\n                nums[s] = e\n                for pos in [s - 1, s, s + 1]:\n                    after.append(0)\n                    if pos <= 0 or pos >= len(nums) - 1:\n                        continue\n                    if nums[pos-1] < nums[pos] and nums[pos] > nums[pos+1]:\n                        after[-1]= 1\n                # print(after, before, pos)\n                for pos, b, a in zip([s-1, s, s+1], before, after):\n                    if b == a:\n                        continue\n                    diff = a - b\n                    idx = pos + 1\n                    while idx < len(bits):\n                        bits[idx] += diff\n                        idx += idx & (-idx)\n            else:\n                if e - s <= 1:\n                    ans.append(0)\n                else:\n                    ans.append(count(e) - count(s + 1))\n        return ans",
    "submit_ts": 1718507637.0
}