{
    "username": "balakrishnan_v",
    "submission": "#define MAXBIT 30\n#define MAXN 100000\nclass Solution {\npublic:\n    \n    int cumul[MAXBIT+1][MAXN+2];\n\n    \n    int GetAnd(int i,int j,const vector<int>& nums) {\n        // if (i > j) return (1ll<<30)-1;\n        // int ret = (1ll<<30)-1;\n        // for(int k=i;k<=j;k++) {\n        //     ret &= nums[k];\n        // }\n        // return ret;\n        int ret = (1ll<<MAXBIT)-1;\n        for(int b=0;b<MAXBIT;b++) {\n            if (cumul[b][j]-(i?cumul[b][i-1]:0)<j-i+1) ret^=(1ll<<b); \n        }\n        return ret;\n    }\n    \n    int GetSmallest(int i, const vector<int>& nums, int k) {\n        int n=nums.size();\n        \n        int low=i;\n        int high=n-1;\n        while(low<high) {\n            int mid=(low+high)/2;\n            if (GetAnd(i,mid,nums)>k) {\n                low=mid+1;\n            } else {\n                high=mid;\n            }\n        }\n        return low;\n        \n    }\n    \n    int GetLargest(int i, const vector<int>& nums, int k) {\n        int n=nums.size();\n        \n        int low=i-1;\n        int high=n-1;\n        while(low<high) {\n            int mid=(1+low+high)/2;\n            if (GetAnd(i,mid,nums)>=k) {\n                low=mid;\n            } else {\n                high=mid-1;\n            }\n        }\n        return low;\n    }\n    \n    long long countSubarrays(vector<int>& nums, int k) \n    {\n        \n        int n=nums.size();\n        \n        for(int b=0;b<=MAXBIT;b++) {\n            for(int i=0;i<n;i++) {\n                cumul[b][i]=((nums[i]>>b)&1);\n                if (i) cumul[b][i]+=cumul[b][i-1];\n            }\n        }\n        \n        long long ans=0;\n        for(int i=0;i<n;i++) {\n            // smallest index such that and is <= k\n            // largest index such that and is >= k\n            \n            int low=GetSmallest(i,nums,k);\n            int high=GetLargest(i,nums,k);\n            if (low <= high && GetAnd(i,low,nums)==k)  ans += high-low+1;\n            \n        }\n        return ans;\n        \n    }\n};",
    "submit_ts": "1720277303",
    "subm_id": "1311657427"
}