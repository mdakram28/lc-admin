{
    "username": "reverent-johnsonyfn",
    "submission": "class Solution {\npublic:\n    vector<int> r,l;\n    long long countSubarrays(vector<int>& nums, int k) {\n        r.assign(32,0);\n        l.assign(32,0);\n        {\n            int tmp = k;\n        int i = 0;\n        while(i<32) {\n            if(k%2==0) {\n                r[i]++;\n            } else {\n                l[i]++;\n            }\n            i++;\n            k/=2;\n        }\n        k=tmp;\n        }\n        int n = nums.size();\n        vector<vector<int>> vec(n+1,vector<int>(32,0));\n        for(int i=1;i<=n;i++) {\n            int tmp = nums[i-1];\n            int j = 0;\n            while(tmp) {\n                vec[i][j]+=(tmp%2);\n                vec[i][j]+=vec[i-1][j];\n                tmp/=2;\n                j++;\n            }\n        }\n\n        auto check1 = [&](int idx, int mid) {\n            for(int i=0;i<32;i++) {\n                if(vec[idx+1][i]-vec[mid][i]==idx-mid+1 && r[i]) {\n                    return false;\n                }\n            }\n            return true;\n        };\n        \n        auto check2 = [&](int idx, int mid) {\n            for(int i=0;i<32;i++) {\n                if(vec[idx+1][i]-vec[mid][i]!=idx-mid+1 && l[i]) {\n                    return false;\n                }\n            }\n            return true;\n        };\n\n        auto fd1 = [&](int idx) {\n            int l=0;\n            int r=idx;\n            while(l<r) {\n                int mid=(l+r)/2;\n                if(check1(idx,mid)) {\n                    l = mid+1;\n                } else {\n                    r = mid;\n                }\n            }\n            if(!check1(idx,l)) {\n                l--;\n            }\n            return l;\n        };\n\n        \n        auto fd2 = [&](int idx) {\n            if((nums[idx]&k)!=k)return -1;\n            int l = 0;\n            int r = idx;\n            while(l<r) {\n                int mid = (l+r)/2;\n                if(check2(idx,mid)) {\n                    r = mid;\n                } else {\n                    l = mid+1;\n                }\n            }\n            if(!check2(idx,r)) {\n                r--;\n            }\n            return r;\n        };\n        long long ans = 0;\n        \n        for(int i=0;i<n;i++) {\n            int r = fd1(i);\n            int l = fd2(i);\n            if(r==-1 || l==-1 || l>r) {\n                continue;\n            }\n            ans = ans + (long long)(r-l+1);\n        }   \n        return ans;\n    }\n};",
    "submit_ts": "1720280186",
    "subm_id": "544570896"
}