{
    "username": "Anonymous_235940",
    "submission": "template <typename T, typename ACC> class segtree {\n    struct segtree_node {\n        T ans;\n        int start;\n        int len;\n        segtree_node* l{nullptr};\n        segtree_node* r{nullptr};\n    };\n\n    T segtree_q(segtree_node* q, int min, int max) {\n        if (q == nullptr || q->start > max || q->start + q->len - 1 < min)\n            return default_value;\n        if (min <= q->start && max >= q->start + q->len - 1)\n            return q->ans;\n        return acc(segtree_q(q->l, min, max), segtree_q(q->r, min, max));\n    }\n\n    void segtree_set(segtree_node* q, int i, const T &v) {\n        if (q == nullptr || q->start > i || q->start + q->len - 1 < i)\n            return;\n        if (q->start == i && q->len == 1) {\n            q->ans = v;\n            return;\n        }\n        segtree_set(q->l, i, v);\n        segtree_set(q->r, i, v);\n        q->ans = acc(q->l->ans, q->r->ans);\n    }\n\n    segtree_node* segtree_init(int sz, int i) {\n        auto ans = new segtree_node{default_value, i, sz, nullptr, nullptr};\n        if (sz > 1) {\n            ans->l = segtree_init(sz / 2, i);\n            ans->r = segtree_init(sz / 2 + sz % 2, i + sz / 2);\n        }\n        return ans;\n    }\n    segtree_node* _root{nullptr};\n    ACC acc;\n    T default_value;\n\n        public : segtree(int sz, const T& default_value,\n                         ACC acc) :acc{acc}, default_value{default_value} {\n        _root = segtree_init(sz, 0);\n    }\n    T query(int min, int max) { return segtree_q(_root, min, max); }\n    void set(int i, const T v) { segtree_set(_root, i, v); }\n};\n\nclass Solution {\npublic:\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n        segtree st{(int)nums.size(), (int)0, [](int i, int j){return i + j;}};\n        for(int i = 1; i < nums.size() - 1; ++i)\n        {\n            if(nums[i] > nums[i - 1] && nums[i] > nums[i + 1])\n                st.set(i, 1);\n        }\n        vector<int> ans{};\n        for(auto &q : queries)\n        {\n            if(q[0] == 1)\n            {\n                if(q[2] - q[1] > 1)\n                    ans.push_back(st.query(q[1] + 1, q[2] - 1));\n                else\n                    ans.push_back(0);\n            }\n            else if(q[0] == 2)\n            {\n                nums[q[1]] = q[2];\n                for(int i = max(1, q[1] - 1); i <= min(q[1] + 1, (int)nums.size() - 2); ++i)\n                {\n                    if(nums[i] > nums[i - 1] && nums[i] > nums[i + 1])\n                        st.set(i, 1);\n                    else\n                        st.set(i, 0);\n                }\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": 1718508149.0
}