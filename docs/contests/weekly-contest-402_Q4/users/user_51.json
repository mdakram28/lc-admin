{
    "username": "66brother",
    "submission": "const int SIZE = 2e5 + 100;\nstruct Fenwick {\n  int tree[SIZE];\n  void init(int n) {\n    for(int i = 0; i <= n + 1; i++) tree[i] = 0;\n  }\n\n  void update(int i, int val) {\n    i++;\n    while(i < SIZE){\n      tree[i] += val;\n      i += (i & -i);\n    }\n  }\n\n  int pre(int i) {\n    int sum = 0;\n    while(i>0){\n      sum += tree[i];\n      i -= ( i & -i);\n    }\n    return sum;\n  }\n  int query(int i, int j) {\n      return pre(j + 1) - pre(i);\n  }\n} tr;\n\nbool is(vector<int>& a, int i) {\n    if(i <= 0 || i >= a.size() - 1) return false;\n    //cout << a[i - 1] << \"  \" << a[i] << \" \"  << \" \" << a[i + 1] << endl;\n    return (a[i] > a[i - 1]) && (a[i] > a[i + 1]);\n}\n\nclass Solution {\npublic:\n    vector<int> countOfPeaks(vector<int>& a, vector<vector<int>>& q) {\n        int n = a.size();\n        tr.init(n + 1);\n        for(int i = 1; i < n - 1; i++) {\n            if(a[i] > a[i - 1] && a[i] > a[i + 1]) {\n                tr.update(i, 1);\n            }\n        }\n        \n        \n        vector<int> ans;\n        for(int i = 0; i < q.size(); i++) {\n            int op = q[i][0];\n            if(op == 1) {\n                int l = q[i][1], r = q[i][2];\n                int x = tr.query(l, r);\n                if(is(a, l)) {\n                    //cout << \"yes1 \" << endl;\n                    x--;\n                }\n                if(l != r && is(a, r)) {\n                    //cout << \"yes2 \" << endl;\n                    x--;\n                }\n                ans.push_back(x);\n            } else {\n                int index = q[i][1], v = q[i][2];\n                if(is(a, index - 1)) {\n                    tr.update(index - 1, -1);\n                }\n                if(is(a, index)) {\n                    tr.update(index, -1);\n                }\n                if(is(a, index + 1)) {\n                    tr.update(index + 1, -1);\n                }\n                a[index] = v;\n                if(is(a, index - 1)) {\n                    tr.update(index - 1, 1);\n                }\n                if(is(a, index)) {\n                    tr.update(index, 1);\n                }\n                if(is(a, index + 1)) {\n                    tr.update(index + 1, 1);\n                }\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": 1718506283.0
}