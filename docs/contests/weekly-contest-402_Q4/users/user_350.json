{
    "username": "zeldahuang",
    "submission": "class Solution {\npublic:\n    int st[1000010];\n    int flag[100010];\n    void build(int l,int r,int rt){\n        if(l==r){\n            st[rt]=flag[l-1];\n            return;\n        }\n        int mid=(l+r)>>1;\n        build(l,mid,rt<<1);\n        build(mid+1,r,rt<<1|1);\n        st[rt]=st[rt<<1]+st[rt<<1|1];\n    }\n    void update(int l,int r,int pos,int val,int rt){\n        if(l==r){\n            st[rt]=val;\n            return;\n        }\n        int mid=(l+r)>>1;\n        if(pos<=mid){\n            update(l,mid,pos,val,rt<<1);\n        }\n        else{\n            update(mid+1,r,pos,val,rt<<1|1);\n        }\n        st[rt]=st[rt<<1]+st[rt<<1|1];\n    }\n    int query(int l,int r,int x,int y,int rt){\n        if(l>=x&&r<=y){\n            return st[rt];\n        }\n        int mid=(l+r)>>1,res=0;\n        if(x<=mid){\n            res+=query(l,mid,x,y,rt<<1);\n        }\n        if(y>mid){\n            res+=query(mid+1,r,x,y,rt<<1|1);\n        }\n        return res;\n    }\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n        for(int i=1;i+1<nums.size();++i){\n            if(nums[i]>nums[i-1]&&nums[i]>nums[i+1]) flag[i]=1;\n        }\n        int n=nums.size();\n        build(1,n,1);\n        // cout<<query(1,n,1,n,1)<<\"...\\n\";\n        vector<int> ans;\n        for(auto &q:queries){\n            if(q[0]==1){\n                int l=q[1]+1,r=q[2]+1;\n                if(l+1>r-1) ans.push_back(0);\n                else ans.push_back(query(1,n,l+1,r-1,1));\n            }\n            else{\n                int idx=q[1],val=q[2];\n                nums[idx]=val;\n                for(int i=idx-1;i<=idx+1;++i){\n                    if(i>0&&i+1<n){\n                        if(nums[i]>nums[i-1]&&nums[i]>nums[i+1]){\n                            update(1,n,i+1,1,1);\n                            // cout<<\"upd1\\n\";\n                        }\n                        else{\n                            update(1,n,i+1,0,1);\n                            // cout<<\"upd0\\n\";\n                            // cout<<query(1,n,1,n,1)<<\"...\\n\";\n                        }\n                    }\n                }\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": 1718507280.0
}