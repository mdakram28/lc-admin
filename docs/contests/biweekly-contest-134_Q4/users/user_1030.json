{
    "username": "openai_is_closed",
    "submission": "class Solution {\npublic:\n    long long countSubarrays(vector<int>& nums, int k) {\n        int n = nums.size();\n        vector<vector<int>> dp(n + 2, vector<int>(30, 0));\n        for (int i = 0; i < n; i++) {\n            for (int bit = 0; bit < 30; bit++) {\n                if (nums[i] & (1 << bit)) {\n                    dp[i + 1][bit] = 1;\n                }\n                if (i > 0) {\n                    dp[i + 1][bit] += dp[i][bit];\n                }\n            }\n        }\n\n        auto get = [&](int l, int r) -> int {\n            int ans = 0;\n            for (int bit = 0; bit < 30; bit++) {\n                int c = dp[r][bit];\n                if (l > 0) {\n                    c -= dp[l - 1][bit];\n                }\n\n                if (c == (r - l + 1)) {\n                    ans += (1 << bit);\n                }\n            }\n\n            return ans;\n        };\n\n        long long ans = 0;\n        for (int i = 1; i <= n; i++) {\n            int st = i;\n            int dr = n;\n\n            if (nums[i - 1] < k) {\n                continue;\n            }\n\n            while (st <= dr) {\n                int mid = (st + dr) / 2;\n                if (get(i, mid) >= k) {\n                    st = mid + 1;\n                } else {\n                    dr = mid - 1;\n                }\n            }\n\n            // 7 5 3 3 3 3 3 2 1\n\n            // cout << \"asd: \" << get(i, dr) << '\\n';\n            // cout << \"1:   \" << i << \"    \" << dr << '\\n';\n\n            if (dr < i || get(i, dr) != k) {\n                // cout << \"wtf\\n\";\n                continue;\n            }\n\n            int R = dr;\n\n            st = i;\n            dr = n;\n            while (st <= dr) {\n                int mid = (st + dr) / 2;\n                if (get(i, mid) > k) {\n                    st = mid + 1;\n                } else {\n                    dr = mid - 1;\n                }\n            }\n\n            // cout << \"2:   \" << i << \"   \" << dr << '\\n';\n            \n            int L = dr;\n            ans += R - L;\n        }\n\n        return ans;\n    }\n};",
    "submit_ts": "1720278205",
    "subm_id": "1311699056"
}