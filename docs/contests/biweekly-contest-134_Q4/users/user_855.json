{
    "username": "Dolfun",
    "submission": "class Solution {\npublic:\n  long long countSubarrays(vector<int>& a, int k) {\n    using ll = long long;\n    constexpr int BITS = 32;\n    int n = a.size();\n    \n    vector<array<int, BITS>> cnt(n + 1);\n    for (int b = 0; b < BITS; ++b) {\n      for (int i = 1; i <= n; ++i) {\n        cnt[i][b] = cnt[i - 1][b];\n        if ((a[i - 1] >> b) & 1) ++cnt[i][b];\n      }\n    }\n    \n    auto query = [&] (int l, int r) {\n      if (l > r) return 0;\n      int res = 0;\n      for (int b = 0; b < BITS; ++b) {\n        if (cnt[r][b] - cnt[l - 1][b] == r - l + 1) res |= (1 << b);\n      }\n      return res;\n    };\n    \n    ll res = 0;\n    for (int i = 1; i <= n; ++i) {\n      int l = find_first_false(i, n, [&] (int x) {\n        return query(i, x) > k;\n      });\n      \n      int r = find_first_false(i, n, [&] (int x) {\n        return query(i, x) >= k;\n      });\n      res += r - l;\n    }\n    \n    return res;\n  }\n  \nprivate:\n  template <class T, class F>\n  T find_first_false(T l, T r, F&& f) {\n    --l; ++r;\n    while (r - l > 1) {\n      T m = midpoint(l, r);\n      if (f(m)) {\n        l = m;\n      } else {\n        r = m;\n      }\n    }\n    return r;\n  }\n};",
    "submit_ts": "1720279778",
    "subm_id": "1311764701"
}