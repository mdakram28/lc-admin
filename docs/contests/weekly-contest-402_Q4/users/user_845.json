{
    "username": "mp1256",
    "submission": "class Solution {\n    \n    int lowbit(int x) {\n        return x & (-x);\n    }\n    \n    int query(vector<int> &t, int i) {\n        int res = 0;\n        while (i > 0) {\n            res += t[i];\n            i -= lowbit(i);\n        }\n        return res;\n    }\n    \n    void add(int n, vector<int> &t, int i, int x) {\n        while (i <= n) {\n            t[i] += x;\n            i += lowbit(i);\n        }\n    }\n    \npublic:\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n        int n = nums.size();\n        vector<int> t(n+1);\n        for (int i = 1; i < n - 1; ++i) {\n            if (nums[i] > nums[i-1] && nums[i] > nums[i+1]) {\n                add(n, t, i+1, 1);\n            }\n        }\n        vector<int> res;\n        for (vector<int> &q : queries) {\n            int op = q[0];\n            int a = q[1];\n            int b = q[2];\n            if (op == 1) {\n                if (a >= b) {\n                    res.push_back(0);\n                } else {\n                    res.push_back(query(t, b) - query(t, a+1));\n                }\n            } else {\n                int x1 = nums[a];\n                int x2 = b;\n                nums[a] = b;\n                if (a > 0 && a < n - 1) {\n                    if (x1 > nums[a-1] && x1 > nums[a+1] && !(x2 > nums[a-1] && x2 > nums[a+1])) {\n                        add(n, t, a+1, -1);\n                    } else if (!(x1 > nums[a-1] && x1 > nums[a+1]) && (x2 > nums[a-1] && x2 > nums[a+1])) {\n                        add(n, t, a+1, 1);\n                    }\n                }\n                \n                if (a >= 2) {\n                    if ((nums[a-1] > x1 && nums[a-1] > nums[a-2]) && !(nums[a-1] > x2 && nums[a-1] > nums[a-2])) {\n                        add(n, t, a, -1);\n                    } else if (!(nums[a-1] > x1 && nums[a-1] > nums[a-2]) && (nums[a-1] > x2 && nums[a-1] > nums[a-2])) {\n                        add(n, t, a, 1);\n                    }\n                }\n                \n                if (a < n - 2) {\n                    if ((nums[a+1] > x1 && nums[a+1] > nums[a+2]) && !(nums[a+1] > x2 && nums[a+1] > nums[a+2])) {\n                        add(n, t, a+2, -1);\n                    } else if (!(nums[a+1] > x1 && nums[a+1] > nums[a+2]) && (nums[a+1] > x2 && nums[a+1] > nums[a+2])) {\n                        add(n, t, a+2, 1);\n                    }\n                }\n            }\n        }\n        return res;\n    }\n};",
    "submit_ts": 1718508007.0
}