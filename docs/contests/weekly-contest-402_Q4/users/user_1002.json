{
    "username": "liu-xing-0923",
    "submission": "const int N = 1e5 + 10;\nint tr[N];\nint n;\n\nint lowbit(int x) {return x & (-x);}\n\nvoid add(int x, int val) {\n    for (int i = x; i <= n; i += lowbit(i)) tr[i] += val;\n}\n\nint query(int x) {\n    int res = 0;\n    for (int i = x; i; i -= lowbit(i)) res += tr[i];\n    \n    return res;\n}\n\nint query(int ll, int rr) {\n    return query(rr) - query(ll - 1);\n}\n\nclass Solution {\npublic:\n    bool is_up(vector<int> &a, int idx) {\n        if (idx > 1 && idx < a.size() - 1 && a[idx] > a[idx-1] && a[idx] > a[idx+1]) return true;\n        return false;\n    }\n    \n    vector<int> countOfPeaks(vector<int>& a, vector<vector<int>>& qs) {\n        memset(tr, 0, sizeof tr);\n        \n        n = a.size();\n        a.insert(a.begin(), 0);\n        for (int i = 2; i <= n - 1; i++) {\n            if (is_up(a, i)) add(i, 1);\n        }\n        \n        // cout << query(1, 5) << endl;\n        \n        vector<int> res;\n        for (int i = 0; i < qs.size(); i++) {\n            vector<int> &q = qs[i];\n            if (q[0] == 1) {\n                int ll = q[1] + 1, rr = q[2] + 1;\n                int r = query(ll, rr);\n                // cout << ll << ' ' << rr << ' ' << r << endl;\n                r -= is_up(a, ll);\n                if (ll != rr) r -= is_up(a, rr);\n                // cout << ll << ' ' << rr << ' ' << r << endl;\n                res.push_back(r);\n            } else {\n                int x = q[1] + 1, val = q[2];\n                for (int i = x - 1; i <= x + 1; i++) {\n                    if (is_up(a, i)) add(i, -1);\n                }\n                \n                a[x] = val;\n                for (int i = x - 1; i <= x + 1; i++) {\n                    if (is_up(a, i)) add(i, 1);\n                }\n            }\n             // cout << query(1, 5) << endl;\n            // for (int i = 1; i <= n; i++) {\n            //     cout << query(i, i) << ' ';\n            // }\n            // cout << endl;\n        }\n        \n        return res;\n    }\n};",
    "submit_ts": 1718508373.0
}