{
    "username": "grundy_number",
    "submission": "class Solution {\npublic:\n    long long countSubarrays(vector<int>& a, int k) {\n        int n = a.size();\n        vector<vector<int>> b(n + 1, vector<int> (31));\n        for (int i = 0; i < n; ++i) {\n            b[i+1] = b[i];\n            for (int j = 0; j < 31; ++j) {\n                b[i+1][j] += ((a[i] >> j) & 1);\n            }\n        }\n        long long ans = 0;\n        for (int i = 0; i < n; ++i) {\n            int mask = 0;\n            for (int j = 0; j < 31; ++j) {\n                if (b[i + 1][j] == i + 1) {\n                    mask += (1 << j);\n                }\n            }\n                \n            if (mask > k) {\n                continue;\n            }\n            if (a[i] < k) {\n                continue;\n            }\n            int left, right;\n            {\n                int l = -1, r = i;\n                // r: msk >= k\n                while (l + 1 < r) {\n                    int m = (l + r) / 2;\n                    int msk = 0;\n                    for (int j = 0; j < 31; ++j) {\n                        if (b[i+1][j] - b[m][j] == (i + 1 - m)) {\n                            msk += (1 << j);\n                        }\n                    }\n                    if (msk >= k) {\n                        r = m;\n                    } else {\n                        l = m;\n                    }\n                }\n                left = r;\n            }\n            \n            {\n                int l = 0, r = i + 1;\n                // l: msk <= k\n                while (l + 1 < r) {\n                    int m = (l + r) / 2;\n                    int msk = 0;\n                    for (int j = 0; j < 31; ++j) {\n                        if (b[i+1][j] - b[m][j] == (i + 1 - m)) {\n                            msk += (1 << j);\n                        }\n                    }\n                    if (msk <= k) {\n                        l = m;\n                    } else {\n                        r = m;\n                    }\n                }\n                right = l;\n            }\n            int msk = 0;\n            for (int j = 0; j < 31; ++j) {\n                if (b[i+1][j] - b[left][j] == i + 1 - left) {\n                    msk += (1 << j);\n                }\n            }\n            \n            if (msk == k) {\n                ans += (right - left + 1);\n            }\n            \n        }\n        return ans;\n    }\n};",
    "submit_ts": "1720278537",
    "subm_id": "1311713473"
}