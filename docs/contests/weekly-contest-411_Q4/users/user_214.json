{
    "username": "\u671d\u82b1\u5915\u62fe",
    "submission": "class Solution {\n    public long[] countKConstraintSubstrings(String s, int k, int[][] queries) {\n        int N = s.length();\n        int[][] cnt = new int[N + 1][2];\n        for(int i = 0; i < N; i++) {\n            cnt[i + 1][0] = cnt[i][0];\n            cnt[i + 1][1] = cnt[i][1];\n            int c = s.charAt(i) - '0';\n            cnt[i +1][c]++;\n        }\n        int[] len = new int[N];\n        long[] cnt1 = new long[N + 1];\n        for(int i = 0; i < N; i++) {\n            int r1 = find(cnt, 0, cnt[i][0] + k);\n            int r2 = find(cnt, 1, cnt[i][1] + k);\n            //System.out.println(i + \"  \" + r1 + \"  \" + r2);\n            len[i] = Math.max(r1 - 1, r2 - 1);\n            cnt1[i + 1] = cnt1[i] + len[i] - i + 1;\n        }\n        // for(int i = 0; i < N; i++) {\n        //     System.out.println(i + \"  \" + len[i] + \" \" + cnt1[i + 1]);\n        // }\n        long[] ans = new long[queries.length];\n        for(int i = 0; i < queries.length; i++) {\n            int[] q = queries[i];\n            int t = find1(len, q[0], q[1]);\n            //System.out.println(i +  \"  \" + t);\n            if(t < 0) {\n                int l = q[1] - q[0] + 2;\n                ans[i] = 1L * l * (l - 1) / 2;\n            } else {\n                ans[i] = cnt1[t + 1] - cnt1[q[0]];\n                int l = q[1] - t + 1;\n                ans[i] += 1L * l * (l - 1) / 2;\n            }\n        }\n        return ans;\n    }\n\n    private int find(int[][] cnt, int i, int k) {\n        int l = 0, r = cnt.length - 1, m;\n        while(l < r) {\n            m = l + (r - l + 1) / 2;\n            if(cnt[m][i] > k) {\n                r = m - 1;\n            } else {\n                l = m;\n            }\n        }\n        return cnt[l][i] <= k ? l : cnt.length;\n    }\n\n    private int find1(int[] len, int ll, int rr) {\n        int l = ll, r = rr, m;\n        while(l < r) {\n            m = l + (r - l + 1) / 2;\n            if(len[m] > rr) {\n                r = m - 1;\n            } else {\n                l = m;\n            }\n        }\n        return len[l] <= rr ? l : -1;\n    }\n}",
    "submit_ts": "1723951338",
    "subm_id": "556404784"
}