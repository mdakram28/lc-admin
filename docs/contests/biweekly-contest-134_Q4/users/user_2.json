{
    "username": "wjli",
    "submission": "\n\n// COPY ALL MACROS BELOW\n\ntypedef long long LL;\n#define MP make_pair\n#define PB push_back\n#define F first\n#define S second\n#define LB lower_bound\n#define UB upper_bound\n#define SZ(x) ((int)x.size())\n#define LEN(x) ((int)x.length())\n#define ALL(x) begin(x), end(x)\n#define RSZ resize\n#define ASS assign\n#define REV(x) reverse(x.begin(), x.end());\n#define trav(a, x) for (auto& a : x)\ntypedef pair<LL, LL> PL;\ntypedef vector<LL> VL;\ntypedef vector<PL> VPL;\ntypedef vector<VL> VVL;\ntypedef vector<VVL> VVVL;\ntypedef vector<VVVL> VVVVL;\ntypedef vector<string> VS;\ntypedef pair<int, int> PI;\ntypedef vector<int> VI;\ntypedef vector<PI> VPI;\ntypedef vector<vector<int>> VVI;\ntypedef vector<vector<PI>> VVPI;\n#define MAX(x) *max_element(ALL(x))\n#define MIN(x) *min_element(ALL(x))\n#define FOR(i, n) for (int i = 0; i < n; i++) \n#define FOR1(i, n) for (int i = 1; i <= n; i++) \n#define SORT(x) sort(x.begin(), x.end())\n#define RSORT(x) sort(x.rbegin(), x.rend())\n#define SUM(x) accumulate(x.begin(), x.end(), 0LL)\n\n\n\n\n\n\nclass Solution {\n    LL g(LL l, LL r, VVL &ct) {\n        LL MAXLEVEL = 32, i, j, k, ans = 0, n = r - l + 1, x;\n        FOR(i, MAXLEVEL) {\n            x = ct[r][i] - ct[l - 1][i];\n            if (x == n) ans += 1LL << i;\n        }\n        return ans;\n    }\n\npublic:\n    long long countSubarrays(vector<int>& nums, int k) {\n        LL n = nums.size(), i, j, l, r, MAXLEVEL = 32, ans, xl, xr;\n        VVL ct(n + 1, VL(MAXLEVEL, 0));\n        FOR1(i,n) {\n            ct[i] = ct[i - 1];\n            FOR(j, MAXLEVEL) {\n                if ((1LL << j) & nums[i - 1]) ct[i][j]++;\n            }\n        }\n\n        ans = 0;\n        l = 1; r = 1;\n        FOR1(i, n) {\n            while ((l <= n) && (g(i, l, ct) > k)) l++;\n            while ((r <= n) && (g(i, r, ct) >= k)) r++;\n\n            if ((l <= n) && (g(i, l, ct) == k)) ans += r - l;\n        }\n\n        return ans;\n    }\n};\n\n",
    "submit_ts": "1720276894",
    "subm_id": "1311637918"
}