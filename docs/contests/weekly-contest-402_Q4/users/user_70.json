{
    "username": "lichen-7i",
    "submission": "struct fenwick {\n    vector<int> t;\n    fenwick(int n = -1) : t(n + 1) {} // \u8303\u56f4 [1,n]; n=t.size()-1\n    void add(int i, int a) {\n        assert(1 <= i && i < (int)t.size());\n        for (; i < (int)t.size(); i += i & -i)\n            t[i] += a;\n    }\n    int sum(int i) const {\n        int s = {0};\n        for (; i; i -= i & -i)\n            s += t[i];\n        return s;\n    }\n    int sum(int l, int r) const { return sum(r) - sum(l - 1); }\n};\n\nclass Solution {\npublic:\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n        fenwick T(nums.size());\n        auto fix=[&](int x,int op) {\n            if (x<=0||x>=nums.size()-1) return;\n            if (nums[x]>nums[x-1]&&nums[x]>nums[x+1]) T.add(x,op);\n        };\n        for (int i=0;i<nums.size();i++) fix(i,1);\n        vector<int> res;\n        for (auto &vec:queries) {\n            int op=vec[0],l=vec[1],r=vec[2];\n            if (op==1) {\n                if (r-l+1<=2) res.push_back(0);\n                else res.push_back(T.sum(l+1,r-1));\n            } else {\n                fix(l-1,-1); fix(l,-1); fix(l+1,-1);\n                nums[l]=r;\n                fix(l-1,1); fix(l,1); fix(l+1,1);\n            }\n        }\n        return res;\n    }\n};",
    "submit_ts": 1718506126.0
}