{
    "username": "liu-jia-jie-e",
    "submission": "template<typename T>\nstruct Fenwick{\n\tint n;\n\tvector<T> tr;\n\tFenwick(){}\n\tFenwick(int _n):tr(_n+1),n(_n){\n\t\tfor(int i=0;i<=n;i++) tr[i]=0;\n\t}\n\tT lowbit(T x){\n\t\treturn x&-x;\n\t}\n\tvoid add(int u,T x){\n\t\tfor(int i=u;i<=n;i+=lowbit(i)) tr[i]+=x;\n\t}\n\tT query(int u){\n\t\tT res=0;\n\t\tfor(int i=u;i;i-=lowbit(i)) res+=tr[i];\n\t\treturn res;\n\t}\n};\nclass Solution {\npublic:\n    vector<int> countOfPeaks(vector<int>& a, vector<vector<int>>& qs) {\n        int n=a.size();\n        Fenwick<int> fen(n);\n        for(int i=1;i<n-1;i++){\n            if(a[i]>a[i-1]&&a[i]>a[i+1]) fen.add(i+1,1);\n        }\n        vector<int> ans;\n        for(auto q:qs){\n            if(q[0]==1){\n                int l=q[1],r=q[2];\n                if(r-l+1<2){\n                    ans.push_back(0);\n                    continue;\n                }\n                int res=fen.query(r);\n                res-=fen.query(l+1);\n                ans.push_back(res);\n            }else{\n                int i=q[1],v=q[2];\n                if(i-1>0){\n                    if(a[i-1]>a[i-2]&&a[i-1]>a[i]) fen.add(i,-1);\n                }\n                if(i!=0&&i!=n-1){\n                    if(a[i]>a[i-1]&&a[i]>a[i+1]) fen.add(i+1,-1);\n                }\n                if(i+1<n-1){\n                    if(a[i+1]>a[i]&&a[i+1]>a[i+2]) fen.add(i+2,-1);\n                }\n                a[i]=v;\n                if(i-1>0){\n                    if(a[i-1]>a[i-2]&&a[i-1]>a[i]) fen.add(i,1);\n                }\n                if(i!=0&&i!=n-1){\n                    if(a[i]>a[i-1]&&a[i]>a[i+1]) fen.add(i+1,1);\n                }\n                if(i+1<n-1){\n                    if(a[i+1]>a[i]&&a[i+1]>a[i+2]) fen.add(i+2,1);\n                }\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": 1718507222.0
}