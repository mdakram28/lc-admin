{
    "username": "ys-y",
    "submission": "class Solution {\nprivate:\n    vector<int> tree;\n\n    int lowBit(int x) {\n        return x & -x;\n    }\n\n    void add(int index, int val) {\n        while (index < tree.size()) {\n            tree[index] += val;\n            index += lowBit(index);\n        }\n    }\n\n    int prefixSum(int index) {\n        int sum = 0;\n        while (index > 0) {\n            sum += tree[index];\n            index -= lowBit(index);\n        }\n        return sum;\n    }\npublic:\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries){\n        int n = nums.size();\n        int m = queries.size();\n        tree.resize(n + 1);\n        vector<int> res;\n        add(1, 0);\n        for(int i = 1; i < n-1;i++) {\n            if(nums[i] > nums[i-1] && nums[i] > nums[i+1]) {\n                add(i+1, 1);\n            }\n            else {\n                add(i+1, 0);\n            }\n        }\n        add(n, 0);\n        for(int i = 0; i < m;i++) {\n            if(queries[i][0] == 1) {\n                if(queries[i][2] - queries[i][1] <2) {\n                    res.push_back(0);\n                    continue;\n                }\n                res.push_back(prefixSum(queries[i][2]) - prefixSum(queries[i][1]+1));\n            }\n            else {\n                int index =  queries[i][1];\n                int val = queries[i][2];\n                vector<int> before(3, 0);\n                vector<int> after(3, 0);\n                for(int i = -1; i <= 1;i++) {\n                    if(index + i <= 0 || index + i >= n-1) {\n                        continue;\n                    }\n                    if(nums[index+i] > nums[index+i-1] && nums[index+i] > nums[index+i+1]) {\n                        before[i+1] = 1;\n                    }\n                }\n                nums[index] = val;\n                for(int i = -1; i <= 1;i++) {\n                    if(index + i <= 0 || index + i >= n-1) {\n                        continue;\n                    }\n                    if(nums[index+i] > nums[index+i-1] && nums[index+i] > nums[index+i+1]) {\n                        after[i+1] = 1;\n                    }\n                }\n                for(int i = -1; i <= 1;i++) {\n                    if(index + i < 0 || index + i > n-1) {\n                        continue;\n                    }\n                    add(index+i+1, after[i+1] - before[i+1]);\n                }\n            }\n        }\n        return res;\n    }\n};\n",
    "submit_ts": "1718508853",
    "subm_id": "539789681"
}