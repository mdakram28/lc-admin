{
    "username": "peng-huai-wei",
    "submission": "class Solution {\npublic:\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n        const int n = nums.size();\n        st = vector<int>(4e+5, 0);\n        build(1, 0, n-1, nums);\n        \n        vector<int> ret;\n        for (const auto &q : queries) {\n            if (q[0] == 1) {\n                if (q[1] + 1 >= q[2]) {\n                    ret.push_back(0);\n                }\n                else {\n                    ret.push_back(query(1, 0, n-1, q[1]+1, q[2]-1));\n                }\n            }\n            else {\n                const int i = q[1];\n                nums[i] = q[2];\n                \n                if (i > 0) {\n                    modify(1, 0, n-1, i-1, nums);\n                }\n                modify(1, 0, n-1, i, nums);\n                if (i + 1 < n) {\n                    modify(1, 0, n-1, i+1, nums);\n                }\n            }\n        }        \n        return ret;\n    }\nprivate:\n    vector<int> st;\n\n    void build(int o, int l, int r, const vector<int> &nums) {\n        if (l == r) {\n            if (l > 0 && r + 1 < nums.size() && nums[l] > nums[l-1] && nums[r] > nums[r+1]) {\n                st[o] = 1;\n            }\n            return;\n        }\n        \n        int m = (l + r) / 2;\n        build(o*2, l, m, nums);\n        build(o*2+1, m+1, r, nums);\n        st[o] = st[o*2] + st[o*2+1];\n    }\n    \n    void modify(int o, int l, int r, int i, const vector<int> &nums) {\n        if (l == r) { // i = l = r\n            if (l > 0 && r + 1 < nums.size() && nums[l] > nums[l-1] && nums[r] > nums[r+1]) {\n                st[o] = 1;\n            }\n            else {\n                st[o] = 0;\n            }\n            return;\n        }\n\n        int m = (l + r) / 2;\n        if (i <= m) modify(o * 2, l, m, i, nums);\n        else modify(o * 2 + 1, m + 1, r, i, nums);\n        st[o] = st[o*2] + st[o*2+1];\n    }\n\n    // \u8fd4\u56de\u533a\u95f4 [L,R] \u5185\u7684\u6700\u5927\u503c\n    int query(int o, int l, int r, int L, int R) { // L \u548c R \u5728\u6574\u4e2a\u9012\u5f52\u8fc7\u7a0b\u4e2d\u5747\u4e0d\u53d8\uff0c\u5c06\u5176\u5927\u5199\uff0c\u89c6\u4f5c\u5e38\u91cf\n        if (L <= l && r <= R) return st[o];\n        int res = 0;\n        int m = (l + r) / 2;\n        if (L <= m) res += query(o * 2, l, m, L, R);\n        if (R > m) res += query(o * 2 + 1, m + 1, r, L, R);\n        return res;\n    }\n};",
    "submit_ts": 1718509303.0
}