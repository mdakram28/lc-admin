{
    "username": "grainmad",
    "submission": "class Solution {\npublic:\n    using ll = long long;\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n        int n = nums.size();\n        vector<ll> BIT(n+5);\n        // ll xBIT[N];\n\n        auto bit_add = [&](int x, ll val) {\n            for (int i=x; i<n+5; i+=i&-i) {\n                BIT[i] += val;       \n            }\n        };\n\n        auto bit_ps = [&](int x) {\n            ll rt = 0;\n            for (int i=x; i>0; i-=i&-i) {\n                rt += BIT[i];\n                // rt += x*BIT[i]-xBIT[i];\n                // \u533a\u95f4\u67e5\u8be2\u65f6 rt += (x+1)*BIT[i]-xBIT[i];\n            }\n            return rt;\n        };\n        auto prt = [&]() {\n            for (int i=1; i<=n; i++) {\n                cout << bit_ps(i)-bit_ps(i-1) << \" \";\n            }\n            cout << \"\\n\";\n        };\n        for (int i=1; i<n-1; i++) {\n            if (nums[i-1] < nums[i] && nums[i] > nums[i+1]) bit_add(i+1, 1);\n        }\n        vector<int> ans;\n        for (auto& i:queries) {\n            int op = i[0];\n            if (i[0] == 1) {\n                int l = i[1]+1, r = i[2]+1;\n                if (l+1<=r-1)\n                    ans.push_back(bit_ps(r-1)-bit_ps(l));\n                else ans.push_back(0);\n            } else {\n                // prt();\n                int idx = i[1]+1, val = i[2];\n                for (int j=idx-1; j<=idx+1; j++) {\n                    if (j!=0 && j!=n && bit_ps(j)-bit_ps(j-1) == 1)\n                        bit_add(j, -1);\n                }\n                // prt();\n                nums[i[1]] = val;\n                for (int j=idx-1; j<=idx+1; j++) {\n                    if (j-1 > 0 && j-1 < n-1 && nums[j-2] < nums[j-1] && nums[j-1] > nums[j]) {\n                        bit_add(j, 1);\n                    }\n                }\n                // prt();\n                // cout<< \"------\\n\";\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1718507900",
    "subm_id": "539784131"
}