{
    "username": "H-R-2004",
    "submission": "class Solution {\npublic:\n    long long fun(vector<int>& v,int l,int r,int k)\n    {\n        map<int,int> fr;\n        long long rt=l,ans=0;\n        for(int i=0;i<31;i++)if(v[l]&(1<<i))fr[i]++;\n        for(int in=l;in<=r;in++)\n        {\n            if(rt<in)\n            {\n                // cout<<\"hr\"<<endl;\n                rt=in;\n                for(int i=0;i<31;i++)if(v[rt]&(1<<i))fr[i]++;\n            }\n            while(1)\n            {\n                int ad=v[in];\n                for(int i=0;i<31;i++)\n                {\n                    if(fr[i]<rt-in+1 && (ad&(1<<i)))ad-=(1<<i);\n                }\n                // if(in==1)cout<<\"lyo\"<<ad<<endl;\n                if(ad!=k && rt<=r)\n                {\n                    rt++;\n                    if(rt<=r)for(int i=0;i<31;i++)if(v[rt]&(1<<i))fr[i]++;\n                }\n                else break;\n            }\n            if(rt>r)break;\n            // cout<<in<<\" \"<<rt<<endl;\n            ans+=r-rt+1;\n            for(int i=0;i<31;i++)if(v[in]&(1<<i))fr[i]--;\n        }\n        return ans;\n    }\n    long long countSubarrays(vector<int>& nums, int k) {\n        int n=nums.size();\n        long long lst=0,ans=0;\n        for(int i=0;i<n;i++)\n        {\n            for(int bt=0;bt<31;bt++)\n            {\n                if(!(nums[i]&(1<<bt)))\n                {\n                    if((k&(1<<bt)))\n                    {\n                        // cout<<i<<\" \"<<lst<<endl;   \n                        if(lst<i)ans+=fun(nums,lst,i-1,k);\n                        lst=i+1;\n                        break;\n                    }\n                }\n                if(bt==30 && i==n-1)ans+=fun(nums,lst,i,k);\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1720280502",
    "subm_id": "1311791771"
}