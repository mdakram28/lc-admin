{
    "username": "Ma_Lin",
    "submission": "class Solution {\npublic:\n    int f[100005], n;\n    vector<int> a;\n    void ins(int p, int d){\n        while (p <= n){\n            f[p] += d;\n            p += (p & (p ^ (p-1)));\n        }        \n    }\n\n    int calc(int p){\n        int v = 0;\n        while (p){\n            v += f[p];\n            p -= (p & (p ^ (p-1))); \n        }\n\n        return v;\n    }\n    \n    bool shi(int i){\n        return (i > 1 && i < n && a[i] > a[i - 1] && a[i] > a[i + 1]);\n    }\n\n    vector<int> countOfPeaks(vector<int>& aa, vector<vector<int>>& Q) {\n        int i, j, r;\n        vector<int> res;\n        a = aa;\n        n = a.size();\n        a.push_back(-1);\n        for (i = n; i >= 1; --i) a[i] = a[i - 1];\n        for (i = 1; i <= n; ++i) f[i] = 0;\n        for (i = 2; i < n; ++i)\n            if (shi(i))\n                ins(i, 1);\n        \n        for (auto q : Q){\n            if (q[0] == 1){\n                ++q[1]; ++q[2];\n                if (q[1] == q[2]) r = 0;\n                else{\n                    r = calc(q[2]) - calc(q[1] - 1);\n                    if (shi(q[1])) --r;\n                    if (shi(q[2])) --r;\n                }\n                \n                res.push_back(r);\n            }\n            else{\n                ++q[1];\n                i = q[1];\n                if (i - 1 >= 1 && shi(i - 1)) ins(i - 1, -1);\n                if (shi(i)) ins(i, -1);\n                if (i + 1 <= n && shi(i + 1)) ins(i + 1, -1);\n                a[i] = q[2];\n                if (i - 1 >= 1 && shi(i - 1)) ins(i - 1, 1);\n                if (shi(i)) ins(i, 1);\n                if (i + 1 <= n && shi(i + 1)) ins(i + 1, 1);\n            }\n        }\n        \n        return res;\n    }\n};",
    "submit_ts": "1718506283",
    "subm_id": "1289613560"
}