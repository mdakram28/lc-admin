{
    "username": "wangyaqi02",
    "submission": "class FenwickTree:\n    def __init__(self, n):\n        self.n = n\n        self.tree = [0] * (n + 1)\n\n    def update(self, idx, delta):\n        while idx <= self.n:\n            self.tree[idx] += delta\n            idx += idx & -idx\n\n    def sum(self, idx):\n        result = 0\n        while idx > 0:\n            result += self.tree[idx]\n            idx -= idx & -idx\n        return result\n\n    def range_sum(self, l, r):\n        return self.sum(r) - self.sum(l - 1)\n\n\nclass Solution:\n    def countOfPeaks(self, nums: List[int], queries: List[List[int]]) -> List[int]:\n        def is_peak(nums, i):\n            return i > 0 and i < len(nums) - 1 and nums[i] > nums[i-1] and nums[i] > nums[i+1]\n        \n        n = len(nums)\n        peaks = [0] * n\n        fenwick = FenwickTree(n)\n        \n        # \u521d\u59cb\u5316peaks\u6570\u7ec4\u548c\u6811\u72b6\u6570\u7ec4\n        for i in range(1, n-1):\n            if is_peak(nums, i):\n                peaks[i] = 1\n                fenwick.update(i + 1, 1)  # \u6811\u72b6\u6570\u7ec4\u662f1-based\n\n        results = []\n        for query in queries:\n            if query[0] == 1:\n                l, r = query[1], query[2]\n                if r > l + 1:\n                    results.append(fenwick.range_sum(l + 2, r))  # \u6839\u636e1-based index\u8c03\u6574\n                else:\n                    results.append(0)\n            elif query[0] == 2:\n                index, value = query[1], query[2]\n                # \u66f4\u65b0nums\u6570\u7ec4\u524d\u4fdd\u5b58\u65e7\u503c\n                old_value = nums[index]\n                nums[index] = value  # \u66f4\u65b0nums\u6570\u7ec4\n\n                # \u68c0\u67e5\u66f4\u65b0\u70b9\u53ca\u5176\u76f8\u90bb\u70b9\u7684\u5cf0\u503c\u72b6\u6001\n                for i in range(max(1, index-1), min(n-1, index+1) + 1):\n                    current_peak_status = is_peak(nums, i)\n                    if peaks[i] != current_peak_status:\n                        peaks[i] = current_peak_status\n                        delta = 1 if current_peak_status else -1\n                        fenwick.update(i + 1, delta)  # \u66f4\u65b0\u6811\u72b6\u6570\u7ec4\n\n        return results",
    "submit_ts": 1718506927.0
}