{
    "username": "sovngarde42",
    "submission": "using ll = long long;\nclass Solution {\npublic:\n\n    long long countSubarrays(vector<int>& nums, int k) {\n        int n = nums.size();\n        \n        vector<vector<vector<int>>> bit(2, vector<vector<int>>(32, vector<int>(n+1,n)));\n        \n        // for (int i = 0; i < 32; ++i) {\n        //     bit[1][i][n] = -1;\n        // }\n        for (int i = n-1; i >= 0; --i) {\n            for (int j = 0; j < 32; j++) {\n                ll idx = 0;\n                if (nums[i] & (1ll << j)) {\n                    idx = 1;\n                    if (i == n-1) {\n                        bit[idx][j][i] = n-1;\n                    } else {\n                        if (nums[i+1] & (1ll << j)) {\n                            bit[idx][j][i] = bit[idx][j][i+1];\n                        } else {\n                            bit[idx][j][i] = i;\n                        }\n                    }\n                    bit[0][j][i] = bit[0][j][i+1];\n                }\n                else {\n                    bit[1][j][i] = bit[1][j][i+1];\n                    bit[0][j][i] = i;\n                }\n\n                \n            }\n        }\n        ll ans = 0;\n        \n        for (int i = 0; i < n; ++i) {\n            ll minzero = i, minone = n-1;\n            if ((nums[i]&k) != k) {\n                continue;\n            }\n            for (int j = 0; j < 32; ++j) {\n                if (k & (1ll << j)) {\n                    minone = min(minone, (ll)bit[1][j][i]);\n                } else {\n                    minzero = max(minzero, (ll)bit[0][j][i]);\n                }\n            }\n            ll d=  max(0ll, minone - minzero+1);\n            // cout <<i << \" \" << d << \"\\n\";\n            ans += d;\n        }\n        \n//         ll acc = 0;\n        \n        \n//         for (int i = 0; i < n; ++i) {\n//             if (nums[i]&k == k) {\n//                 acc++;\n//             } else {\n//                 ans += acc*(acc+1)/2;\n//                 acc = 0;\n//             }\n//         }\n//         ans += acc*(acc+1)/2;\n        return ans;\n    }\n};",
    "submit_ts": "1720280579",
    "subm_id": "1311794625"
}