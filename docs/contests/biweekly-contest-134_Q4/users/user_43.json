{
    "username": "mhasan01",
    "submission": "template<typename T>\nstruct SparseTable {\n    int n;\n    vector<vector<T>> dp;\n    vector<int> prec;\n\n    SparseTable(vector<T>& a) {\n        n = a.size();\n        int len = 1;\n        int k = 0;\n        while (len <= 2 * n) {\n            len <<= 1;\n            ++k;\n        }\n        dp.assign(len, vector<T>(k, 0));\n        prec.assign(len, 0);\n        for (int i = 2; i < 2 * n; i++) {\n            prec[i] = prec[i >> 1] + 1;\n        }\n        for (int i = 0; i < n; i++) {\n            dp[i][0] = a[i];\n        }\n        for (int j = 1; (1 << j) <= n; j++) {\n            for (int i = 0; i < n; i++) {\n                dp[i][j] = combine(dp[i][j - 1], dp[i + (1 << (j - 1))][j - 1]);\n            }\n        }\n    }\n\n    T combine(const T& a, const T& b) {\n        return (a & b);\n    }\n\n    T query(int l, int r) {\n        int k = prec[r - l + 1];\n        return combine(dp[l][k], dp[r - (1 << k) + 1][k]);\n    }\n};\n\nclass Solution {\npublic:\n    long long countSubarrays(vector<int>& a, int k) {\n        SparseTable<int> sp(a);\n        int n = (int) a.size();\n        long long ans = 0;\n        for (int i = 0; i < n; i++) {\n            int lft = -1;\n            {\n                int l = 0, r = i;\n                while (l <= r) {\n                    int mid = (l + r) >> 1;\n                    if (sp.query(mid, i) >= k) {\n                        r = mid - 1;\n                        lft = mid;\n                    } else {\n                        l = mid + 1;\n                    }\n                }\n                if (lft != -1 && sp.query(lft, i) != k) {\n                    lft = -1;\n                }\n            }\n            if (lft != -1) {\n                int l = 0, r = i, rgt = -1;\n                while (l <= r) {\n                    int mid = (l + r) >> 1;\n                    if (sp.query(mid, i) <= k) {\n                        l = mid + 1;\n                        rgt = mid;\n                    } else {\n                        r = mid - 1;\n                    }\n                }\n                ans += 1LL * (rgt - lft + 1);\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1720277458",
    "subm_id": "1311664632"
}