{
    "username": "balakrishnan_v",
    "submission": "#define MAXN 5000\n#define MAXK 50\nclass Solution {\npublic:\n    \n    // max len starting at pos such that last element is x and atmost m pairs can be same\n\n\nint dp[MAXN+2][MAXK+1];\n\nvoid Add(map<int,int>& counts, int v) {\n    counts[v]++;\n}\nvoid Remove(map<int,int>& counts, int v) {\n    counts[v]--;\n    if (counts[v]==0) counts.erase(v);\n}\nint GetMax(map<int,int>& counts) {\n    if (counts.empty()) return 0;\n    return counts.rbegin()->first;\n}\n\nmap<int,int> counts[MAXK+2];\n\nint maximumLength(vector<int>& nums,int k) {\n    int n=nums.size();\n    set<int> uniq;\n    for(int x : nums)  uniq.insert(x);\n    map<int,int> mapping;\n    for(int x : uniq) {\n        int sz=mapping.size();\n        mapping[x]=sz;\n    }\n    for(int& x : nums) x=mapping.at(x);\n    int num_uniq_elements = mapping.size();\n    for(int v=0;v<num_uniq_elements;v++) {\n        for(int m=0;m<=k;m++) {\n            dp[v][m]=0;\n        }\n    }\n    for(int pos=n-1;pos>=0;pos--) {\n        int x = nums[pos];\n            // for(int v=0;v<num_uniq_elements;v++) {\n            //     for(int m=0;m<=k;m++) {\n            //         dp[pos&1][v][m]=dp[(1+pos)&1][v][m];\n            //     }\n            // }\n        \n        // dp[x][m] = max(1+dp[x][m])\n        // dp[x][m] = max(1+dp[y][m-1]) for y != x\n\n\n        for(int m=0;m<=k;m++) {\n            // ndp[x][m] is either dp[x][m]+1\n            // or\n            // ndp[x][m] is max()\n            Remove(counts[m],dp[x][m]);\n            dp[x][m]=1+dp[x][m];\n\n            if (m) {\n\n            Remove(counts[m-1],dp[x][m-1]);\n            dp[x][m]=max(dp[x][m],1+GetMax(counts[m-1]));\n            Add(counts[m-1],dp[x][m-1]);\n            }\n\n            // for(int y=0;y<num_uniq_elements;y++) {\n            //     if (x!=y) {\n            //         dp[x][m]=max(dp[x][m],1+dp[y][m-1]);\n            //     }\n            // }\n            Add(counts[m],dp[x][m]);\n        }\n\n    }\n    int ans=0;\n    for(int v=0;v<n;v++) {\n        for(int j=0;j<=k;j++) {\n            ans=max(ans,dp[v][j]);\n        }\n    }\n    return ans;\n}\n};",
    "submit_ts": 1717861179.0
}