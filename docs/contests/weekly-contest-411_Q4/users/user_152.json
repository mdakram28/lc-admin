{
    "username": "Vedant Adlak",
    "submission": "#define ll long long\n\nclass Solution {\npublic:\n    vector<long long> countKConstraintSubstrings(string s, int k, vector<vector<int>>& queries) {\n        int n = s.size();\n        vector<int> p0(n+1), p1(n+1);\n        for(int i=1; i<=n; i++){\n            p0[i] = p0[i-1];\n            p1[i] = p1[i-1];\n            if(s[i-1]=='0'){\n                p0[i]++;\n            }\n            else{\n                p1[i]++;\n            }\n        }\n        vector<ll> left(n+1), pleft(n+1);\n        for(int i=1; i<=n; i++){\n            ll yes = i, no = 0;\n            while(no+1<yes){\n                ll mid = (no+yes)/2;\n                ll z = p0[i] - p0[mid-1];\n                ll o = p1[i] - p1[mid-1];\n                if(min(z, o) <= k)  yes=mid;\n                else    no=mid;\n            }\n            left[i] = yes;\n            pleft[i] = pleft[i-1] + (i-yes+1);\n        }\n\n        vector<long long> ans;\n        for(auto x: queries){\n            ll l = x[0];\n            ll r = x[1];\n            l++;\n            r++;\n            if(left[r]<=l){\n                ll x = (r-l+2)*(r-l+1)/2;\n                ans.push_back(x);\n            }\n            else{\n                ll yes = l, no = r;\n                while(yes+1 < no){\n                    ll mid = (no+yes)/2;\n                    if(left[mid]>l) no=mid;\n                    else    yes=mid;\n                }\n                // cout<<no<<\" \"<<yes<<\" \"<<pleft[r]<<\" \"<<pleft[no-1]<<\"\\n\";\n                ll x = pleft[r] - pleft[no-1] + (yes-l+2)*(yes-l+1)/2;\n                ans.push_back(x);\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1723952143",
    "subm_id": "1359788969"
}