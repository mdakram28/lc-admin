{
    "username": "ayoimalive",
    "submission": "class Solution {\npublic:\n    #define ll long long\n    int ff(int l,int r,vector<vector<int>> &pre){\n        int len=(r-l+1);\n        int ans=0;\n        for(int i=0;i<30;i++){\n            int cnt=pre[r][i];\n            if(l>0) cnt-=pre[l-1][i];\n            if(cnt==len){\n                ans+=(1<<i);\n            }\n        }\n        return ans;\n    }\n    int f(int i,vector<vector<int>> &pre,int n,int k){\n        int lo=i,hi=n-1;\n        int ind=-1;\n        if(ff(lo,lo,pre)<k) return -1;\n        while(lo<=hi){\n            int mid=(lo+hi)/2;\n            int val=ff(i,mid,pre);\n            if(val>k){\n                lo=mid+1;\n            }\n            else if(val==k){\n                ind=mid;\n                hi=mid-1;\n            }\n            else{\n                // val<k\n                hi=mid-1;\n            }\n        }\n        return ind;\n    }\n     int fin(int i,vector<vector<int>> &pre,int n,int k){\n        int lo=i,hi=n-1;\n        int ind=-1;\n        if(ff(lo,lo,pre)<k) return -1;\n        \n        while(lo<=hi){\n            int mid=(lo+hi)/2;\n            int val=ff(i,mid,pre);\n            // cout<<\"lo: \"<<lo<<\" mid: \"<<mid<<\" hi: \"<<hi<<\" val: \"<<val<<\"\\n\";\n            if(val>k){\n                lo=mid+1;\n            }\n            else if(val==k){\n                ind=mid;\n                lo=mid+1;\n            }\n            else{\n                // val<k\n                hi=mid-1;\n            }\n        }\n        return ind;\n    }\n    long long countSubarrays(vector<int>& nums, int k) {\n       int n=(int)nums.size();\n       vector<vector<int>> bits(n,vector<int>(30,0));\n        for(int i=0;i<n;i++){\n            for(int j=0;j<30;j++){\n                bits[i][j]=(nums[i]>>j)&1;\n                if(i){\n                    bits[i][j]+=bits[i-1][j];\n                }\n            }\n        } \n        ll ans=0LL;\n        for(int i=0;i<n;i++){\n            int start=f(i,bits,n,k);\n            int end=fin(i,bits,n,k);\n            if(start==-1 or end==-1) continue;\n            ans+=1LL*end-1LL*start+1LL;\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1720277544",
    "subm_id": "1311668701"
}