{
    "username": "GaoYusong",
    "submission": "struct VV {\n    int maxi;\n    int maxv;\n    int subi;\n    int subv;\n    \n    VV() {\n        maxi = 0;\n        maxv = 0;\n        subi = 0;\n        subv = 0;\n    }\n};\n\nclass Solution {\npublic:\n    int maximumLength(vector<int>& nums, int m) {\n        int n = nums.size();\n        vector<vector<int>> dp(n, vector<int>(m + 1, 1));\n        vector<VV> pq(m + 1); \n        vector<unordered_map<int, int>> mp(m + 1);\n        \n        int ans = dp[0][m];\n        for (int j = 0; j <= m; j++) {\n            mp[j][nums[0]] = 1;\n            pq[j].maxi = nums[0];\n            pq[j].maxv = 1;\n        }\n        for (int i = 1; i < n; i++) {\n            for (int j = 0; j <= m; j++) {\n\n\n                dp[i][j] = max(dp[i][j], mp[j][nums[i]] + 1);\n                \n                if (j > 0) {\n                    if (pq[j - 1].maxi != nums[i]) {\n                        dp[i][j] = max(dp[i][j], pq[j - 1].maxv + 1);\n                    } else {\n                        dp[i][j] = max(dp[i][j], pq[j - 1].subv + 1);\n                    }\n                }\n                \n                int val = mp[j][nums[i]] = max(mp[j][nums[i]], dp[i][j]);\n                \n                if (nums[i] == pq[j].maxi) {\n                    pq[j].maxv = max(pq[j].maxv, val);\n                } else if (nums[i] == pq[j].subi) {\n                    pq[j].subv = max(pq[j].subv, val);\n                    if (pq[j].subv > pq[j].maxv) {\n                        swap(pq[j].maxv, pq[j].subv);\n                        swap(pq[j].maxi, pq[j].subi);\n                    }\n                } else {\n                    if (val > pq[j].maxv) {\n                        pq[j].subv = pq[j].maxv;\n                        pq[j].subi = pq[j].maxi;\n                        pq[j].maxv = val;\n                        pq[j].maxi = nums[i];\n                    } else if (val > pq[j].subv) {\n                        pq[j].subv = val;\n                        pq[j].subi = nums[i];\n                    }\n                }\n            }\n\n            ans = max(ans, dp[i][m]);\n        }\n        return ans;\n\n    }\n};\n",
    "submit_ts": "1717861001",
    "subm_id": "1281776401"
}