{
    "username": "user5860c",
    "submission": "typedef long long ll;\ntypedef vector<int> vi;\ntypedef pair<int,int> pii;\ntypedef pair<double, double> pdd;\n#define pb push_back\n#define mp make_pair\n#define fs first\n#define sc second\n#define rep(i, from, to) for (int i = from; i < (to); ++i)\n#define all(x) x.begin(), x.end()\n#define sz(x) (int)(x).size()\n#define FOR(i, to) for (int i = 0; i < (to); ++i)\ntypedef vector<vector<int> > vvi;\ntypedef vector<ll> vll;\ntypedef vector<vll> vvll;\ntypedef vector<pair<int, int> > vpi;\ntypedef pair<ll,ll> pll;\ntypedef vector<string> vs;\nset<pii> l[55];\nunordered_map<int,int> h[55];\nclass Solution {\npublic:\n    int maximumLength(vector<int>& nums, int K) {\n        FOR(i, K + 1) {\n            l[i].clear();\n            h[i].clear();\n        }\n        for (auto x : nums) {\n            FOR(k, K + 1) {\n                l[k].erase({h[k][x], x});\n                ++h[k][x];\n                l[k].insert({h[k][x], x});\n                if (k) {\n                    auto prev = l[k-1].end();\n                    --prev;\n                    if (sz(l[k-1]) == 1 && prev->sc == x) continue;\n                    if (prev->sc == x) --prev;\n                    int b = 1 + prev->fs;\n                    if (h[k][x] == 0) {\n                        h[k][x] = b;\n                        l[k].insert({b, x});\n                    }\n                    if (h[k][x] < b) {\n                        l[k].erase({h[k][x], x});\n                        h[k][x] = b;\n                        l[k].insert({h[k][x], x});\n                    }\n                }\n            }\n        }\n        int ret = 0;\n        FOR(i, K + 1) {\n            if (sz(l[i])) {\n                auto it = l[i].end();\n                --it;\n                ret = max(ret, it->fs);\n            }\n        }\n        return ret;\n    }\n};",
    "submit_ts": 1717860556.0
}