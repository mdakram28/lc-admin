{
    "username": "wenboz",
    "submission": "class Solution {\n    int mod = (int) 1e9 + 7;\n    public int maximumSumSubsequence(int[] nums, int[][] queries) {\n        int n = nums.length, q = queries.length;\n        long res = 0;\n        var seg = new SegmentTreeHr(nums);\n        for(int i = 0; i < q; i++){\n            seg.update(queries[i][0], (long)queries[i][1]);\n            res += seg.query();\n            res %= mod;\n        }\n        return (int) res;\n    }\n    \n\npublic class SegmentTreeHr {\n\n    int N;\n    long[] seg;\n    long[] segnr;\n    long[] segnl;\n    long[] segnlr;\n\n    public SegmentTreeHr(int[] nums){\n        N = Math.max(1, Integer.highestOneBit(nums.length - 1) << 1);\n        seg = new long[2*N];\n        segnr = new long[2*N];\n        segnl = new long[2*N];\n        segnlr = new long[2*N];\n        for(int i = 0; i < nums.length; i++){\n            seg[i + N] = Math.max(0, nums[i]);\n        }\n        for(int i = N - 1; i > 0; i--){\n            seg[i] = Math.max(seg[2*i] + segnl[2*i + 1], segnr[2*i] + seg[2*i + 1]);\n            seg[i] %= mod;\n            segnr[i] = Math.max(seg[2*i] + segnlr[2*i + 1], segnr[2*i] + segnr[2*i + 1]);\n            segnr[i] %= mod;\n            segnl[i] = Math.max(segnl[2*i] + segnl[2*i + 1], segnlr[2*i] + seg[2*i + 1]);\n            segnl[i] %= mod;\n            segnlr[i] = Math.max(segnl[2*i] + segnlr[2*i + 1], segnlr[2*i] + segnr[2*i + 1]);\n            segnlr[i] %= mod;\n        }\n    }\n    \n    long query(){\n        return seg[1];\n    }\n\n    long query(int ql, int qh){\n        return query(0, N - 1, 1, ql, qh);\n    }\n    long query(int l, int h, int i, int ql, int qh){\n        if(h < ql || l > qh)\n            return 0;\n        if(l >= ql && h <= qh){\n            return seg[i];\n        }\n        int m = l + (h - l)/2;\n        return query(l, m, 2*i, ql, qh) + query(m + 1, h, 2*i + 1, ql, qh);\n    }\n\n    void update(int i, long v){\n        i += N;\n        seg[i] = Math.max(0, v);\n        while(i > 1){\n            i /= 2;\n            seg[i] = Math.max(seg[2*i] + segnl[2*i + 1], segnr[2*i] + seg[2*i + 1]);\n            seg[i] %= mod;\n            segnr[i] = Math.max(seg[2*i] + segnlr[2*i + 1], segnr[2*i] + segnr[2*i + 1]);\n            segnr[i] %= mod;\n            segnl[i] = Math.max(segnl[2*i] + segnl[2*i + 1], segnlr[2*i] + seg[2*i + 1]);\n            segnl[i] %= mod;\n            segnlr[i] = Math.max(segnl[2*i] + segnlr[2*i + 1], segnlr[2*i] + segnr[2*i + 1]);\n            segnlr[i] %= mod;\n        }\n    }\n\n}\n}",
    "submit_ts": 1716693961.0
}