{
    "username": "\u672a\u6765\u53f2\u8482\u592b",
    "submission": "class Solution {\npublic:\n    vector<long long> countKConstraintSubstrings(string s, int k, vector<vector<int>>& queries) {\n        int n=s.size();\n        vector<vector<int>>pre(n+1,vector<int>(2));\n        for(int i=0;i<n;i++){\n            pre[i+1]=pre[i];\n            pre[i+1][s[i]-'0']++;\n        }\n        auto check=[&](int l,int r){\n            return pre[r+1][0]-pre[l][0]<=k||pre[r+1][1]-pre[l][1]<=k;\n        };\n        vector<long long>ans;\n        vector<int>rr(n);\n        for(int i=0;i<n;i++){\n            int l=i,r=n-1;\n            while(l<=r){\n                int mid=l+r>>1;\n                if(check(i,mid))l=mid+1;\n                else r=mid-1;\n            }\n            rr[i]=l;\n        }\n        vector<long long>ss(n+1);\n        for(int i=1;i<=n;i++)ss[i]=ss[i-1]+rr[i-1]-i+1;\n        for(auto q:queries){\n            int l=q[0],r=q[1];\n            if(check(l,r)){\n                int len=r-l+1;\n                long long res=1ll*(len+1)*len/2;\n                ans.push_back(res);\n            }\n            else {\n                int xl=l,xr=r;\n                while(xl<=xr){\n                    int mid=xl+xr>>1;\n                    if(check(mid,r))xr=mid-1;\n                    else xl=mid+1;\n                }\n                int len=r-xl+1;\n                long long res=1ll*(len+1)*len/2;\n                res+=ss[xl]-ss[l];\n                ans.push_back(res);\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1723951527",
    "subm_id": "556406013"
}