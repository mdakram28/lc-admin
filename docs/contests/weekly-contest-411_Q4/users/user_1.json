{
    "username": "fjzzq2002",
    "submission": "#include <bits/stdc++.h>\nusing namespace std;\n#define pb push_back\n#define mp make_pair\n#define fi first\n#define se second\n#define ll long long\n#define pii pair<int,int>\n#define vi vector<int>\n#define all(x) (x).begin(),(x).end()\n#define mem(a,b) memset(a,b,sizeof(a))\n#define SZ 100099\nstruct Bit {\nll b[SZ];\nvoid add(int x,ll y) {\n    ++x;\n    for(;x<SZ;x+=x&-x) b[x]+=y;\n}\nvoid clr(int x) {\n    ++x;\n    for(;x<SZ;x+=x&-x) b[x]=0;\n}\nll qry(int r) {\n    ++r;\n    ll ret=0;\n    for(;r;r-=r&-r) ret+=b[r];\n    return ret;\n}\nll qry(int l,int r) {\n    return qry(r)-qry(l-1);\n}\n}Q00,Q01,Q10;\nclass Solution {\npublic:\n    vector<ll> countKConstraintSubstrings(string s, int k, vector<vector<int>>& queries) {\n        int n=s.size();\n        static int s0[SZ],s1[SZ];\n        for(int i=0;i<s.size();++i)\n            s0[i+1]=s0[i]+(s[i]=='0'),\n            s1[i+1]=s1[i]+(s[i]=='1');\n        #define c0(l,r) (s0[(r)+1]-s0[(l)])\n        #define c1(l,r) (s1[(r)+1]-s1[(l)])\n        vector<int> bad[SZ];\n        vector<pii> qs[SZ];\n        vector<ll> ans(queries.size());\n        for(int i=0;i<queries.size();++i)\n            qs[queries[i][1]].pb(mp(queries[i][0],i));\n        int r=0;\n        for(int i=0;i<n;++i) {\n            while(r<n&&(c0(i,r)<=k||c1(i,r)<=k)) ++r;\n            bad[r].pb(i);\n        }\n        for(int i=0;i<s.size();++i) {\n            Q00.add(i,1);\n            Q01.add(i,i-1);\n            for(auto t:bad[i]) {\n                Q00.add(t,-1);\n                Q01.add(t,-(t-1));\n                Q10.add(t,i-t);\n            }\n            for(auto q:qs[i]) {\n                int L=q.fi,R=i,Q=q.se;\n                ans[Q]=Q00.qry(L,R)*i-Q01.qry(L,R)+Q10.qry(L,R);\n            }\n        }\n        for(int i=0;i<s.size();++i) Q00.clr(i),Q01.clr(i),Q10.clr(i);\n        return ans;\n    }\n};",
    "submit_ts": "1723949307",
    "subm_id": "1359716030"
}