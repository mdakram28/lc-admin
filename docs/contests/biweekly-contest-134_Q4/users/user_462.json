{
    "username": "lian-xu-han-shu",
    "submission": "const int N=1e5+10,M=32;\nclass Solution {\n    typedef long long LL;\n    LL s[N][M];\npublic:\n    long long countSubarrays(vector<int>& nums, int k) {\n        LL ans=0;\n        int n=nums.size();\n        for(int i=1;i<=n;i++)\n        {\n            int v=nums[i-1];\n            for(int j=0;j<30;j++)\n            {\n                s[i][j]=s[i-1][j];\n                if((v>>j)&1)s[i][j]++;\n            }\n        }\n        \n        for(int i=1;i<=n;i++)\n        {\n            int v=nums[i-1];\n            int mn=1e9,mx=0;\n            bool ok=true;\n            int x,y;\n            for(int j=0;j<30;j++)\n            {\n                x=(k>>j)&1,y=(v>>j)&1;\n                if(x==0){\n                    if(y==0)mn=min(mn,i);\n                    else {\n                        int l=0,r=i;\n                        while(l<r){\n                            int mid=l+r>>1;\n                            if(s[i][j]-s[mid][j]==i-mid)r=mid;\n                            else l=mid+1;\n                        }\n                        mn=min(mn,r);\n                    }\n                }else {\n                    if(y==1){\n                        int l=0,r=i;\n                        while(l<r){\n                            int mid=l+r>>1;\n                            if(s[i][j]-s[mid][j]==i-mid)r=mid;\n                            else l=mid+1;\n                        }\n                        mx=max(mx,r);\n                    }else {\n                        ok=false;\n                        break;\n                    }\n                }\n            }\n            if(ok){\n                ans+=max(0,mn-mx);\n            }\n        }\n        \n        return ans;\n    }\n};",
    "submit_ts": "1720279005",
    "subm_id": "544565477"
}