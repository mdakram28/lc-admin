{
    "username": "dream_boy",
    "submission": "class PST {\n    int n;\n    vector<int> t, a;\n\n    void build(int v, int tl, int tr) {\n        if (tl == tr) {\n            t[v] = 0 < tl && tl < n - 1 ? a[tl] > a[tl - 1] && a[tl] > a[tl + 1] : 0;\n        }\n        else {\n            int tm = (tl + tr) >> 1;\n            build(v << 1, tl, tm);\n            build(v << 1 | 1, tm + 1, tr);\n            t[v] = t[v << 1] + t[v << 1 | 1];\n        }\n    }\n\n    void update(int v, int tl, int tr, int p, int x) {\n        if (tl == tr) {\n            a[p] = x;\n            t[v] = 0 < tl && tl < n - 1 ? a[tl] > a[tl - 1] && a[tl] > a[tl + 1] : 0;\n        }\n        else {\n            int tm = (tl + tr) >> 1;\n            if (p <= tm) update(v << 1, tl, tm, p, x);\n            else update(v << 1 | 1, tm + 1, tr, p, x);\n            t[v] = t[v << 1] + t[v << 1 | 1];\n        }\n    }\n\n    int query(int v, int tl, int tr, int l, int r) {\n        if (l > r) return 0;\n        if (l <= tl && tr <= r) return t[v];\n        int tm = (tl + tr) >> 1;\n        return query(v << 1, tl, tm, l, min(r, tm)) + query(v << 1 | 1, tm + 1, tr, max(l, tm + 1), r);\n    }\n\npublic:\n    PST(vector<int>& nums) {\n        n = nums.size();\n        a = nums;\n\n        t.resize(4 * n);\n        build(1, 0, n - 1);\n    }\n\n    void update(int p, int x) {\n        update(1, 0, n - 1, p, x);\n        if (p > 0) update(1, 0, n - 1, p - 1, a[p - 1]);\n        if (p < n - 1) update(1, 0, n - 1, p + 1, a[p + 1]);\n    }\n\n    int query(int l, int r) {\n        return query(1, 0, n - 1, l, r);\n    }\n};\n\n\nclass Solution {\npublic:\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n        int n = nums.size();\n        vector<int> ans;\n        PST pst(nums);\n        for (auto& q : queries)\n            if (q[0] == 1) {\n                int l = q[1], r = q[2];\n                ans.push_back(pst.query(l+1, r-1));\n            }\n            else {\n                int p = q[1], x = q[2];\n                pst.update(p, x);\n            }\n\n        return ans;\n    }\n};",
    "submit_ts": "1718506867",
    "subm_id": "1289633546"
}