{
    "username": "kzyKT",
    "submission": "#define F first\n#define S second\n#define R cin>>\n#define ll long long\n#define ln cout<<'\\n'\n#define in(a) insert(a)\n#define pb(a) push_back(a)\n#define pd(a) printf(\"%.10f\\n\",a)\n#define mem(a) memset(a,0,sizeof(a))\n#define all(c) (c).begin(),(c).end()\n#define iter(c) __typeof((c).begin())\n#define rrep(i,n) for(ll i=(ll)(n)-1;i>=0;i--)\n#define REP(i,m,n) for(ll i=(ll)(m);i<(ll)(n);i++)\n#define rep(i,n) REP(i,0,n)\n#define tr(it,c) for(iter(c) it=(c).begin();it!=(c).end();it++)\nll check(ll n,ll m,ll x,ll y){return x>=0&&x<n&&y>=0&&y<m;}void pr(){ln;}\ntemplate<class A,class...B>void pr(const A &a,const B&...b){cout<<a<<(sizeof...(b)?\" \":\"\");pr(b...);}\ntemplate<class A>void PR(A a,ll n){rep(i,n){if(i)cout<<' ';cout<<a[i];}ln;}\nconst ll MAX=1e9+7,MAXL=1LL<<61,dx[8]={-1,0,1,0,-1,-1,1,1},dy[8]={0,1,0,-1,-1,1,1,-1};\ntypedef pair<ll,ll> P;\n\nclass RMQ2{\npublic:\n  ll n,dat[25555];\n  void init(ll _n){\n    n=1;\n    while(n<_n)n*=2;\n    fill(dat,dat+2*n-1,-MAX);\n  }\n  void update(ll k,ll a){\n    k+=n-1;dat[k]=a;\n    while(k>0){\n      k=(k-1)/2;\n      dat[k]=max(dat[k*2+1],dat[k*2+2]);\n    }\n  }\n  ll query(ll a,ll b){return query(a,b,0,0,n);}\n  ll query(ll a,ll b,ll k,ll l,ll r){\n    if(r<=a||b<=l) return -MAX;\n    if(a<=l&&r<=b) return dat[k];\n    ll vl=query(a,b,k*2+1,l,(l+r)/2);\n    ll vr=query(a,b,k*2+2,(l+r)/2,r);\n    return max(vl,vr);\n  }\n};\n\nRMQ2 t[55];\n\nclass Solution {\npublic:\n  int maximumLength(vector<int>& a, int m) {\n    ll n=a.size(),N;\n    {\n      set<ll> s;\n      rep(i,n) s.in(a[i]);\n      map<ll,ll> ma;\n      tr(it,s) {\n        ll k=ma.size();\n        ma[*it]=k;\n      }\n      rep(i,n) a[i]=ma[a[i]];\n      N=ma.size();\n    }\n    rep(i,m+2) t[i].init(N+1);\n    rep(i,n) {\n      rrep(j,m+1) {\n        if(j+1<=m) {\n          ll x=t[j+1].query(a[i],a[i]+1);\n          ll d1=t[j].query(0,a[i]);\n          ll d2=t[j].query(a[i]+1,N);\n          t[j+1].update(a[i],max({x,d1+1,d2+1}));\n        }\n        {\n          ll x=t[j].query(a[i],a[i]+1);\n          t[j].update(a[i],x+1);\n        }\n      }\n      {\n        ll x=t[0].query(a[i],a[i]+1);\n        t[0].update(a[i],max(x,1LL));\n      }\n    }\n    ll ans=0;\n    rep(j,m+1) ans=max(ans,t[j].query(0,N));\n    return (int)ans;\n  }\n};",
    "submit_ts": 1717859033.0
}