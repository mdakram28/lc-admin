{
    "username": "WAWA\u9c7c",
    "submission": "class Solution {\npublic:\n    long long  R[100010],cnt1[100010]={},cnt0[100010]={},sumr[100010];\n    vector<long long> countKConstraintSubstrings(string s, int k, vector<vector<int>>& queries) {\n        vector<long long >a;\n        long long n = s.size();\n        s=' '+s;        \n        for(long long i=1;i<=n;i++)\n        {\n            cnt1[i]=cnt1[i-1];\n            cnt0[i]=cnt0[i-1];\n            if(s[i]=='1')\n                cnt1[i]++;\n            if(s[i]=='0')\n                cnt0[i]++;\n        }\n        for(long long i=1;i<=n;i++)\n        {\n            R[i]=0;\n            if(cnt1[n]-cnt1[i-1]>k)\n                R[i]=upper_bound(cnt1+1,cnt1+1+n,cnt1[i-1]+k)-cnt1-1;\n            else\n                R[i]=n;\n            if(cnt0[n]-cnt0[i-1]>k)\n                R[i]=max(R[i],(long long)(upper_bound(cnt0+1,cnt0+1+n,cnt0[i-1]+k)-cnt0-1));\n            else\n                R[i]=n;\n            sumr[i]=sumr[i-1]+R[i]-i+1;\n        }\n        for(long long i=0;i<queries.size();i++)\n        {\n            long long l=queries[i][0]+1;\n            long long r=queries[i][1]+1;\n            if(R[r]<=r)\n                a.push_back(sumr[r]-sumr[l-1]);\n            else if(R[l]>=r)\n                a.push_back((2+r-l)*(r-l+1)/2);\n            else\n            {\n                long long pos=lower_bound(R+l,R+r+1,r)-R;\n                a.push_back(sumr[pos-1]-sumr[l-1]+(2+r-pos)*(r-pos+1)/2);\n            }\n        }\n        return a;\n    }\n};",
    "submit_ts": "1723952011",
    "subm_id": "556409063"
}