{
    "username": "Camellia_y",
    "submission": "class Solution {\npublic:\n    vector<long long> countKConstraintSubstrings(string s, int k, vector<vector<int>>& queries) {\n        long long cnt0 = 0,cnt1 = 0;\n        int n = s.size();\n        vector<int> R(n);\n        for(int i = 0,j = 0;i < s.size();++i)\n        {\n            while(j < s.size() && ((cnt0 + (s[j] == '0')) <= k || (cnt1 + (s[j] == '1')) <= k))\n            {\n                cnt1 += s[j] == '1';\n                cnt0 += s[j] == '0';\n                j++;\n            }\n            R[i] = j - 1;\n            cnt1 -= s[i] == '1';\n            cnt0 -= s[i] == '0';\n        }\n        vector<long long> ans(queries.size());\n        vector<long long> ss(n);\n        for(int i = 0;i < n;++i)\n        {\n            if(!i)ss[i] = R[i] + 1;\n            else ss[i] = ss[i - 1] + R[i] - i + 1;\n        }\n        for(int i = 0;i < queries.size();++i)\n        {\n            int l = queries[i][0],r = queries[i][1];\n            if(R[r] <= r)\n            {\n                if(l)ans[i] += ss[r] - ss[l - 1];\n                else ans[i] += ss[r];\n            }else{\n                int p = upper_bound(R.begin() + l,R.begin() + r + 1,r) - R.begin();\n                if(!l && p > l)ans[i] += ss[p - 1];\n                else if(l && p > l)ans[i] += ss[p - 1] - ss[l - 1];\n                ans[i] += 1LL*(r - p + 1)*(r - p + 2)/2;\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1723951313",
    "subm_id": "556404628"
}