{
    "username": "cai-liao-xian-zhi",
    "submission": "class Solution {\npublic:\n    static const int N = 1e5+3;\n    int tree[N<<2];\n    bool a[N];\n    void build(int i,int l,int r){\n        if(l==r){\n            tree[i] = a[l];\n            return;\n        }\n        int m = (l+r)>>1;\n        build(i<<1,l,m);\n        build(i<<1|1,m+1,r);\n        tree[i] = tree[i<<1]+tree[i<<1|1];\n    }\n    void update(int i,int l,int r,int p,bool x){\n        if(l==r){\n            tree[i] = x;\n            return;\n        }\n        int m = (l+r)>>1;\n        if(p>=l&&p<=m)update(i<<1,l,m,p,x);\n        else if(p>m&&p<=r)update(i<<1|1,m+1,r,p,x);\n        tree[i] = tree[i<<1]+tree[i<<1|1];\n    }\n    int query(int i,int l,int r,int L,int R){\n        if(l>=L&&r<=R)return tree[i];\n        int ans = 0, m = (l+r)>>1;\n        if(m>=L&&l<=R)ans += query(i<<1,l,m,L,R);\n        if(m+1<=R&&r>=L)ans += query(i<<1|1,m+1,r,L,R);\n        return ans;\n    }\n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n        int n = nums.size();\n        for(int i=1;i+1<n;++i){\n            a[i] = (nums[i]>nums[i-1])&&(nums[i]>nums[i+1]);\n        }\n        build(1,0,n-1);\n        vector<int>ans;\n        for(const auto &p:queries){\n            if(p[0]==1)ans.emplace_back(query(1,0,n-1,p[1],p[2])-a[p[1]]-(p[2]>p[1]?a[p[2]]:0));\n            else{\n                int x = p[1];\n                nums[x] = p[2];\n                if(x>0&&x<n-1){\n                    bool f = nums[x]>nums[x-1]&&nums[x]>nums[x+1];\n                    if(a[x]!=f){\n                        a[x] = f;\n                        update(1,0,n-1,x,f);\n                    }\n                }\n                if(x>1){\n                    bool f = nums[x-1]>nums[x-2]&&nums[x-1]>nums[x];\n                    if(a[x-1]!=f){\n                        a[x-1] = f;\n                        update(1,0,n-1,x-1,f);\n                    }\n                }\n                if(x<n-2){\n                    bool f = nums[x+1]>nums[x+2]&&nums[x+1]>nums[x];\n                    if(a[x+1]!=f){\n                        a[x+1] = f;\n                        update(1,0,n-1,x+1,f);\n                    }\n                }\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1718508302",
    "subm_id": "539786572"
}