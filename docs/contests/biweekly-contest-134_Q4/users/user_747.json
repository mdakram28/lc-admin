{
    "username": "xyzabcdef",
    "submission": "class Solution {\npublic:\n    long long countSubarrays(vector<int>& nums, int k) {\n        using ll = long long;\n        int n = nums.size();\n        vector<vector<int>>pref(n+1, vector<int>(32, 0));\n        for(int i = 1; i <= n; i++){\n            for(int j = 0; j < 30; j++){\n                pref[i][j] = pref[i-1][j] + ((nums[i-1]>>j)&1);\n            }\n        }\n        auto get_and = [&](int x, int y){\n            ++x, ++y;\n            int p = y - x + 1, val = 0;\n            for(int i = 0; i < 30; i++){\n                int m = pref[y][i] - pref[x-1][i];\n                if(m == p){\n                    val |= (1<<i);\n                }\n            }\n            // cout<<x<<\" \"<<y<<\" \"<<val<<'\\n';\n            return val;\n        };\n        auto first_pos = [&](int x){\n            ll l = x, r = n-1, res = n;\n            while(l <= r){\n                // cout<<l<<\" \"<<r<<'\\n';\n                int mid = (l+r)/2;\n                int _and = get_and(x, mid);\n                if(_and == k){\n                    res = mid; r = mid-1;\n                } else if((_and&k) == k){\n                    l = mid+1;\n                } else{\n                    r = mid-1;\n                }\n            }\n            return res;\n        };\n        auto last_pos = [&](int x){\n            ll l = x, r = n-1, res = n;\n            while(l <= r){\n                int mid = (l+r)/2;\n                int _and = get_and(x, mid);\n                if(_and == k){\n                    res = mid; l = mid+1;\n                } else if((_and&k) == k){\n                    l = mid+1;\n                } else{\n                    r = mid-1;\n                }\n            }\n            return res;\n        };\n        ll ans = 0;\n        for(int i = 0; i < n; i++){\n            int fp = first_pos(i);\n            if(fp != n){\n                ans += (ll)(last_pos(i) - fp + 1);\n            }\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1720279435",
    "subm_id": "1311751073"
}