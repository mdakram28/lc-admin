{
    "username": "Gluk",
    "submission": "class Solution {\npublic:\n    vector<long long> countKConstraintSubstrings(string s, int k, vector<vector<int>>& queries) {\n        int n = s.size();\n        vector<int> r(n);\n        vector<long long> rs(n+1);\n        \n        vector<int> a0;\n        vector<int> a1;\n        \n        for (int i=0; i<n; ++i) {\n            if (s[i] == '0')\n                a0.push_back(i);\n            else\n                a1.push_back(i);\n        }\n        \n        int x0 = 0;\n        int x1 = 0;\n        for (int i=0; i<n; ++i) {\n            while (x0 < a0.size() && a0[x0] < i) ++x0;\n            while (x1 < a1.size() && a1[x1] < i) ++x1;\n            auto r1 = x0 + k < a0.size() ? a0[x0+k] : n;\n            auto r2 = x1 + k < a1.size() ? a1[x1+k] : n;\n            r[i] = max(r1,r2)-i;\n            rs[i+1] = rs[i] + r[i];\n        }\n        \n        vector<long long> ret;\n        \n        for (auto& q : queries) {\n            int qx = q[0];\n            int qy = q[1];\n            \n            int X = qx-1;\n            int Y = qy;\n            \n            while (X < Y) {\n                int Z = (X+Y+1)/2;\n                if (Z + r[Z] - 1 <= qy) {\n                    X = Z;\n                } else {\n                    Y = Z-1;\n                }\n            }\n            \n            //cout << qx << \" \" << X << \" \" << qy << endl;\n            \n            long long rr = qy-X;\n            rr = rr * (rr+1)/2;\n            \n            rr += rs[X+1]-rs[qx];\n            \n            ret.push_back(rr);\n        }\n        \n        return ret;\n    }\n};",
    "submit_ts": "1723951231",
    "subm_id": "1359766534"
}