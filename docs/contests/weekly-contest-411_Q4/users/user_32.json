{
    "username": "Vibrant MayerHCt",
    "submission": "class Solution {\npublic:\n    vector<long long> countKConstraintSubstrings(string s, int k, vector<vector<int>>& qs) {\n        #define ll long long\n        int n=s.size();\n        vector<int> lf(n,0);\n        vector<int> rg(n,0);\n        for(int i=0,j=0,c0=0,c1=0;i<n;++i){\n            j=max(i,j);\n            while(j<n&&(c0<=k||c1<=k)){\n                if(s[j]=='0')\n                    ++c0;\n                else\n                    ++c1;\n                ++j;\n            }\n            if(c0>k&&c1>k)\n                lf[i]=j-2;\n            else\n                lf[i]=j-1;\n            if(j>i){\n                if(s[i]=='0')\n                    --c0;\n                else\n                    --c1;\n            }\n        }\n        for(int i=n-1,j=n-1,c0=0,c1=0;i>=0;--i){\n            j=min(i,j);\n            while(j>=0&&(c0<=k||c1<=k)){\n                if(s[j]=='0')\n                    ++c0;\n                else\n                    ++c1;\n                --j;\n            }\n            if(c0>k&&c1>k)\n                rg[i]=j+2;\n            else\n                rg[i]=j+1;\n            if(j<i){\n                if(s[i]=='0')\n                    --c0;\n                else\n                    --c1;\n            }\n        }\n        int m=qs.size();\n        constexpr int B=320;\n        struct ppp{\n            int l,r;\n            int id;\n            bool operator<(const ppp &o) const{\n                if(l/B!=o.l/B)\n                    return l<o.l;\n                return r<o.r;\n            }\n        };\n        vector<ppp> a(m);\n        for(int i=0;i<m;++i){\n            auto &v=qs[i];\n            auto x=v[0];\n            auto y=v[1];\n            a[i]={x,y,i};\n        }\n        sort(a.begin(),a.end());\n        ll res=0;\n        vector<ll> ans(m);\n        for(int i=0,l=1,r=0;i<m;++i){\n            while(r<a[i].r){\n                ++r;\n                int x=max(rg[r],l);\n                res+=r-x+1;\n            }\n            while(r>a[i].r){\n                int x=max(rg[r],l);\n                res-=r-x+1;\n                --r;\n            }\n            while(l<a[i].l){\n                int x=min(lf[l],r);\n                res-=x-l+1;\n                ++l;\n            }\n            while(l>a[i].l){\n                --l;\n                int x=min(lf[l],r);\n                res+=x-l+1;\n            }\n            ans[a[i].id]=res;\n        }\n        return ans;\n    }\n};",
    "submit_ts": "1723951432",
    "subm_id": "556405397"
}