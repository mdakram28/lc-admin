{
    "username": "duong2803",
    "submission": "int st[5005 * 4][55];\nint n;\nclass Solution {\npublic:\n\n    void build(int i, int l = 0, int r = n - 1, int idx = 0){\n        if(l == r){\n            st[idx][i] = 0;\n            return;\n        }\n        int m = l + r >> 1;\n        build(i, l, m, idx * 2 + 1);\n        build(i, m + 1, r, idx * 2 + 2);\n        st[idx][i] = max(st[idx * 2 + 1][i], st[idx * 2 + 2][i]);\n    }\n\n    int qry(int l, int r, int i, int tl = 0, int tr = n - 1, int idx = 0){\n        if(tl > r || tr < l) return 0;\n        if(tl >= l && tr <= r) return st[idx][i];\n        int tm = tl + tr >> 1;\n        return max(qry(l, r, i, tl, tm, idx * 2 + 1), qry(l, r, i, tm + 1, tr, idx * 2 + 2));\n    }\n\n    void upd(int p, int x, int i, int tl = 0, int tr = n - 1, int idx = 0){\n        if(tl == tr){\n            st[idx][i] = max(st[idx][i], x);\n            return;\n        }\n        int tm = tl + tr >> 1;\n        if(p <= tm)\n            upd(p, x, i, tl, tm, idx * 2 + 1);\n        else\n            upd(p, x, i, tm + 1, tr, idx * 2 + 2);\n        st[idx][i] = max(st[idx * 2 + 1][i], st[idx * 2 + 2][i]);\n    }\n\n    int maximumLength(vector<int>& a, int k) {\n        n = a.size();\n        vector<vector<int>> dp(n, vector<int>(k + 1, -n));\n        map<int, map<int, int>> mp;\n        for(int i = 0; i <= k; ++i)\n            build(i);\n        int res = 0;\n        for(int i = 0; i < n; ++i){\n            upd(i, 1, 0);\n            // dp[i][0] = 1;\n            for(int j = 0; j <= k; ++j){\n                // for(int x = i - 1; x >= 0; --x){\n                //     int nj = j;\n                //     if(a[i] != a[x]) --nj;\n                //     if(nj >= 0)\n                //         dp[i][j] = max(dp[i][j], dp[x][nj] + 1);\n                // }\n                if(i - 1 >= 0 && j - 1 >= 0){\n                    int x = qry(0, i - 1, j - 1);\n                    int y = mp[a[i]][j];\n                    int nval = max(x, y) + 1;\n                    upd(i, nval, j);\n                }else{\n                    upd(i, mp[a[i]][j] + 1, j);\n                }\n                int val = qry(i, i, j);\n                mp[a[i]][j] = max(mp[a[i]][j], val);\n                res = max(res, val);\n            }\n        }\n        return res;\n    }\n};",
    "submit_ts": "1717860882",
    "subm_id": "1281772559"
}