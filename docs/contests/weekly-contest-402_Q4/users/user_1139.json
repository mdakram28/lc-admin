{
    "username": "LayzerK",
    "submission": "class BIT:\n    def __init__(self, n):\n        self.sums = [0] * (n+1)\n    \n    def update(self, i, delta):\n        i += 1\n        while i < len(self.sums):\n            \n            self.sums[i] += delta\n            i += i & (-i)\n             \n    \n    def query(self, i):\n        #print(i, \"here\")\n        i += 1\n        res = 0\n        while i > 0:\n            #print(i)\n            res += self.sums[i]\n            i -= i & (-i)\n        return res\n\nclass Solution:\n    def countOfPeaks(self, nums: List[int], queries: List[List[int]]) -> List[int]:\n        n = len(nums)\n        fenny = BIT(n)\n        mtn = [0] * n\n        for i in range(1, len(nums)-1):\n            if nums[i] > nums[i+1] and nums[i] > nums[i-1]:\n                fenny.update(i, 1)\n                mtn[i] = True\n        #print(fenny.sums)\n        \n        ans = []\n        for q_type, a,b in queries:\n            if q_type == 2:\n                i = a\n                val = b\n                #print(\"b4\", fenny.sums)\n                pre = 0 if i in (0, n-1) else int(nums[i] > nums[i-1] and nums[i] > nums[i+1])\n                post = 0 if i in (0, n-1) else int(val > nums[i-1] and val > nums[i+1])\n                \n                if i != 0 and (val >= nums[i-1] and mtn[i-1]):\n                    mtn[i-1] = False\n                    fenny.update(i-1, -1)\n                elif i > 1 and (nums[i-1] > nums[i-2] and nums[i-1] > val and not mtn[i-1]):\n                    #print(\"HEREEEEE\", q_type, i, val, nums[i-1])\n                    mtn[i-1] = True\n                    fenny.update(i-1, 1)\n                if i != n-1 and (val >= nums[i+1] and mtn[i+1]):\n                    mtn[i+1] = False\n                    fenny.update(i+1, -1)\n                elif i < n-2 and (nums[i+1] > val and nums[i+1] > nums[i+2] and not mtn[i+1]):\n                    #print(\"HEREEEE\")\n                    mtn[i+1] = True\n                    fenny.update(i+1, 1)\n                nums[i] = val\n                if pre > post:\n                    mtn[i] = False\n                if post > pre:\n                    mtn[i] = True\n                fenny.update(i, post-pre)\n                #print(\"here\", fenny.sums, post, pre)\n                \n            else:\n                #print(nums, mtn, fenny.sums)\n                if(b-a < 2):\n                    ans.append(0)\n                    continue\n                    \n                l = fenny.query(a)\n                r = fenny.query(b-1)\n                #print(mtn, l, r, fenny.sums)\n                ans.append(r-l)\n        return ans\n        ",
    "submit_ts": 1718507836.0
}