{
    "username": "\u84dd\u84dd_\u5c0f\u9547",
    "submission": "class Solution {\n    public long[] countKConstraintSubstrings(String s, int k, int[][] queries) {\n        int m = s.length();\n        int[] max = new int[m];\n        int[] cur = new int[2];\n        int left = 0;\n        for(int i = 0;i<m;i++){\n            cur[s.charAt(i)-'0']++;\n            while(cur[0]>k && cur[1] >k){\n                max[left] = i;\n                // System.out.println(max[left]);\n                cur[s.charAt(left++) - '0']--;\n            }\n        }\n        long[] pre = new long[m+1];\n        for(;left<m;left++){\n        \n            max[left] = m;\n                            // System.out.println(max[left]);\n\n        }\n        for(left = 0;left<m;left++){\n            pre[left+1] =pre[left] + max[left];\n        }\n        int n = queries.length;\n        long[] ans = new long[n];\n        for(int i = 0;i<n;i++){\n            int l = queries[i][0];\n            int r = queries[i][1];\n            int target = bindarySearch(max,l-1,r+1,r+1);\n            // System.out.println(target + \"  ---  \" +pre[target]);\n            ans[i] += ((long)r-target+1) * ((long)r-target+2)/2;\n            // System.out.println(ans[i]);\n            if(target>l){\n                if(l>0)   \n                    ans[i] +=pre[target] - pre[l] - ((long)target-l) * ((long)target+l-1)/2;\n                else\n                    ans[i] +=pre[target]  - ((long)target-l) * ((long)target+l-1)/2;                    \n            }\n            // for(int x = l;x<=r;x++){\n            //     // System.out.println(ans[i]);\n            //     if(max[x] >r){\n            //         ans[i] += ((long)r-x+1) * ((long)r-x+2)/2;\n            //         break;\n            //     }\n            //     else{\n            //         ans[i] +=(max[x] - x);\n            //     }\n            // }\n\n        }\n        return ans;\n    }\n    int bindarySearch(int[] max,int l,int r,int target){\n        while(l+1<r){\n            int mid = (l+r)/2;\n            if(max[mid]>=target){\n                r = mid;\n            }\n            else{\n                l = mid;\n            }\n        }\n        return r;\n    }\n}",
    "submit_ts": "1723952558",
    "subm_id": "556412281"
}