{
    "username": "gxylengli",
    "submission": "#define N 100010\n#define M 18\nclass Solution {\npublic:\n    struct ST{\n        int f[N][M];\n        void init(vector<int>& a,int n){\n            for(int len=0;len<M;len++){\n                for(int i=1;i+(1<<len)-1<=n;i++){\n                    if(!len) f[i][len]=a[i-1];\n                    else f[i][len]=(f[i][len-1]&f[i+(1<<len-1)][len-1]);\n                }\n            }\n        }\n        int query(int l,int r){\n            int k=__lg(r-l+1);\n            return (f[l][k]&f[r-(1<<k)+1][k]);\n        }\n    }st;\n    long long countSubarrays(vector<int>& nums, int k) {\n        long long res=0;\n        int n=nums.size();\n        st.init(nums,n);\n\n        auto getr=[&](int idx){\n            int l=1,r=idx;\n            while(l<r){\n                int mid=(l+r)/2;\n                if(st.query(mid,idx)>=k) r=mid;\n                else l=mid+1;\n            }\n            if(st.query(r,idx)==k) return r;\n            return 0;\n        };\n        auto getl=[&](int idx){\n            int l=1,r=idx;\n            while(l<r){\n                int mid=(l+r+1)/2;\n                if(st.query(mid,idx)<=k) l=mid;\n                else r=mid-1;\n            }\n            if(st.query(l,idx)==k) return l;\n            return -1;\n        };\n\n        for(int i=1;i<=n;i++){\n            int l=getl(i),r=getr(i);\n            if(l==-1 or r==-1) continue;\n            res+=l-r+1;\n        }\n        return res;\n    }\n};",
    "submit_ts": "1720277860",
    "subm_id": "544559226"
}