{
    "username": "liouzhou_101",
    "submission": "class Solution {\npublic:\n    long long maximumValueSum(vector<vector<int>>& g) {\n\n        int n = g.size(), m = g[0].size();\n\n        auto l = g;\n        auto r = g;\n\n        for (int i = 0; i < n; ++i)\n        {\n            for (int j = 0; j < m; ++j)\n                if (j - 1 >= 0) l[i][j] = max(l[i][j], l[i][j - 1]);\n            for (int j = m - 1; j >= 0; --j)\n                if (j + 1 < m) r[i][j] = max(r[i][j], r[i][j + 1]);\n        }\n\n        using ll = long long;\n        vector<pair<ll, int>> lu1(n), ru1(n), lu2(n), ru2(n), ld1(n), ld2(n), rd1(n), rd2(n);\n        const ll INF = 10000000000000000LL;\n        ll res = -INF;\n\n        auto update = [&](pair<ll, int>& x1, pair<ll, int>& x2, pair<ll, int> y1, pair<ll, int> y2, pair<ll, int> e)\n        {\n            x1 = y1, x2 = y2;\n            if (e > x1) x2 = x1, x1 = e;\n            else if (e > x2) x2 = e;\n        };\n\n        for (int j = 1; j <= m - 2; ++j)\n        {\n            for (int i = 0; i < n; ++i)\n            {\n                update(lu1[i], lu2[i], i - 1 >= 0 ? lu1[i - 1] : pair(-INF, -1), i - 1 >= 0 ? lu2[i - 1] : pair(-INF, -1), pair(l[i][j - 1], i));\n                update(ru1[i], ru2[i], i - 1 >= 0 ? ru1[i - 1] : pair(-INF, -1), i - 1 >= 0 ? ru2[i - 1] : pair(-INF, -1), pair(r[i][j + 1], i));\n            }\n            for (int i = n - 1; i >= 0; --i)\n            {\n                update(ld1[i], ld2[i], i + 1 < n ? ld1[i + 1] : pair(-INF, -1), i + 1 < n ? ld2[i + 1] : pair(-INF, -1), pair(l[i][j - 1], i));\n                update(rd1[i], rd2[i], i + 1 < n ? rd1[i + 1] : pair(-INF, -1), i + 1 < n ? rd2[i + 1] : pair(-INF, -1), pair(r[i][j + 1], i));\n            }\n            for (int i = 0; i < n; ++i)\n            {\n                if (i - 1 >= 0)\n                {\n                    if (lu1[i - 1].second != ru1[i - 1].second)\n                        res = max(res, lu1[i - 1].first + ru1[i - 1].first + g[i][j]);\n                    else\n                    {\n                        res = max(res, lu1[i - 1].first + ru2[i - 1].first + g[i][j]);\n                        res = max(res, lu2[i - 1].first + ru1[i - 1].first + g[i][j]);\n                    }\n                }\n                if (i + 1 < n)\n                {\n                    if (ld1[i + 1].second != rd1[i + 1].second)\n                        res = max(res, ld1[i + 1].first + rd1[i + 1].first + g[i][j]);\n                    else\n                    {\n                        res = max(res, ld1[i + 1].first + rd2[i + 1].first + g[i][j]);\n                        res = max(res, ld2[i + 1].first + rd1[i + 1].first + g[i][j]);\n                    }\n                }\n                if (i - 1 >= 0 && i + 1 < n)\n                {\n                    res = max(res, lu1[i - 1].first + rd1[i + 1].first + g[i][j]);\n                    res = max(res, ru1[i - 1].first + ld1[i + 1].first + g[i][j]);\n                }\n            }\n        }\n\n        return res;\n    }\n};",
    "submit_ts": "1723907157",
    "subm_id": "556323910"
}