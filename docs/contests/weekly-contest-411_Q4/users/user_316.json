{
    "username": "vivek kumar",
    "submission": "#define ll long long\nclass Solution {\npublic:\n  vector<ll> countKConstraintSubstrings(string s, int k, vector<vector<int>> queries) {\n    ll n = s.size();\n    vector<vector<ll>> Arr(n, vector<ll>(2, 0));\n    vector<ll> cnt(2, 0), dp(n, 0);\n    for (ll i = 0; i < n; i++) {\n      cnt[s[i] - '0']++;\n      Arr[i] = cnt;\n    }\n    auto get = [&](ll l, ll r) {\n      if (l == 0) \n        return min(Arr[r][0], Arr[r][1]);\n\n      return min(Arr[r][0] - Arr[l - 1][0], Arr[r][1] - Arr[l - 1][1]);\n    };\n    for (ll i = 0; i < n; i++) {\n      ll l = i, r = n - 1;\n      while (l <= r) {\n        ll mid = (l + r) >> 1;\n        if (get(i, mid) <= k) {\n          dp[i] = mid - i + 1, l = mid + 1;\n        } else r = mid - 1;\n      }\n      if (i >= 1) dp[i] += dp[i - 1];\n    }\n    vector<ll> ans;\n    for (auto &q : queries) {\n      ll l = q[0], r = q[1];\n\n      if (get(l, r) <= k) {\n        ll len = r - l + 1;\n        ans.push_back(len * (len + 1) / 2);\n        continue;\n      }\n\n      ll l1 = l, r1 = r, pos = r;\n      while (l1 <= r1) {\n        ll mid1 = (l1 + r1) >> 1;\n        if (get(mid1, r) <= k) {\n          pos = mid1, r1 = mid1 - 1;\n        } else l1 = mid1 + 1;\n      }\n      ll tmp = 0, rem = r - pos + 1;\n      tmp += (rem * (rem + 1) / 2);\n      if (pos >= 1) tmp += dp[pos - 1] - (l >= 1 ? dp[l - 1] : 0);\n      ans.push_back(tmp);\n    }\n    return ans;\n  }\n};",
    "submit_ts": "1723950977",
    "subm_id": "1359760033"
}