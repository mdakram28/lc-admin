{
    "username": "uwi",
    "submission": "\tclass Solution {\n\t\tpublic int[] shortestDistanceAfterQueries(int n, int[][] queries) {\n\t\t\tLST lst = new LST(n+1);\n\t\t\tint[] vals = new int[n+5];\n\t\t\tint ans = n-1;\n\t\t\tint[] rets = new int[queries.length];\n\t\t\tint p = 0;\n\t\t\tfor(int[] q : queries){\n\t\t\t\tint l = q[0], r = q[1];\n\t\t\t\tint pr = lst.prev(l);\n\t\t\t\tboolean ok = true;\n\t\t\t\tif(pr != -1){\n\t\t\t\t\tint to = vals[pr] + 1 + pr;\n\t\t\t\t\tif(r <= to){\n\t\t\t\t\t\tok = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(ok) {\n\t\t\t\t\twhile (true) {\n\t\t\t\t\t\tint pos = lst.next(l);\n\t\t\t\t\t\tif (pos == -1 || pos >= r) break;\n\t\t\t\t\t\tlst.unset(pos);\n\t\t\t\t\t\tans += vals[pos];\n\t\t\t\t\t\tvals[pos] = 0;\n\t\t\t\t\t}\n\t\t\t\t\tlst.set(l);\n\t\t\t\t\tvals[l] = r - l - 1;\n\t\t\t\t\tans -= r - l - 1;\n\t\t\t\t}\n\t\t\t\trets[p++] = ans;\n\t\t\t}\n\t\t\treturn rets;\n\t\t}\n\n\n\n\t\tpublic static class LST {\n\t\t\tpublic long[][] set;\n\t\t\tpublic int n;\n\t\t\t//\tpublic int size;\n\n\t\t\tpublic LST(int n) {\n\t\t\t\tthis.n = n;\n\t\t\t\tint d = 1;\n\t\t\t\tfor(int m = n;m > 1;m>>>=6, d++);\n\n\t\t\t\tset = new long[d][];\n\t\t\t\tfor(int i = 0, m = n>>>6;i < d;i++, m>>>=6){\n\t\t\t\t\tset[i] = new long[m+1];\n\t\t\t\t}\n\t\t\t\t//\t\tsize = 0;\n\t\t\t}\n\n\t\t\t// [0,r)\n\t\t\tpublic LST setRange(int r)\n\t\t\t{\n\t\t\t\tfor(int i = 0;i < set.length;i++, r=r+63>>>6){\n\t\t\t\t\tfor(int j = 0;j < r>>>6;j++){\n\t\t\t\t\t\tset[i][j] = -1L;\n\t\t\t\t\t}\n\t\t\t\t\tif((r&63) != 0)set[i][r>>>6] |= (1L<<r)-1;\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t}\n\n\t\t\t// [0,r)\n\t\t\tpublic LST unsetRange(int r)\n\t\t\t{\n\t\t\t\tif(r >= 0){\n\t\t\t\t\tfor(int i = 0;i < set.length;i++, r=r+63>>>6){\n\t\t\t\t\t\tfor(int j = 0;j < r+63>>>6;j++){\n\t\t\t\t\t\t\tset[i][j] = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif((r&63) != 0)set[i][r>>>6] &= -(1L << r);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t}\n\n\t\t\tpublic LST set(int pos)\n\t\t\t{\n\t\t\t\tif(pos >= 0 && pos < n){\n\t\t\t\t\t//\t\t\tif(!get(pos))size++;\n\t\t\t\t\tfor(int i = 0;i < set.length;i++, pos>>>=6){\n\t\t\t\t\t\tset[i][pos>>>6] |= 1L<<pos;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t}\n\n\t\t\tpublic LST unset(int pos)\n\t\t\t{\n\t\t\t\tif(pos >= 0 && pos < n){\n\t\t\t\t\t//\t\t\tif(get(pos))size--;\n\t\t\t\t\tfor(int i = 0;i < set.length && (i == 0 || set[i-1][pos] == 0L);i++, pos>>>=6){\n\t\t\t\t\t\tset[i][pos>>>6] &= ~(1L<<pos);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t}\n\n\t\t\tpublic boolean get(int pos)\n\t\t\t{\n\t\t\t\treturn pos >= 0 && pos < n && set[0][pos>>>6]<<~pos<0;\n\t\t\t}\n\n\t\t\tpublic LST toggle(int pos)\n\t\t\t{\n\t\t\t\treturn get(pos) ? unset(pos) : set(pos);\n\t\t\t}\n\n\t\t\tpublic int prev(int pos)\n\t\t\t{\n\t\t\t\tfor(int i = 0;i < set.length && pos >= 0;i++, pos>>>=6, pos--){\n\t\t\t\t\tint pre = prev(set[i][pos>>>6], pos&63);\n\t\t\t\t\tif(pre != -1){\n\t\t\t\t\t\tpos = pos>>>6<<6|pre;\n\t\t\t\t\t\twhile(i > 0)pos = pos<<6|63-Long.numberOfLeadingZeros(set[--i][pos]);\n\t\t\t\t\t\treturn pos;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\tpublic int next(int pos)\n\t\t\t{\n\t\t\t\tfor(int i = 0;i < set.length && pos>>>6 < set[i].length;i++, pos>>>=6, pos++){\n\t\t\t\t\tint nex = next(set[i][pos>>>6], pos&63);\n\t\t\t\t\tif(nex != -1){\n\t\t\t\t\t\tpos = pos>>>6<<6|nex;\n\t\t\t\t\t\twhile(i > 0)pos = pos<<6|Long.numberOfTrailingZeros(set[--i][pos]);\n\t\t\t\t\t\treturn pos;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\tprivate static int prev(long set, int n)\n\t\t\t{\n\t\t\t\tlong h = set<<~n;\n\t\t\t\tif(h == 0L)return -1;\n\t\t\t\treturn -Long.numberOfLeadingZeros(h)+n;\n\t\t\t}\n\n\t\t\tprivate static int next(long set, int n)\n\t\t\t{\n\t\t\t\tlong h = set>>>n;\n\t\t\t\tif(h == 0L)return -1;\n\t\t\t\treturn Long.numberOfTrailingZeros(h)+n;\n\t\t\t}\n\n\t\t\t@Override\n\t\t\tpublic String toString()\n\t\t\t{\n\t\t\t\tList<Integer> list = new ArrayList<>();\n\t\t\t\tfor(int pos = next(0);pos != -1;pos = next(pos+1)){\n\t\t\t\t\tlist.add(pos);\n\t\t\t\t}\n\t\t\t\treturn list.toString();\n\t\t\t}\n\t\t}\n\n\t}\n",
    "submit_ts": "1722739225",
    "subm_id": "1343689208"
}