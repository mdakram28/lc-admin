{
    "username": "nochill",
    "submission": "class Solution {\npublic:\n#define tp tuple<int,int,int>\n    long long maximumValueSum(vector<vector<int>>& board) {\n        int m=board.size(),n=board[0].size();\n        vector<tp>tmp;\n        for(int i=0;i<m;i++){\n            for(int j=0;j<n;j++){\n                tmp.emplace_back(board[i][j],i,j);\n            }\n        }\n        sort(tmp.begin(),tmp.end(),greater<tp>());\n        vector<int>maxc(m,0),maxr(n,0);\n        for(int i=m-1;i>=0;--i){\n            for(int j=n-1;j>=0;--j){\n                maxc[i]=max(maxc[i],board[i][j]);\n\n            }\n        }\n        for(int i=m-1;i>=0;--i){if(i+1<m) maxc[i]=max(maxc[i],maxc[i+1]);}\n        unordered_map<long,long>mp;\n        long tot=-100000000000001;\n        long ph=tot;\n       // cout<<(-1L<<36);\n        function<long(int,int,int,int,int,int,int,long)>dfs=[&](int x1,int y1,int x2,int y2,int x3,int y3,int cnt,long prev){\n            long pp=((long)x1<<35)|((long)y1<<28)|((long)x2<<21)|((long)y2<<14)|((long)x3<<7)|((long)y3);\n            if(mp.count(pp)) return mp[pp];\n           // if(cnt==3) return 0;\n            long re=ph;\n            if(cnt==0){\n                for(int i=0;i<m-2;i++){\n                    if(3L*maxc[i]<=tot) continue;\n                    for(int j=0;j<n;j++){\n                       re=max(re,board[i][j]+dfs(i,j,x2,y2,x3,y3,1,board[i][j]));\n                       tot=max(tot,re);\n                    }\n                }\n            }\n            else if(cnt==1){\n                for(int i=x1+1;i<m-1;i++){\n                    if(2L*maxc[i]+prev<=tot) continue;\n                     for(int j=0;j<n;j++){\n                   if(j!=y1&&prev+board[i][j]+maxc[i+1]>=tot)    re=max(re,board[i][j]+dfs(x1,y1,i,j,x3,y3,2,prev+board[i][j]));\n                    }\n                }\n            }else{\n               for(int ii=0;ii<tmp.size();ii++){\n                auto &[z,x,y]=tmp[ii];\n                if(x!=x1&&x!=x2&&y!=y1&&y!=y2){\n                   re=z;break;\n                }\n               }\n            }\n            return mp[pp]=re;\n        };\n        return dfs(101,101,101,101,101,101,0,0);\n    }\n};",
    "submit_ts": "1723909222",
    "subm_id": "556335129"
}