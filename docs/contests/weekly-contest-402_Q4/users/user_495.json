{
    "username": "yzkkai",
    "submission": "#define lowbit(x) ((x) & -(x))\nclass Solution {\npublic:\n    void modify(vector<int> &bit, int pos, int val) {\n        for (; pos < bit.size(); pos += lowbit(pos))\n            bit[pos] += val;\n        return;\n    }\n    \n    int query(vector<int> &bit, int pos) {\n        int ret = 0;\n        for (; pos > 0; pos -= lowbit(pos))\n            ret += bit[pos];\n        return ret;\n    }\n    \n    vector<int> countOfPeaks(vector<int>& nums, vector<vector<int>>& queries) {\n        int n = nums.size();\n        vector<int> bit(n + 1);\n        for (int i = 1; i < n - 1; ++i)\n            if (nums[i] > nums[i - 1] && nums[i] > nums[i + 1])\n                modify(bit, i + 1, 1);\n        \n        vector<int> ans;\n        for (auto &q : queries) {\n            if (q[0] == 1) {\n                if (q[2] == q[1])\n                    ans.emplace_back(0);\n                else\n                    ans.emplace_back(query(bit, q[2]) - query(bit, q[1] + 1));\n            }\n            else {\n                int idx = q[1], val = q[2];\n                \n                if (idx > 1) {\n                    if (nums[idx - 1] > nums[idx - 2] && nums[idx - 1] > nums[idx])\n                        modify(bit, idx, -1);\n                    \n                    if (nums[idx - 1] > nums[idx - 2] && nums[idx - 1] > val)\n                        modify(bit, idx, 1);                  \n                }\n                \n                if (idx < n - 2) {\n                    if (nums[idx + 1] > nums[idx] && nums[idx + 1] > nums[idx + 2])\n                        modify(bit, idx + 2, -1);\n                    \n                    if (nums[idx + 1] > val && nums[idx + 1] > nums[idx + 2])\n                        modify(bit, idx + 2, 1);                  \n                }\n                \n                if (idx != 0 && idx != n - 1) {\n                    if (nums[idx] > nums[idx - 1] && nums[idx] > nums[idx + 1])\n                        modify(bit, idx + 1, -1);\n\n                    if (val > nums[idx - 1] && val > nums[idx + 1])\n                        modify(bit, idx + 1, 1);\n                }\n                \n                nums[idx] = val;\n            }\n        }\n        \n        return ans;\n    }\n};",
    "submit_ts": 1718507392.0
}