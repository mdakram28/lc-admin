{
    "username": "Romy67",
    "submission": "#define rep(i, a, b) for(int i = a; i < (b); ++i)\n#define per(i, a, b) for(int i = a; i > (b); --i)\n#define ar array\n#define sz(x) (int) (x).size()\n#define pii pair<int,int>\n#define fi first\n#define se second\ntypedef long long ll;\ntypedef pair<ll,ll> pll;\ntypedef pair<double,double> pdd;\ntypedef pair<double,int> pdi;\ntypedef vector<int> vi;\n\ntemplate<typename T>\nvoid min_self(T& A, T B) {\n    A = min(A,B);\n}\ntemplate<typename T>\nvoid max_self(T& A, T B) {\n    A = max(A,B);\n}\n\nstruct TreeAnd {\n    typedef int T;\n    static constexpr T unit = (1<<30)-1;\n    T f(T a, T b) { return (a&b); } // (any associative fn)\n    vector<T> s; int n;\n    TreeAnd(int n = 0, T def = unit) : s(2*n, def), n(n) {}\n    void update(int pos, T val) {\n        for (s[pos += n] = val; pos /= 2;)\n            s[pos] = f(s[pos * 2], s[pos * 2 + 1]);\n    }\n    T query(int b, int e) { // query [b, e)\n        T ra = unit, rb = unit;\n        for (b += n, e += n; b < e; b /= 2, e /= 2) {\n            if (b % 2) ra = f(ra, s[b++]);\n            if (e % 2) rb = f(s[--e], rb);\n        }\n        return f(ra, rb);\n    }\n};\n\nclass Solution {\npublic:\n    long long countSubarrays(vector<int>& nums, int k) {\n        int n = sz(nums);\n        TreeAnd st(n);\n        rep(i,0,n) {\n            st.update(i,nums[i]);\n        }\n        ll ret = 0;\n        rep(i,0,n) {\n            int l=i,r=n-1;\n            int li = -1;\n            while(l<=r) {\n                int mid = (l+r)/2;\n                int qry = st.query(i,mid+1);\n                if(qry==k) {\n                    li = mid;\n                    r = mid-1;\n                } else if((qry&k)==k) {\n                    l = mid+1;\n                } else {\n                    r = mid-1;\n                }\n            }\n            if(li==-1) continue;\n            l = i, r = n-1;\n            int ri = -1;\n            while(l<=r) {\n                int mid = (l+r)/2;\n                int qry = st.query(i,mid+1);\n                if(qry==k) {\n                    ri = mid;\n                    l = mid+1;\n                } else if((qry&k)==k) {\n                    l = mid+1;\n                } else {\n                    r = mid-1;\n                }\n            }            \n            if(ri==-1) continue;\n            ret += ri-li+1;\n        }\n        return ret;\n    }\n};",
    "submit_ts": "1720278419",
    "subm_id": "1311708342"
}