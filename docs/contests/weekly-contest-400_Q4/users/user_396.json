{
    "username": "_otto",
    "submission": "class SparseTable:\n    def __init__(self, data, merge_method):\n        self.note = [0] * (len(data) + 1)\n        self.merge_method = merge_method\n        l, r, v = 1, 2, 0\n        while True:\n            for i in range(l, r):\n                if i >= len(self.note):\n                    break\n                self.note[i] = v\n            else:\n                l *= 2\n                r *= 2\n                v += 1\n                continue\n            break\n        self.ST = [[0] * len(data) for _ in range(self.note[-1]+1)]\n        self.ST[0] = data\n        for i in range(1, len(self.ST)):\n            for j in range(len(data) - (1 << i) + 1):\n                self.ST[i][j] = merge_method(self.ST[i-1][j], self.ST[i-1][j + (1 << (i-1))])\n    def query(self, l, r):\n        pos = self.note[r-l+1]\n        return self.merge_method(self.ST[pos][l], self.ST[pos][r - (1 << pos) + 1])\n\nclass Solution:\n    def minimumDifference(self, nums: List[int], k: int) -> int:\n        st = SparseTable(nums, operator.iand)\n        n = len(nums)\n        ans = inf\n        for l in range(n):\n            lo = l\n            hi = n - 1\n            while lo < hi:\n                mid = hi - (hi - lo) // 2\n                if st.query(l, mid) >= k:\n                    lo = mid\n                else:\n                    hi = mid - 1\n            if 0 <= lo < n and lo >= l:\n                ans = min(ans, abs(k - st.query(l, lo)))\n            if 0 <= lo + 1 < n and lo + 1 >= l:\n                ans = min(ans, abs(k - st.query(l, lo + 1)))\n            if 0 <= lo - 1 < n and lo - 1 >= l:\n                ans = min(ans, abs(k - st.query(l, lo  -1)))\n            lo = l\n            hi = n - 1\n            while lo < hi:\n                mid = (lo + hi) // 2\n                if st.query(l, mid) > k:\n                    lo = mid + 1\n                else:\n                    hi = mid \n            if 0 <= lo < n and lo >= l:\n                ans = min(ans, abs(k - st.query(l, lo)))\n            if 0 <= lo + 1 < n and lo + 1 >= l:\n                ans = min(ans, abs(k - st.query(l, lo + 1)))\n            if 0 <= lo - 1 < n and lo - 1 >= l:\n                ans = min(ans, abs(k - st.query(l, lo  -1)))\n        return ans",
    "submit_ts": "1717297717",
    "subm_id": "1274753265"
}